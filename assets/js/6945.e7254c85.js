"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[6945],{37072:(e,t,o)=>{o.d(t,{J:()=>i});var r=o(47522),n=o(38846),s=o(79439);const i={props:{},name:"gouraudMaterial",vs:n.l.replace("phongMaterial","gouraudMaterial"),fs:n.X.replace("phongMaterial","gouraudMaterial"),source:s.X.replaceAll("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:!0},dependencies:[r.x],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(e){const t={...e};return t.specularColor&&(t.specularColor=t.specularColor.map((e=>e/255))),{...i.defaultUniforms,...t}}}},31338:(e,t,o)=>{o.d(t,{w:()=>i});var r=o(47522),n=o(79439),s=o(38846);const i={name:"phongMaterial",dependencies:[r.x],source:n.X,vs:s.X,fs:s.l,defines:{LIGHTING_FRAGMENT:!0},uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(e){const t={...e};return t.specularColor&&(t.specularColor=t.specularColor.map((e=>e/255))),{...i.defaultUniforms,...t}}}},23589:(e,t,o)=>{o.d(t,{R:()=>xe});var r=o(3361),n=o(327),s=o(87597),i=o(31886),a=o(4912),u=o(38925),l=o(8045),c=o(53618),d=o(78307),f=o(49332),h=o(94976),S=o(50473),_=o(71530);const p=542327876,m=31,T=0,b=1,C=2,R=3,E=4,g=7,M=20,A=21,x=131072,P=4,y={DXT1:S.b.COMPRESSED_RGB_S3TC_DXT1_EXT,DXT3:S.b.COMPRESSED_RGBA_S3TC_DXT3_EXT,DXT5:S.b.COMPRESSED_RGBA_S3TC_DXT5_EXT,"ATC ":S.b.COMPRESSED_RGB_ATC_WEBGL,ATCA:S.b.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL,ATCI:S.b.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL},D={DXT1:O,DXT3:w,DXT5:w,"ATC ":O,ATCA:w,ATCI:w};function G(e){const t=new Int32Array(e,0,m),o=t[A];(0,h.v)(Boolean(t[M]&P),"DDS: Unsupported format, must contain a FourCC code");const r=(n=o,String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255));var n;const s=y[r],i=D[r];(0,h.v)(s&&i,`DDS: Unknown pixel format ${o}`);let a=1;t[C]&x&&(a=Math.max(1,t[g]));const u=t[E],l=t[R],c=t[b]+4,d=new Uint8Array(e,c);return(0,_.C)(d,{mipMapLevels:a,width:u,height:l,sizeFunction:i,internalFormat:s})}function O(e,t){return(e+3>>2)*(t+3>>2)*8}function w(e,t){return(e+3>>2)*(t+3>>2)*16}const B=55727696,L=1347834371,I=13,F=52,v=0,H=2,U=4,X=6,N=7,k=11,$=12,K={0:[S.b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG],1:[S.b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG],2:[S.b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG],3:[S.b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG],6:[S.b.COMPRESSED_RGB_ETC1_WEBGL],7:[S.b.COMPRESSED_RGB_S3TC_DXT1_EXT],9:[S.b.COMPRESSED_RGBA_S3TC_DXT3_EXT],11:[S.b.COMPRESSED_RGBA_S3TC_DXT5_EXT],22:[S.b.COMPRESSED_RGB8_ETC2],23:[S.b.COMPRESSED_RGBA8_ETC2_EAC],24:[S.b.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2],25:[S.b.COMPRESSED_R11_EAC],26:[S.b.COMPRESSED_RG11_EAC],27:[S.b.COMPRESSED_RGBA_ASTC_4X4_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR],28:[S.b.COMPRESSED_RGBA_ASTC_5X4_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR],29:[S.b.COMPRESSED_RGBA_ASTC_5X5_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR],30:[S.b.COMPRESSED_RGBA_ASTC_6X5_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR],31:[S.b.COMPRESSED_RGBA_ASTC_6X6_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR],32:[S.b.COMPRESSED_RGBA_ASTC_8X5_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR],33:[S.b.COMPRESSED_RGBA_ASTC_8X6_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR],34:[S.b.COMPRESSED_RGBA_ASTC_8X8_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR],35:[S.b.COMPRESSED_RGBA_ASTC_10X5_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR],36:[S.b.COMPRESSED_RGBA_ASTC_10X6_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR],37:[S.b.COMPRESSED_RGBA_ASTC_10X8_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR],38:[S.b.COMPRESSED_RGBA_ASTC_10X10_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR],39:[S.b.COMPRESSED_RGBA_ASTC_12X10_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR],40:[S.b.COMPRESSED_RGBA_ASTC_12X12_KHR,S.b.COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR]},V={0:z,1:z,2:W,3:W,6:j,7:j,9:q,11:q,22:j,23:q,24:j,25:j,26:q,27:q,28:function(e,t){return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16},29:function(e,t){return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16},30:function(e,t){return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16},31:function(e,t){return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16},32:function(e,t){return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16},33:function(e,t){return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16},34:function(e,t){return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16},35:function(e,t){return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16},36:function(e,t){return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16},37:function(e,t){return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16},38:function(e,t){return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16},39:function(e,t){return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16},40:function(e,t){return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16}};function z(e,t){return(e=Math.max(e,16))*(t=Math.max(t,8))/4}function W(e,t){return(e=Math.max(e,8))*(t=Math.max(t,8))/2}function j(e,t){return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8}function q(e,t){return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16}function J(e){if((0,f.e)(e))return(0,f.V)(e);if(function(e){return new Uint32Array(e,0,m)[T]===p}(e))return G(e);if(function(e){const t=new Uint32Array(e,0,I)[v];return t===B||t===L}(e))return function(e){const t=new Uint32Array(e,0,I),o=t[H],r=t[U],n=K[o]||[],s=n.length>1&&r?n[1]:n[0],i=V[o],a=t[k],u=t[N],l=t[X],c=F+t[$],d=new Uint8Array(e,c);return(0,_.C)(d,{mipMapLevels:a,width:u,height:l,sizeFunction:i,internalFormat:s})}(e);throw new Error("Texture container format not recognized")}var Q=o(6143);const Y={...{dataType:null,batchType:null,name:"Texture Containers",id:"compressed-texture",module:"textures",version:d.x,worker:!0,extensions:["ktx","ktx2","dds","pvr"],mimeTypes:["image/ktx2","image/ktx","image/vnd-ms.dds","image/x-dds","application/octet-stream"],binary:!0,options:{"compressed-texture":{libraryPath:"libs/",useBasis:!1}}},parse:async(e,t)=>{if(t?.["compressed-texture"]?.useBasis){t.basis={format:{alpha:"BC3",noAlpha:"BC1"},...t.basis,containerFormat:"ktx2",module:"encoder"};return(await(0,Q.A)(e,t))[0]}return J(e)}};var Z,ee=o(77067);function te(e){let t;try{const o=new URL(e);t=`${o.origin}${o.pathname}`,t.startsWith("null")&&(t=null)}catch(o){t=null}return t||e}function oe(e,t=null){return t?`${e}?token=${t}`:e}!function(e){e.vertexCount="vertexCount",e.featureCount="featureCount"}(Z||(Z={}));var re=o(10033);function ne(e){switch(e){case"UInt8":return Uint8Array;case"UInt16":return Uint16Array;case"UInt32":return Uint32Array;case"Float32":return Float32Array;case"UInt64":return Float64Array;default:throw new Error(`parse i3s tile content: unknown type of data: ${e}`)}}const se={UInt8:re.GL.UNSIGNED_BYTE,UInt16:re.GL.UNSIGNED_SHORT,Float32:re.GL.FLOAT,UInt32:re.GL.UNSIGNED_INT,UInt64:re.GL.DOUBLE};function ie(e){switch(e){case"UInt8":return 1;case"UInt16":case"Int16":return 2;case"UInt32":case"Int32":case"Float32":return 4;case"UInt64":case"Int64":case"Float64":return 8;default:throw new Error(`parse i3s tile content: unknown size of data: ${e}`)}}var ae;!function(e){e[e.DEFAULT=-1]="DEFAULT",e[e.LNGLAT=1]="LNGLAT",e[e.METER_OFFSETS=2]="METER_OFFSETS",e[e.LNGLAT_OFFSETS=3]="LNGLAT_OFFSETS",e[e.CARTESIAN=0]="CARTESIAN"}(ae||(ae={}));const ue=new s.P([0,0,0]);const le="i3s-attribute-type";async function ce(e,t,o,d,f){const h={attributes:{},indices:null,featureIds:[],vertexCount:0,modelMatrix:new i.k,coordinateSystem:0,byteLength:0,texture:null};if(t.textureUrl){const e=oe(t.textureUrl,d?.i3s?.token),o=function(e){switch(e){case"ktx-etc2":case"dds":return Y;case"ktx2":return ee.E;default:return l.$}}(t.textureFormat),s=f?.fetch||fetch,i=await s(e),a=await i.arrayBuffer();if(d?.i3s.decodeTextures){if(o===l.$){const e={...t.textureLoaderOptions,image:{type:"data"}};try{const t=await(0,u.N9)(a,[],e,f);h.texture=t}catch(S){const t=await(0,r.q)(a,o,e,f);h.texture=t}}else if(o===Y||o===ee.E){let e=await(0,n.H)(a,o,t.textureLoaderOptions);o===ee.E&&(e=e[0]),h.texture={compressed:!0,mipmaps:!1,width:e[0].width,height:e[0].height,data:e}}}else h.texture=a}return h.material=function(e,t){let o;e?o={...e,pbrMetallicRoughness:e.pbrMetallicRoughness?{...e.pbrMetallicRoughness}:{baseColorFactor:[255,255,255,255]}}:(o={pbrMetallicRoughness:{}},t?o.pbrMetallicRoughness.baseColorTexture={texCoord:0}:o.pbrMetallicRoughness.baseColorFactor=[255,255,255,255]);o.alphaCutoff=o.alphaCutoff||.25,o.alphaMode&&(o.alphaMode=o.alphaMode.toUpperCase());o.emissiveFactor&&(o.emissiveFactor=Se(o.emissiveFactor));o.pbrMetallicRoughness&&o.pbrMetallicRoughness.baseColorFactor&&(o.pbrMetallicRoughness.baseColorFactor=Se(o.pbrMetallicRoughness.baseColorFactor));t&&function(e,t){const o={source:{image:t}};e.pbrMetallicRoughness&&e.pbrMetallicRoughness.baseColorTexture?e.pbrMetallicRoughness.baseColorTexture={...e.pbrMetallicRoughness.baseColorTexture,texture:o}:e.emissiveTexture?e.emissiveTexture={...e.emissiveTexture,texture:o}:e.pbrMetallicRoughness&&e.pbrMetallicRoughness.metallicRoughnessTexture?e.pbrMetallicRoughness.metallicRoughnessTexture={...e.pbrMetallicRoughness.metallicRoughnessTexture,texture:o}:e.normalTexture?e.normalTexture={...e.normalTexture,texture:o}:e.occlusionTexture&&(e.occlusionTexture={...e.occlusionTexture,texture:o})}(o,t);return o}(t.materialDefinition,h.texture),h.material&&(h.texture=null),await async function(e,t,o,n,u){const l=e.byteLength;let d,f,h,S=0,_=0;if(o.isDracoGeometry){const t=await(0,r.q)(e,c.Vl,{draco:{attributeNameEntry:le}});f=t.header.vertexCount,h=t.indices?.value;const{POSITION:o,NORMAL:n,COLOR_0:s,TEXCOORD_0:i,"feature-index":a,"uv-region":u}=t.attributes;d={position:o,normal:n,color:s,uv0:i,uvRegion:u,id:a},function(e,t){for(const o in t.loaderData.attributes){const r=t.loaderData.attributes[o];switch(r.name){case"POSITION":e.position.metadata=r.metadata;break;case"feature-index":e.id.metadata=r.metadata}}}(d,t);const l=function(e){return e?.metadata?.["i3s-feature-ids"]?.intArray}(a);l&&function(e,t){const o=e.id.value,r=new Float32Array(o.length);for(let n=0;n<o.length;n++)r[n]=t[o[n]];e.id.value=r}(d,l)}else{const{vertexAttributes:t,ordering:o,featureAttributes:r,featureAttributeOrder:s}=n.store.defaultGeometrySchema,i=function(e,t){let o=0,r=0,n=0;for(const{property:s,type:i}of t.store.defaultGeometrySchema.header){const t=ne(i);switch(s){case Z.vertexCount.toString():r=new t(e,0,4)[0],o+=ie(i);break;case Z.featureCount.toString():n=new t(e,4,4)[0],o+=ie(i)}}return{vertexCount:r,featureCount:n,byteOffset:o}}(e,n);S=i.byteOffset,f=i.vertexCount,_=i.featureCount;const{attributes:a,byteOffset:u}=fe(e,S,t,f,o),{attributes:l}=fe(e,u,r,_,s);!function(e){const{id:t,faceRange:o}=e;if(!t||!o)return;const r=t.value,n=o.value,s=n[n.length-1]+1,i=new Uint32Array(3*s);let a=0,u=0;for(let l=1;l<n.length;l+=2){const e=Number(r[a]),t=u+3*(n[l]-n[l-1]+1);i.fill(e,u,t),a++,u=t}e.id.value=i}(l),d=function(e,t){return{...e,...t}}(a,l)}if(u?.i3s?.coordinateSystem&&u.i3s.coordinateSystem!==ae.METER_OFFSETS)t.modelMatrix=function(e){const t=e.metadata,o=t?.["i3s-scale_x"]?.double||1,r=t?.["i3s-scale_y"]?.double||1,n=new i.k;return n[0]=o,n[5]=r,n}(d.position),t.coordinateSystem=ae.LNGLAT_OFFSETS;else{const e=function(e,t){const o=t.mbs,r=e.value,n=e.metadata,u=new i.k,l=new s.P(o[0],o[1],o[2]),c=new s.P;return a.C.WGS84.cartographicToCartesian(l,c),a.C.WGS84.eastNorthUpToFixedFrame(c,u),e.value=function(e,t={},o){const r=new Float64Array(e.length),n=t["i3s-scale_x"]&&t["i3s-scale_x"].double||1,s=t["i3s-scale_y"]&&t["i3s-scale_y"].double||1;for(let i=0;i<r.length;i+=3)r[i]=e[i]*n+o.x,r[i+1]=e[i+1]*s+o.y,r[i+2]=e[i+2]+o.z;for(let i=0;i<r.length;i+=3)a.C.WGS84.cartographicToCartesian(r.subarray(i,i+3),ue),r[i]=ue.x,r[i+1]=ue.y,r[i+2]=ue.z;return r}(r,n,l),u}(d.position,o);t.modelMatrix=e.invert(),t.coordinateSystem=ae.METER_OFFSETS}t.attributes={positions:d.position,normals:d.normal,colors:de(d.color),texCoords:d.uv0,uvRegions:de(d.uvRegion||d.region)},t.indices=h||null,d.id&&d.id.value&&(t.featureIds=d.id.value);for(const r in t.attributes)t.attributes[r]||delete t.attributes[r];return t.vertexCount=f,t.byteLength=l,t}(e,h,t,o,d)}function de(e){return e?(e.normalized=!0,e):e}function fe(e,t,o,r,n){const s={};for(const i of n)if(o[i]){const{valueType:n,valuesPerElement:a}=o[i];if(t+r*a*ie(n)<=e.byteLength){const o=e.slice(t);let u;if("UInt64"===n)u=he(o,r*a,ie(n));else{u=new(ne(n))(o,0,r*a)}if(s[i]={value:u,type:se[n],size:a},"color"===i)s.color.normalized=!0;t+=r*a*ie(n)}else if("uv0"!==i)break}return{attributes:s,byteOffset:t}}function he(e,t,o){const r=[],n=new DataView(e);let s=0;for(let i=0;i<t;i++){const e=n.getUint32(s,!0)+2**32*n.getUint32(s+4,!0);r.push(e),s+=o}return new Uint32Array(r)}function Se(e){const t=[...e];for(let o=0;o<e.length;o++)t[o]=e[o]/255;return t}const _e={dataType:null,batchType:null,name:"I3S Content (Indexed Scene Layers)",id:"i3s-content",module:"i3s",worker:!0,version:"4.3.2",mimeTypes:["application/octet-stream"],parse:async function(e,t,o){const{tile:r,_tileOptions:n,tileset:s,_tilesetOptions:i}=t?.i3s||{},a=n||r,u=i||s;if(!a||!u)return null;return await ce(e,a,u,t,o)},extensions:["bin"],options:{"i3s-content":{}}};var pe=o(67733),me=o(4999),Te=o(64257);const be={dataType:null,batchType:null,name:"I3S Node Page",id:"i3s-node-page",module:"i3s",version:"4.3.2",mimeTypes:["application/json"],parse:async function(e,t){return JSON.parse((new TextDecoder).decode(e))},extensions:["json"],options:{i3s:{}}};class Ce{tileset;nodePages=[];pendingNodePages=[];nodesPerPage;options;lodSelectionMetricType;textureDefinitionsSelectedFormats=[];nodesInNodePages;url;textureLoaderOptions={};constructor(e,t="",o){this.tileset={...e},this.url=t,this.nodesPerPage=e.nodePages?.nodesPerPage||64,this.lodSelectionMetricType=e.nodePages?.lodSelectionMetricType,this.options=o,this.nodesInNodePages=0,this.initSelectedFormatsForTextureDefinitions(e)}async getNodeById(e){const t=Math.floor(e/this.nodesPerPage);if(!this.nodePages[t]&&!this.pendingNodePages[t]){const e=oe(`${this.url}/nodepages/${t}`,this.options.i3s?.token);this.pendingNodePages[t]={status:"Pending",promise:(0,n.H)(e,be,this.options)},this.nodePages[t]=await this.pendingNodePages[t].promise,this.nodesInNodePages+=this.nodePages[t].nodes.length,this.pendingNodePages[t].status="Done"}"Pending"===this.pendingNodePages[t].status&&(this.nodePages[t]=await this.pendingNodePages[t].promise);const o=e%this.nodesPerPage;return this.nodePages[t].nodes[o]}async formTileFromNodePages(e){const t=await this.getNodeById(e),o=[],r=[];for(const f of t.children||[])r.push(this.getNodeById(f));const n=await Promise.all(r);for(const f of n)o.push({id:f.index.toString(),obb:f.obb});let s,i,a,u="jpg",l=[],c=!1;if(t&&t.mesh){const{url:e,isDracoGeometry:o}=t.mesh.geometry&&this.getContentUrl(t.mesh.geometry)||{isDracoGeometry:!1};s=e,c=o;const{textureData:r,materialDefinition:n}=this.getInformationFromMaterial(t.mesh.material);a=n,u=r.format||u,r.name&&(i=`${this.url}/nodes/${t.mesh.material.resource}/textures/${r.name}`),this.tileset.attributeStorageInfo&&(l=function(e,t,o){const r=[],{attributeStorageInfo:n=[]}=e;for(let s=0;s<n.length;s++){const e=n[s].key;r.push(`${t}/nodes/${o}/attributes/${e}/0`)}return r}(this.tileset,this.url,t.mesh.attribute.resource))}const d=this.getLodSelection(t);return Re({id:e.toString(),lodSelection:d,obb:t.obb,contentUrl:s,textureUrl:i,attributeUrls:l,materialDefinition:a,textureFormat:u,textureLoaderOptions:this.textureLoaderOptions,children:o,isDracoGeometry:c})}getContentUrl(e){let t=null;const o=this.tileset.geometryDefinitions[e.definition];let r=-1;if(this.options.i3s&&this.options.i3s.useDracoGeometry&&(r=o.geometryBuffers.findIndex((e=>e.compressedAttributes&&"draco"===e.compressedAttributes.encoding))),-1===r&&(r=o.geometryBuffers.findIndex((e=>!e.compressedAttributes))),-1!==r){const n=Boolean(o.geometryBuffers[r].compressedAttributes);t={url:`${this.url}/nodes/${e.resource}/geometries/${r}`,isDracoGeometry:n}}return t}getLodSelection(e){const t=[];return"maxScreenThresholdSQ"===this.lodSelectionMetricType&&t.push({metricType:"maxScreenThreshold",maxError:Math.sqrt(e.lodThreshold/(.25*Math.PI))}),t.push({metricType:this.lodSelectionMetricType,maxError:e.lodThreshold}),t}getInformationFromMaterial(e){const t={textureData:{name:null}};if(e){const o=this.tileset.materialDefinitions?.[e.definition];if(o){t.materialDefinition=o;const e=o?.pbrMetallicRoughness?.baseColorTexture?.textureSetDefinitionId;"number"==typeof e&&(t.textureData=this.textureDefinitionsSelectedFormats[e]||t.textureData)}}return t}initSelectedFormatsForTextureDefinitions(e){this.textureDefinitionsSelectedFormats=[];const t=this.getSupportedTextureFormats(),o=e.textureSetDefinitions||[];for(const r of o){const e=r&&r.formats||[];let o=null;for(const r of t){const t=e.find((e=>e.format===r));if(t){o=t;break}}o&&"ktx2"===o.format&&(this.textureLoaderOptions.basis={format:(0,Q.a)(),containerFormat:"ktx2",module:"encoder"}),this.textureDefinitionsSelectedFormats.push(o)}}getSupportedTextureFormats(){const e=[];if(!this.options.i3s||this.options.i3s.useCompressedTextures){const t=(0,Te.E)();t.has("etc2")&&e.push("ktx-etc2"),t.has("dxt")&&e.push("dds"),e.push("ktx2")}return e.push("jpg"),e.push("png"),e}}function Re(e){const t={};let o=[0,0,0,1];if(e.mbs)o=e.mbs,t.sphere=[...a.C.WGS84.cartographicToCartesian(e.mbs.slice(0,3)),e.mbs[3]];else if(e.obb){t.box=[...a.C.WGS84.cartographicToCartesian(e.obb.center),...e.obb.halfSize,...e.obb.quaternion];const r=(new pe.CB).fromCenterHalfSizeQuaternion(t.box.slice(0,3),e.obb.halfSize,e.obb.quaternion).getBoundingSphere();t.sphere=[...r.center,r.radius],o=[...e.obb.center,r.radius]}const r=e.lodSelection?.[0].metricType,n=e.lodSelection?.[0].maxError,s=me.WH.MESH,i=me.lH.REPLACE;return{...e,mbs:o,boundingVolume:t,lodMetricType:r,lodMetricValue:n,type:s,refine:i}}const Ee=/layers\/[0-9]+$/,ge=/\.slpk$/,Me=/nodes\/([0-9-]+|root)$/,Ae="PointCloud",xe={dataType:null,batchType:null,name:"I3S (Indexed Scene Layers)",id:"i3s",module:"i3s",version:"4.3.2",mimeTypes:["application/octet-stream"],parse:async function(e,t={},o){const s=o.url;t.i3s=t.i3s||{};if("504b0304"===function(e){if(e instanceof ArrayBuffer)return[...new Uint8Array(e,0,4)].map((e=>e.toString(16).padStart(2,"0"))).join("");return null}(e))throw new Error("Files with .slpk extention currently are not supported by I3SLoader");const i=te(s);let a,u;a="auto"===t.i3s.isTileset?Ee.test(i)||ge.test(i):t.i3s.isTileset;u="auto"===t.isTileHeader?Me.test(i):t.i3s.isTileHeader;e=a?await async function(e,t,o){const r=JSON.parse((new TextDecoder).decode(e));if(r?.layerType===Ae)throw new Error("Point Cloud layers currently are not supported by I3SLoader");const s=await async function(e,t,o){const r=te(o.url||"");let s,i;if(e.nodePages)s=new Ce(e,r,t),i=await s.formTileFromNodePages(0);else{const e=oe(`${r}/nodes/root`,t.i3s.token);i=await(0,n.H)(e,xe,{...t,i3s:{...t.i3s,loadContent:!1,isTileHeader:!0,isTileset:!1}})}return{...e,loader:xe,url:r,basePath:r,type:me.yy.I3S,nodePagesTile:s,root:i,lodMetricType:i.lodMetricType,lodMetricValue:i.lodMetricValue}}(r,t,o);return s}(e,t,o):u?await async function(e,t){return e=JSON.parse((new TextDecoder).decode(e)),function(e,t){const o=t.url||"";let r,n,s;e.geometryData&&(r=`${o}/${e.geometryData[0].href}`),e.textureData&&(n=`${o}/${e.textureData[0].href}`),e.attributeData&&(s=function(e,t){const{attributeData:o=[]}=t,r=[];for(let n=0;n<o.length;n++){const t=o[n].href.replace("./","");r.push(`${e}/${t}`)}return r}(o,e));const i=e.children||[];return Re({...e,children:i,url:o,contentUrl:r,textureUrl:n,textureFormat:"jpg",attributeUrls:s,isDracoGeometry:!1})}(e,t)}(e,o):await async function(e,t){return await(0,r.q)(e,_e,t)}(e,t);return e},extensions:["bin"],options:{i3s:{token:null,isTileset:"auto",isTileHeader:"auto",tile:null,tileset:null,_tileOptions:null,_tilesetOptions:null,useDracoGeometry:!0,useCompressedTextures:!0,decodeTextures:!0,coordinateSystem:ae.METER_OFFSETS}}}},28453:(e,t,o)=>{o.d(t,{R:()=>i,x:()=>a});var r=o(96540);const n={},s=r.createContext(n);function i(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);