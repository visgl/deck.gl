"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[1776],{3905:(t,e,i)=>{i.d(e,{Zo:()=>u,kt:()=>d});var n=i(67294);function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){o(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function a(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var l=n.createContext({}),c=function(t){var e=n.useContext(l),i=e;return t&&(i="function"==typeof t?t(e):s(s({},e),t)),i},u=function(t){var e=c(t.components);return n.createElement(l.Provider,{value:e},t.children)},h="mdxType",g={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},_=n.forwardRef((function(t,e){var i=t.components,o=t.mdxType,r=t.originalType,l=t.parentName,u=a(t,["components","mdxType","originalType","parentName"]),h=c(i),_=o,d=h["".concat(l,".").concat(_)]||h[_]||g[_]||r;return i?n.createElement(d,s(s({ref:e},u),{},{components:i})):n.createElement(d,s({ref:e},u))}));function d(t,e){var i=arguments,o=e&&e.mdxType;if("string"==typeof t||o){var r=i.length,s=new Array(r);s[0]=_;var a={};for(var l in e)hasOwnProperty.call(e,l)&&(a[l]=e[l]);a.originalType=t,a[h]="string"==typeof t?t:o,s[1]=a;for(var c=2;c<r;c++)s[c]=i[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,i)}_.displayName="MDXCreateElement"},20745:(t,e,i)=>{var n=i(73935);e.s=n.createRoot,n.hydrateRoot},24808:(t,e,i)=>{i.d(e,{D5:()=>s});var n=i(67294),o=i(83156);i(9547),i(38826),i(81255),i(37442),i(4432),i(6415),i(90552),i(33855),i(46176),i(38824),i(31592);const r=i.e(4613).then(i.t.bind(i,24613,23)),s=n.forwardRef((function(t,e){return(0,o.Z)(t,e,r)}))},41708:(t,e,i)=>{i.d(e,{Z:()=>r});var n=i(60326),o=i(67532);class r{id;topology;vertexCount;indices;attributes;userData={};constructor(t){const{attributes:e={},indices:i=null,vertexCount:r=null}=t;this.id=t.id||(0,n.h)("geometry"),this.topology=t.topology,i&&(this.indices=ArrayBuffer.isView(i)?{value:i,size:1}:i),this.attributes={};for(const[n,s]of Object.entries(e)){const t=ArrayBuffer.isView(s)?{value:s}:s;(0,o.h)(ArrayBuffer.isView(t.value),`${this._print(n)}: must be typed array or object with value as typed array`),"POSITION"!==n&&"positions"!==n||t.size||(t.size=3),"indices"===n?((0,o.h)(!this.indices),this.indices=t):this.attributes[n]=t}this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=r||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return`Geometry ${this.id} attribute ${t}`}_setAttributes(t,e){return this}_calculateVertexCount(t,e){if(e)return e.value.length;let i=1/0;for(const n of Object.values(t)){const{value:t,size:e,constant:o}=n;!o&&t&&e>=1&&(i=Math.min(i,t.length/e))}return(0,o.h)(Number.isFinite(i)),i}}},42013:(t,e,i)=>{i.d(e,{H:()=>s});const n="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\nstruct AmbientLight {\nvec3 color;\n};\nstruct PointLight {\nvec3 color;\nvec3 position;\nvec3 attenuation;\n};\nstruct DirectionalLight {\nvec3 color;\nvec3 direction;\n};\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\nuniform bool lighting_uEnabled;\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\nreturn pointLight.attenuation.x\n+ pointLight.attenuation.y * distance\n+ pointLight.attenuation.z * distance * distance;\n}\n#endif\n",o={lightSources:{}};function r(t={}){const{color:e=[0,0,0],intensity:i=1}=t;return e.map((t=>t*i/255))}const s={name:"lights",vs:n,fs:n,getUniforms:function t(e=o){if("lightSources"in e){const{ambientLight:t,pointLights:i,directionalLights:n}=e.lightSources||{};return t||i&&i.length>0||n&&n.length>0?Object.assign({},function({ambientLight:t,pointLights:e=[],directionalLights:i=[]}){const n={};return n["lighting_uAmbientLight.color"]=t?r(t):[0,0,0],e.forEach(((t,e)=>{n[`lighting_uPointLight[${e}].color`]=r(t),n[`lighting_uPointLight[${e}].position`]=t.position,n[`lighting_uPointLight[${e}].attenuation`]=t.attenuation||[1,0,0]})),n.lighting_uPointLightCount=e.length,i.forEach(((t,e)=>{n[`lighting_uDirectionalLight[${e}].color`]=r(t),n[`lighting_uDirectionalLight[${e}].direction`]=t.direction})),n.lighting_uDirectionalLightCount=i.length,n}({ambientLight:t,pointLights:i,directionalLights:n}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const i={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":i.ambientLight=t;break;case"directional":i.directionalLights?.push(t);break;case"point":i.pointLights?.push(t)}return t({lightSources:i})}return{}},defines:{MAX_LIGHTS:3}}},55098:(t,e,i)=>{i.d(e,{N:()=>a,s:()=>l});var n=i(42013);const o="uniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\nvec3 halfway_direction = normalize(light_direction + view_direction);\nfloat lambertian = dot(light_direction, normal_worldspace);\nfloat specular = 0.0;\nif (lambertian > 0.0) {\nfloat specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\nspecular = pow(specular_angle, lighting_uShininess);\n}\nlambertian = max(lambertian, 0.0);\nreturn (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\nvec3 lightColor = surfaceColor;\nif (lighting_uEnabled) {\nvec3 view_direction = normalize(cameraPosition - position_worldspace);\nlightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (i >= lighting_uPointLightCount) {\nbreak;\n}\nPointLight pointLight = lighting_uPointLight[i];\nvec3 light_position_worldspace = pointLight.position;\nvec3 light_direction = normalize(light_position_worldspace - position_worldspace);\nlightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n}\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (i >= lighting_uDirectionalLightCount) {\nbreak;\n}\nDirectionalLight directionalLight = lighting_uDirectionalLight[i];\nlightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n}\n}\nreturn lightColor;\n}\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\nvec3 lightColor = vec3(0, 0, 0);\nvec3 surfaceColor = vec3(0, 0, 0);\nif (lighting_uEnabled) {\nvec3 view_direction = normalize(cameraPosition - position_worldspace);\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (i >= lighting_uPointLightCount) {\nbreak;\n}\nPointLight pointLight = lighting_uPointLight[i];\nvec3 light_position_worldspace = pointLight.position;\nvec3 light_direction = normalize(light_position_worldspace - position_worldspace);\nlightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n}\nfor (int i = 0; i < MAX_LIGHTS; i++) {\nif (i >= lighting_uDirectionalLightCount) {\nbreak;\n}\nDirectionalLight directionalLight = lighting_uDirectionalLight[i];\nlightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n}\n}\nreturn lightColor;\n}\n",r={};function s(t=r){if(!("material"in t))return{};const{material:e}=t;return e?function(t){const{ambient:e=.35,diffuse:i=.6,shininess:n=32,specularColor:o=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:i,lighting_uShininess:n,lighting_uSpecularColor:o.map((t=>t/255))}}(e):{lighting_uEnabled:!1}}const a={name:"gouraud-lighting",dependencies:[n.H],vs:o,defines:{LIGHTING_VERTEX:1},getUniforms:s},l={name:"phong-lighting",dependencies:[n.H],fs:o,defines:{LIGHTING_FRAGMENT:1},getUniforms:s}},35300:(t,e,i)=>{i.d(e,{q:()=>o});const n=new Float32Array([0,1,1,1]),o={name:"picking",vs:"uniform pickingUniforms {\nfloat isActive;\nfloat isAttribute;\nfloat isHighlightActive;\nfloat useFloatColors;\nvec3 highlightedObjectColor;\nvec4 highlightColor;\n} picking;\nout vec4 picking_vRGBcolor_Avalid;\nvec3 picking_normalizeColor(vec3 color) {\nreturn picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\nvec4 picking_normalizeColor(vec4 color) {\nreturn picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\nbool picking_isColorZero(vec3 color) {\nreturn dot(color, vec3(1.0)) < 0.00001;\n}\nbool picking_isColorValid(vec3 color) {\nreturn dot(color, vec3(1.0)) > 0.00001;\n}\nbool isVertexHighlighted(vec3 vertexColor) {\nvec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);\nreturn\nbool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));\n}\nvoid picking_setPickingColor(vec3 pickingColor) {\npickingColor = picking_normalizeColor(pickingColor);\nif (bool(picking.isActive)) {\npicking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\nif (!bool(picking.isAttribute)) {\npicking_vRGBcolor_Avalid.rgb = pickingColor;\n}\n} else {\npicking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));\n}\n}\nvoid picking_setPickingAttribute(float value) {\nif (bool(picking.isAttribute)) {\npicking_vRGBcolor_Avalid.r = value;\n}\n}\nvoid picking_setPickingAttribute(vec2 value) {\nif (bool(picking.isAttribute)) {\npicking_vRGBcolor_Avalid.rg = value;\n}\n}\nvoid picking_setPickingAttribute(vec3 value) {\nif (bool(picking.isAttribute)) {\npicking_vRGBcolor_Avalid.rgb = value;\n}\n}\n",fs:"uniform pickingUniforms {\nfloat isActive;\nfloat isAttribute;\nfloat isHighlightActive;\nfloat useFloatColors;\nvec3 highlightedObjectColor;\nvec4 highlightColor;\n} picking;\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\nif (picking.isActive > 0.5) {\nreturn color;\n}\nbool selected = bool(picking_vRGBcolor_Avalid.a);\nif (selected) {\nfloat highLightAlpha = picking.highlightColor.a;\nfloat blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\nfloat highLightRatio = highLightAlpha / blendedAlpha;\nvec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);\nreturn vec4(blendedRGB, blendedAlpha);\n} else {\nreturn color;\n}\n}\nvec4 picking_filterPickingColor(vec4 color) {\nif (bool(picking.isActive)) {\nif (picking_vRGBcolor_Avalid.a == 0.0) {\ndiscard;\n}\nreturn picking_vRGBcolor_Avalid;\n}\nreturn color;\n}\nvec4 picking_filterColor(vec4 color) {\nvec4 highlightColor = picking_filterHighlightColor(color);\nreturn picking_filterPickingColor(highlightColor);\n}\n",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:new Float32Array([0,0,0]),highlightColor:n},getUniforms:function(t={},e){const i={};if(void 0===t.highlightedObjectColor);else if(null===t.highlightedObjectColor)i.isHighlightActive=!1;else{i.isHighlightActive=!0;const e=t.highlightedObjectColor.slice(0,3);i.highlightedObjectColor=e}if(t.highlightColor){const e=Array.from(t.highlightColor,(t=>t/255));Number.isFinite(e[3])||(e[3]=1),i.highlightColor=e}void 0!==t.isActive&&(i.isActive=Boolean(t.isActive),i.isAttribute=Boolean(t.isAttribute));void 0!==t.useFloatColors&&(i.useFloatColors=Boolean(t.useFloatColors));return i}}},6089:(t,e,i)=>{i.d(e,{N:()=>st});var n=i(86986),o=i(39470),r=i(51394),s=i(84900),a=i(99313),l=i(34707),c=i(28083),u=i(17935),h=i(85835),g=i(90152),_=i(56709),d=i(77979),p=i(60908);const f={MAGIC_NUMBER:542327876,HEADER_LENGTH:31,MAGIC_NUMBER_INDEX:0,HEADER_SIZE_INDEX:1,HEADER_FLAGS_INDEX:2,HEADER_HEIGHT_INDEX:3,HEADER_WIDTH_INDEX:4,MIPMAPCOUNT_INDEX:7,HEADER_PF_FLAGS_INDEX:20,HEADER_PF_FOURCC_INDEX:21,DDSD_MIPMAPCOUNT:131072,DDPF_FOURCC:4},E={DXT1:d.p.COMPRESSED_RGB_S3TC_DXT1_EXT,DXT3:d.p.COMPRESSED_RGBA_S3TC_DXT3_EXT,DXT5:d.p.COMPRESSED_RGBA_S3TC_DXT5_EXT,"ATC ":d.p.COMPRESSED_RGB_ATC_WEBGL,ATCA:d.p.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL,ATCI:d.p.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL},C={DXT1:A,DXT3:S,DXT5:S,"ATC ":A,ATCA:S,ATCI:S};function m(t){const e=new Int32Array(t,0,f.HEADER_LENGTH),i=e[f.HEADER_PF_FOURCC_INDEX];(0,_.h)(Boolean(e[f.HEADER_PF_FLAGS_INDEX]&f.DDPF_FOURCC),"DDS: Unsupported format, must contain a FourCC code");const n=(o=i,String.fromCharCode(255&o,o>>8&255,o>>16&255,o>>24&255));var o;const r=E[n],s=C[n];(0,_.h)(r&&s,`DDS: Unknown pixel format ${i}`);let a=1;e[f.HEADER_FLAGS_INDEX]&f.DDSD_MIPMAPCOUNT&&(a=Math.max(1,e[f.MIPMAPCOUNT_INDEX]));const l=e[f.HEADER_WIDTH_INDEX],c=e[f.HEADER_HEIGHT_INDEX],u=e[f.HEADER_SIZE_INDEX]+4,h=new Uint8Array(t,u);return(0,p.J)(h,{mipMapLevels:a,width:l,height:c,sizeFunction:s,internalFormat:r})}function A(t,e){return(t+3>>2)*(e+3>>2)*8}function S(t,e){return(t+3>>2)*(e+3>>2)*16}const b={MAGIC_NUMBER:55727696,MAGIC_NUMBER_EXTRA:1347834371,HEADER_LENGTH:13,HEADER_SIZE:52,MAGIC_NUMBER_INDEX:0,PIXEL_FORMAT_INDEX:2,COLOUR_SPACE_INDEX:4,HEIGHT_INDEX:6,WIDTH_INDEX:7,MIPMAPCOUNT_INDEX:11,METADATA_SIZE_INDEX:12},R={0:[d.p.COMPRESSED_RGB_PVRTC_2BPPV1_IMG],1:[d.p.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG],2:[d.p.COMPRESSED_RGB_PVRTC_4BPPV1_IMG],3:[d.p.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG],6:[d.p.COMPRESSED_RGB_ETC1_WEBGL],7:[d.p.COMPRESSED_RGB_S3TC_DXT1_EXT],9:[d.p.COMPRESSED_RGBA_S3TC_DXT3_EXT],11:[d.p.COMPRESSED_RGBA_S3TC_DXT5_EXT],22:[d.p.COMPRESSED_RGB8_ETC2],23:[d.p.COMPRESSED_RGBA8_ETC2_EAC],24:[d.p.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2],25:[d.p.COMPRESSED_R11_EAC],26:[d.p.COMPRESSED_RG11_EAC],27:[d.p.COMPRESSED_RGBA_ASTC_4X4_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR],28:[d.p.COMPRESSED_RGBA_ASTC_5X4_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR],29:[d.p.COMPRESSED_RGBA_ASTC_5X5_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR],30:[d.p.COMPRESSED_RGBA_ASTC_6X5_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR],31:[d.p.COMPRESSED_RGBA_ASTC_6X6_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR],32:[d.p.COMPRESSED_RGBA_ASTC_8X5_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR],33:[d.p.COMPRESSED_RGBA_ASTC_8X6_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR],34:[d.p.COMPRESSED_RGBA_ASTC_8X8_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR],35:[d.p.COMPRESSED_RGBA_ASTC_10X5_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR],36:[d.p.COMPRESSED_RGBA_ASTC_10X6_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR],37:[d.p.COMPRESSED_RGBA_ASTC_10X8_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR],38:[d.p.COMPRESSED_RGBA_ASTC_10X10_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR],39:[d.p.COMPRESSED_RGBA_ASTC_12X10_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR],40:[d.p.COMPRESSED_RGBA_ASTC_12X12_KHR,d.p.COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR]},T={0:v,1:v,2:D,3:D,6:P,7:P,9:M,11:M,22:P,23:M,24:P,25:P,26:M,27:M,28:function(t,e){return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16},29:function(t,e){return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16},30:function(t,e){return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16},31:function(t,e){return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16},32:function(t,e){return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16},33:function(t,e){return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16},34:function(t,e){return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16},35:function(t,e){return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16},36:function(t,e){return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16},37:function(t,e){return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16},38:function(t,e){return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16},39:function(t,e){return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16},40:function(t,e){return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16}};function v(t,e){return(t=Math.max(t,16))*(e=Math.max(e,8))/4}function D(t,e){return(t=Math.max(t,8))*(e=Math.max(e,8))/2}function P(t,e){return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8}function M(t,e){return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16}function y(t){if((0,g.j)(t))return(0,g.P)(t);if(function(t){return new Uint32Array(t,0,f.HEADER_LENGTH)[f.MAGIC_NUMBER_INDEX]===f.MAGIC_NUMBER}(t))return m(t);if(function(t){const e=new Uint32Array(t,0,b.HEADER_LENGTH)[b.MAGIC_NUMBER_INDEX];return e===b.MAGIC_NUMBER||e===b.MAGIC_NUMBER_EXTRA}(t))return function(t){const e=new Uint32Array(t,0,b.HEADER_LENGTH),i=e[b.PIXEL_FORMAT_INDEX],n=e[b.COLOUR_SPACE_INDEX],o=R[i]||[],r=o.length>1&&n?o[1]:o[0],s=T[i],a=e[b.MIPMAPCOUNT_INDEX],l=e[b.WIDTH_INDEX],c=e[b.HEIGHT_INDEX],u=b.HEADER_SIZE+e[b.METADATA_SIZE_INDEX],h=new Uint8Array(t,u);return(0,p.J)(h,{mipMapLevels:a,width:l,height:c,sizeFunction:s,internalFormat:r})}(t);throw new Error("Texture container format not recognized")}var L=i(87369);const x={...{dataType:null,batchType:null,name:"Texture Containers",id:"compressed-texture",module:"textures",version:h.q,worker:!0,extensions:["ktx","ktx2","dds","pvr"],mimeTypes:["image/ktx2","image/ktx","image/vnd-ms.dds","image/x-dds","application/octet-stream"],binary:!0,options:{"compressed-texture":{libraryPath:"libs/",useBasis:!1}}},parse:async(t,e)=>{if(e?.["compressed-texture"]?.useBasis){e.basis={format:{alpha:"BC3",noAlpha:"BC1"},...e.basis,containerFormat:"ktx2",module:"encoder"};return(await(0,L.Z)(t,e))[0]}return y(t)}};var O,G=i(22406);function I(t){let e;try{const i=new URL(t);e=`${i.origin}${i.pathname}`,e.startsWith("null")&&(e=null)}catch(i){e=null}return e||t}function w(t,e=null){return e?`${t}?token=${e}`:t}!function(t){t.vertexCount="vertexCount",t.featureCount="featureCount"}(O||(O={}));var H=i(2634);function N(t){switch(t){case"UInt8":return Uint8Array;case"UInt16":return Uint16Array;case"UInt32":return Uint32Array;case"Float32":return Float32Array;case"UInt64":return Float64Array;default:throw new Error(`parse i3s tile content: unknown type of data: ${t}`)}}const k={UInt8:H.GL.UNSIGNED_BYTE,UInt16:H.GL.UNSIGNED_SHORT,Float32:H.GL.FLOAT,UInt32:H.GL.UNSIGNED_INT,UInt64:H.GL.DOUBLE};function B(t){switch(t){case"UInt8":return 1;case"UInt16":case"Int16":return 2;case"UInt32":case"Int32":case"Float32":return 4;case"UInt64":case"Int64":case"Float64":return 8;default:throw new Error(`parse i3s tile content: unknown size of data: ${t}`)}}var F;!function(t){t[t.DEFAULT=-1]="DEFAULT",t[t.LNGLAT=1]="LNGLAT",t[t.METER_OFFSETS=2]="METER_OFFSETS",t[t.LNGLAT_OFFSETS=3]="LNGLAT_OFFSETS",t[t.CARTESIAN=0]="CARTESIAN"}(F||(F={}));const X=new r.P([0,0,0]);const U="i3s-attribute-type";async function j(t,e,i,h,g){const _={attributes:{},indices:null,featureIds:[],vertexCount:0,modelMatrix:new s.y,coordinateSystem:0,byteLength:0,texture:null};if(e.textureUrl){const t=w(e.textureUrl,h?.i3s?.token),i=function(t){switch(t){case"ktx-etc2":case"dds":return x;case"ktx2":return G.G;default:return c.S}}(e.textureFormat),r=g?.fetch||fetch,s=await r(t),a=await s.arrayBuffer();if(h?.i3s.decodeTextures){if(i===c.S){const t={...e.textureLoaderOptions,image:{type:"data"}};try{const e=await(0,l.cr)(a,[],t,g);_.texture=e}catch(d){const e=await(0,n.Q)(a,i,t,g);_.texture=e}}else if(i===x||i===G.G){let t=await(0,o.z)(a,i,e.textureLoaderOptions);i===G.G&&(t=t[0]),_.texture={compressed:!0,mipmaps:!1,width:t[0].width,height:t[0].height,data:t}}}else _.texture=a}return _.material=function(t,e){let i;t?i={...t,pbrMetallicRoughness:t.pbrMetallicRoughness?{...t.pbrMetallicRoughness}:{baseColorFactor:[255,255,255,255]}}:(i={pbrMetallicRoughness:{}},e?i.pbrMetallicRoughness.baseColorTexture={texCoord:0}:i.pbrMetallicRoughness.baseColorFactor=[255,255,255,255]);i.alphaCutoff=i.alphaCutoff||.25,i.alphaMode&&(i.alphaMode=i.alphaMode.toUpperCase());i.emissiveFactor&&(i.emissiveFactor=V(i.emissiveFactor));i.pbrMetallicRoughness&&i.pbrMetallicRoughness.baseColorFactor&&(i.pbrMetallicRoughness.baseColorFactor=V(i.pbrMetallicRoughness.baseColorFactor));e&&function(t,e){const i={source:{image:e}};t.pbrMetallicRoughness&&t.pbrMetallicRoughness.baseColorTexture?t.pbrMetallicRoughness.baseColorTexture={...t.pbrMetallicRoughness.baseColorTexture,texture:i}:t.emissiveTexture?t.emissiveTexture={...t.emissiveTexture,texture:i}:t.pbrMetallicRoughness&&t.pbrMetallicRoughness.metallicRoughnessTexture?t.pbrMetallicRoughness.metallicRoughnessTexture={...t.pbrMetallicRoughness.metallicRoughnessTexture,texture:i}:t.normalTexture?t.normalTexture={...t.normalTexture,texture:i}:t.occlusionTexture&&(t.occlusionTexture={...t.occlusionTexture,texture:i})}(i,e);return i}(e.materialDefinition,_.texture),_.material&&(_.texture=null),await async function(t,e,i,o,l){const c=t.byteLength;let h,g,_,d=0,p=0;if(i.isDracoGeometry){const e=await(0,n.Q)(t,u.VJ,{draco:{attributeNameEntry:U}});g=e.header.vertexCount,_=e.indices?.value;const{POSITION:i,NORMAL:o,COLOR_0:r,TEXCOORD_0:s,"feature-index":a,"uv-region":l}=e.attributes;h={position:i,normal:o,color:r,uv0:s,uvRegion:l,id:a},function(t,e){for(const i in e.loaderData.attributes){const n=e.loaderData.attributes[i];switch(n.name){case"POSITION":t.position.metadata=n.metadata;break;case"feature-index":t.id.metadata=n.metadata}}}(h,e);const c=function(t){return t?.metadata?.["i3s-feature-ids"]?.intArray}(a);c&&function(t,e){const i=t.id.value,n=new Float32Array(i.length);for(let o=0;o<i.length;o++)n[o]=e[i[o]];t.id.value=n}(h,c)}else{const{vertexAttributes:e,ordering:i,featureAttributes:n,featureAttributeOrder:r}=o.store.defaultGeometrySchema,s=function(t,e){let i=0,n=0,o=0;for(const{property:r,type:s}of e.store.defaultGeometrySchema.header){const e=N(s);switch(r){case O.vertexCount.toString():n=new e(t,0,4)[0],i+=B(s);break;case O.featureCount.toString():o=new e(t,4,4)[0],i+=B(s)}}return{vertexCount:n,featureCount:o,byteOffset:i}}(t,o);d=s.byteOffset,g=s.vertexCount,p=s.featureCount;const{attributes:a,byteOffset:l}=z(t,d,e,g,i),{attributes:c}=z(t,l,n,p,r);!function(t){const{id:e,faceRange:i}=t;if(!e||!i)return;const n=e.value,o=i.value,r=o[o.length-1]+1,s=new Uint32Array(3*r);let a=0,l=0;for(let c=1;c<o.length;c+=2){const t=Number(n[a]),e=l+3*(o[c]-o[c-1]+1);s.fill(t,l,e),a++,l=e}t.id.value=s}(c),h=function(t,e){return{...t,...e}}(a,c)}if(l?.i3s?.coordinateSystem&&l.i3s.coordinateSystem!==F.METER_OFFSETS)e.modelMatrix=function(t){const e=t.metadata,i=e?.["i3s-scale_x"]?.double||1,n=e?.["i3s-scale_y"]?.double||1,o=new s.y;return o[0]=i,o[5]=n,o}(h.position),e.coordinateSystem=F.LNGLAT_OFFSETS;else{const t=function(t,e){const i=e.mbs,n=t.value,o=t.metadata,l=new s.y,c=new r.P(i[0],i[1],i[2]),u=new r.P;return a.H.WGS84.cartographicToCartesian(c,u),a.H.WGS84.eastNorthUpToFixedFrame(u,l),t.value=function(t,e={},i){const n=new Float64Array(t.length),o=e["i3s-scale_x"]&&e["i3s-scale_x"].double||1,r=e["i3s-scale_y"]&&e["i3s-scale_y"].double||1;for(let s=0;s<n.length;s+=3)n[s]=t[s]*o+i.x,n[s+1]=t[s+1]*r+i.y,n[s+2]=t[s+2]+i.z;for(let s=0;s<n.length;s+=3)a.H.WGS84.cartographicToCartesian(n.subarray(s,s+3),X),n[s]=X.x,n[s+1]=X.y,n[s+2]=X.z;return n}(n,o,c),l}(h.position,i);e.modelMatrix=t.invert(),e.coordinateSystem=F.METER_OFFSETS}e.attributes={positions:h.position,normals:h.normal,colors:$(h.color),texCoords:h.uv0,uvRegions:$(h.uvRegion||h.region)},e.indices=_||null,h.id&&h.id.value&&(e.featureIds=h.id.value);for(const n in e.attributes)e.attributes[n]||delete e.attributes[n];return e.vertexCount=g,e.byteLength=c,e}(t,_,e,i,h)}function $(t){return t?(t.normalized=!0,t):t}function z(t,e,i,n,o){const r={};for(const s of o)if(i[s]){const{valueType:o,valuesPerElement:a}=i[s];if(e+n*a*B(o)<=t.byteLength){const i=t.slice(e);let l;if("UInt64"===o)l=K(i,n*a,B(o));else{l=new(N(o))(i,0,n*a)}if(r[s]={value:l,type:k[o],size:a},"color"===s)r.color.normalized=!0;e+=n*a*B(o)}else if("uv0"!==s)break}return{attributes:r,byteOffset:e}}function K(t,e,i){const n=[],o=new DataView(t);let r=0;for(let s=0;s<e;s++){const t=o.getUint32(r,!0)+2**32*o.getUint32(r+4,!0);n.push(t),r+=i}return new Uint32Array(n)}function V(t){const e=[...t];for(let i=0;i<t.length;i++)e[i]=t[i]/255;return e}const W={dataType:null,batchType:null,name:"I3S Content (Indexed Scene Layers)",id:"i3s-content",module:"i3s",worker:!0,version:"4.2.1",mimeTypes:["application/octet-stream"],parse:async function(t,e,i){const{tile:n,_tileOptions:o,tileset:r,_tilesetOptions:s}=e?.i3s||{},a=o||n,l=s||r;if(!a||!l)return null;return await j(t,a,l,e,i)},extensions:["bin"],options:{"i3s-content":{}}};var Z=i(5044),J=i(61439),q=i(63663);const Q={dataType:null,batchType:null,name:"I3S Node Page",id:"i3s-node-page",module:"i3s",version:"4.2.1",mimeTypes:["application/json"],parse:async function(t,e){return JSON.parse((new TextDecoder).decode(t))},extensions:["json"],options:{i3s:{}}};class Y{tileset;nodePages=[];pendingNodePages=[];nodesPerPage;options;lodSelectionMetricType;textureDefinitionsSelectedFormats=[];nodesInNodePages;url;textureLoaderOptions={};constructor(t,e="",i){this.tileset={...t},this.url=e,this.nodesPerPage=t.nodePages?.nodesPerPage||64,this.lodSelectionMetricType=t.nodePages?.lodSelectionMetricType,this.options=i,this.nodesInNodePages=0,this.initSelectedFormatsForTextureDefinitions(t)}async getNodeById(t){const e=Math.floor(t/this.nodesPerPage);if(!this.nodePages[e]&&!this.pendingNodePages[e]){const t=w(`${this.url}/nodepages/${e}`,this.options.i3s?.token);this.pendingNodePages[e]={status:"Pending",promise:(0,o.z)(t,Q,this.options)},this.nodePages[e]=await this.pendingNodePages[e].promise,this.nodesInNodePages+=this.nodePages[e].nodes.length,this.pendingNodePages[e].status="Done"}"Pending"===this.pendingNodePages[e].status&&(this.nodePages[e]=await this.pendingNodePages[e].promise);const i=t%this.nodesPerPage;return this.nodePages[e].nodes[i]}async formTileFromNodePages(t){const e=await this.getNodeById(t),i=[],n=[];for(const g of e.children||[])n.push(this.getNodeById(g));const o=await Promise.all(n);for(const g of o)i.push({id:g.index.toString(),obb:g.obb});let r,s,a,l="jpg",c=[],u=!1;if(e&&e.mesh){const{url:t,isDracoGeometry:i}=e.mesh.geometry&&this.getContentUrl(e.mesh.geometry)||{isDracoGeometry:!1};r=t,u=i;const{textureData:n,materialDefinition:o}=this.getInformationFromMaterial(e.mesh.material);a=o,l=n.format||l,n.name&&(s=`${this.url}/nodes/${e.mesh.material.resource}/textures/${n.name}`),this.tileset.attributeStorageInfo&&(c=function(t,e,i){const n=[],{attributeStorageInfo:o=[]}=t;for(let r=0;r<o.length;r++){const t=o[r].key;n.push(`${e}/nodes/${i}/attributes/${t}/0`)}return n}(this.tileset,this.url,e.mesh.attribute.resource))}const h=this.getLodSelection(e);return tt({id:t.toString(),lodSelection:h,obb:e.obb,contentUrl:r,textureUrl:s,attributeUrls:c,materialDefinition:a,textureFormat:l,textureLoaderOptions:this.textureLoaderOptions,children:i,isDracoGeometry:u})}getContentUrl(t){let e=null;const i=this.tileset.geometryDefinitions[t.definition];let n=-1;if(this.options.i3s&&this.options.i3s.useDracoGeometry&&(n=i.geometryBuffers.findIndex((t=>t.compressedAttributes&&"draco"===t.compressedAttributes.encoding))),-1===n&&(n=i.geometryBuffers.findIndex((t=>!t.compressedAttributes))),-1!==n){const o=Boolean(i.geometryBuffers[n].compressedAttributes);e={url:`${this.url}/nodes/${t.resource}/geometries/${n}`,isDracoGeometry:o}}return e}getLodSelection(t){const e=[];return"maxScreenThresholdSQ"===this.lodSelectionMetricType&&e.push({metricType:"maxScreenThreshold",maxError:Math.sqrt(t.lodThreshold/(.25*Math.PI))}),e.push({metricType:this.lodSelectionMetricType,maxError:t.lodThreshold}),e}getInformationFromMaterial(t){const e={textureData:{name:null}};if(t){const i=this.tileset.materialDefinitions?.[t.definition];if(i){e.materialDefinition=i;const t=i?.pbrMetallicRoughness?.baseColorTexture?.textureSetDefinitionId;"number"==typeof t&&(e.textureData=this.textureDefinitionsSelectedFormats[t]||e.textureData)}}return e}initSelectedFormatsForTextureDefinitions(t){this.textureDefinitionsSelectedFormats=[];const e=this.getSupportedTextureFormats(),i=t.textureSetDefinitions||[];for(const n of i){const t=n&&n.formats||[];let i=null;for(const n of e){const e=t.find((t=>t.format===n));if(e){i=e;break}}i&&"ktx2"===i.format&&(this.textureLoaderOptions.basis={format:(0,L.h)(),containerFormat:"ktx2",module:"encoder"}),this.textureDefinitionsSelectedFormats.push(i)}}getSupportedTextureFormats(){const t=[];if(!this.options.i3s||this.options.i3s.useCompressedTextures){const e=(0,q.U)();e.has("etc2")&&t.push("ktx-etc2"),e.has("dxt")&&t.push("dds"),t.push("ktx2")}return t.push("jpg"),t.push("png"),t}}function tt(t){const e={};let i=[0,0,0,1];if(t.mbs)i=t.mbs,e.sphere=[...a.H.WGS84.cartographicToCartesian(t.mbs.slice(0,3)),t.mbs[3]];else if(t.obb){e.box=[...a.H.WGS84.cartographicToCartesian(t.obb.center),...t.obb.halfSize,...t.obb.quaternion];const n=(new Z.F7).fromCenterHalfSizeQuaternion(e.box.slice(0,3),t.obb.halfSize,t.obb.quaternion).getBoundingSphere();e.sphere=[...n.center,n.radius],i=[...t.obb.center,n.radius]}const n=t.lodSelection?.[0].metricType,o=t.lodSelection?.[0].maxError,r=J.R7.MESH,s=J.F$.REPLACE;return{...t,mbs:i,boundingVolume:e,lodMetricType:n,lodMetricValue:o,type:r,refine:s}}const et=/layers\/[0-9]+$/,it=/\.slpk$/,nt=/nodes\/([0-9-]+|root)$/,ot="504b0304",rt="PointCloud",st={dataType:null,batchType:null,name:"I3S (Indexed Scene Layers)",id:"i3s",module:"i3s",version:"4.2.1",mimeTypes:["application/octet-stream"],parse:async function(t,e={},i){const r=i.url;e.i3s=e.i3s||{};if(function(t){if(t instanceof ArrayBuffer)return[...new Uint8Array(t,0,4)].map((t=>t.toString(16).padStart(2,"0"))).join("");return null}(t)===ot)throw new Error("Files with .slpk extention currently are not supported by I3SLoader");const s=I(r);let a,l;a="auto"===e.i3s.isTileset?et.test(s)||it.test(s):e.i3s.isTileset;l="auto"===e.isTileHeader?nt.test(s):e.i3s.isTileHeader;t=a?await async function(t,e,i){const n=JSON.parse((new TextDecoder).decode(t));if(n?.layerType===rt)throw new Error("Point Cloud layers currently are not supported by I3SLoader");const r=await async function(t,e,i){const n=I(i.url||"");let r,s;if(t.nodePages)r=new Y(t,n,e),s=await r.formTileFromNodePages(0);else{const t=w(`${n}/nodes/root`,e.i3s.token);s=await(0,o.z)(t,st,{...e,i3s:{...e.i3s,loadContent:!1,isTileHeader:!0,isTileset:!1}})}return{...t,loader:st,url:n,basePath:n,type:J.i3.I3S,nodePagesTile:r,root:s,lodMetricType:s.lodMetricType,lodMetricValue:s.lodMetricValue}}(n,e,i);return r}(t,e,i):l?await async function(t,e){return t=JSON.parse((new TextDecoder).decode(t)),function(t,e){const i=e.url||"";let n,o,r;t.geometryData&&(n=`${i}/${t.geometryData[0].href}`),t.textureData&&(o=`${i}/${t.textureData[0].href}`),t.attributeData&&(r=function(t,e){const{attributeData:i=[]}=e,n=[];for(let o=0;o<i.length;o++){const e=i[o].href.replace("./","");n.push(`${t}/${e}`)}return n}(i,t));const s=t.children||[];return tt({...t,children:s,url:i,contentUrl:n,textureUrl:o,textureFormat:"jpg",attributeUrls:r,isDracoGeometry:!1})}(t,e)}(t,i):await async function(t,e){return await(0,n.Q)(t,W,e)}(t,e);return t},extensions:["bin"],options:{i3s:{token:null,isTileset:"auto",isTileHeader:"auto",tile:null,tileset:null,_tileOptions:null,_tilesetOptions:null,useDracoGeometry:!0,useCompressedTextures:!0,decodeTextures:!0,coordinateSystem:F.METER_OFFSETS}}}}}]);