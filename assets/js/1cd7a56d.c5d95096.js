"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[4252],{62070:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"api-reference/carto/heatmap-tile-layer","title":"HeatmapTileLayer","description":"HeatmapTileLayer is a layer for visualizing point data aggregated using spatial indexes like Quadbin or H3 using a heatmap. The layer automatically detects the spatial index type and renders cells accordingly.","source":"@site/../docs/api-reference/carto/heatmap-tile-layer.md","sourceDirName":"api-reference/carto","slug":"/api-reference/carto/heatmap-tile-layer","permalink":"/docs/api-reference/carto/heatmap-tile-layer","draft":false,"unlisted":false,"editUrl":"https://github.com/visgl/deck.gl/tree/master/website/../docs/api-reference/carto/heatmap-tile-layer.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"H3TileLayer","permalink":"/docs/api-reference/carto/h3-tile-layer"},"next":{"title":"QuadbinTileLayer","permalink":"/docs/api-reference/carto/quadbin-tile-layer"}}');var a=i(74848),l=i(28453);const r={},t="HeatmapTileLayer",c={},o=[{value:"Usage",id:"usage",level:2},{value:"Installation",id:"installation",level:2},{value:"Properties",id:"properties",level:2},{value:"<code>data</code> (TilejsonResult)",id:"data",level:4},{value:"Render Options",id:"render-options",level:3},{value:"<code>radiusPixels</code> (number, optional) transition-enabled",id:"radiuspixels",level:4},{value:"<code>colorDomain</code> (number[2], optional) transition-enabled",id:"colordomain",level:4},{value:"<code>colorRange</code> (Color[], optional)",id:"colorrange",level:4},{value:"<code>intensity</code> (number, optional) transition-enabled",id:"intensity",level:4},{value:"Data Accessors",id:"data-accessors",level:3},{value:"<code>getWeight</code> (Accessor&lt;number&gt;, optional)",id:"getweight",level:4},{value:"Callbacks",id:"callbacks",level:3},{value:"<code>onMaxDensityChange</code> (Function, optional)",id:"onmaxdensitychange",level:4},{value:"Example",id:"example",level:5}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"heatmaptilelayer",children:"HeatmapTileLayer"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"HeatmapTileLayer"})," is a layer for visualizing point data aggregated using spatial indexes like ",(0,a.jsx)(n.a,{href:"https://docs.carto.com/data-and-analysis/analytics-toolbox-for-bigquery/key-concepts/spatial-indexes#quadbin",children:"Quadbin"})," or ",(0,a.jsx)(n.a,{href:"https://docs.carto.com/data-and-analysis/analytics-toolbox-for-bigquery/key-concepts/spatial-indexes#h3",children:"H3"})," using a heatmap. The layer automatically detects the spatial index type and renders cells accordingly."]}),"\n",(0,a.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"import {DeckGL} from '@deck.gl/react';\nimport {HeatmapTileLayer} from '@deck.gl/carto';\nimport {quadbinTableSource} from '@carto/api-client';\n\nfunction App({viewState}) {\n  const data = quadbinTableSource({\n    accessToken: 'XXX',\n    connectionName: 'carto_dw',\n    tableName: 'carto-demo-data.demo_tables.quadbin'\n  });\n\n  const layer = new HeatmapTileLayer({\n    data,\n    getWeight: d => d.properties.count,\n    // Customize appearance\n    radiusPixels: 30,\n    intensity: 1.5,\n    colorDomain: [0, 2],\n    // Optional: Track density changes\n    onMaxDensityChange: (density) => console.log('Max density:', density)\n  })\n\n  return <DeckGL viewState={viewState} layers={[layer]} />;\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsx)(n.p,{children:"To install the dependencies from NPM:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm install deck.gl\n# or\nnpm install @deck.gl/core @deck.gl/layers @deck.gl/carto\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"import {HeatmapTileLayer} from '@deck.gl/carto';\nnew HeatmapTileLayer({});\n"})}),"\n",(0,a.jsx)(n.p,{children:"To use pre-bundled scripts:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-html",children:'<script src="https://unpkg.com/deck.gl@^9.0.0/dist.min.js"><\/script>\n<script src="https://unpkg.com/@deck.gl/carto@^9.0.0/dist.min.js"><\/script>\n\n\x3c!-- or --\x3e\n<script src="https://unpkg.com/@deck.gl/core@^9.0.0/dist.min.js"><\/script>\n<script src="https://unpkg.com/@deck.gl/layers@^9.0.0/dist.min.js"><\/script>\n<script src="https://unpkg.com/@deck.gl/geo-layers@^9.0.0/dist.min.js"><\/script>\n<script src="https://unpkg.com/@deck.gl/carto@^9.0.0/dist.min.js"><\/script>\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"new deck.carto.HeatmapTileLayer({});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,a.jsxs)(n.p,{children:["Inherits from all ",(0,a.jsx)(n.a,{href:"/docs/api-reference/core/layer",children:"Base Layer"})," and ",(0,a.jsx)(n.a,{href:"/docs/api-reference/core/composite-layer",children:"CompositeLayer"})," properties."]}),"\n",(0,a.jsxs)(n.h4,{id:"data",children:[(0,a.jsx)(n.code,{children:"data"})," (TilejsonResult)"]}),"\n",(0,a.jsxs)(n.p,{children:["Required. A valid ",(0,a.jsx)(n.code,{children:"TilejsonResult"})," object."]}),"\n",(0,a.jsxs)(n.p,{children:["Use one of the following ",(0,a.jsx)(n.a,{href:"/docs/api-reference/carto/data-sources",children:"Data Sources"})," to fetch this from the CARTO API:"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Quadbin sources:"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"./data-sources#quadbintablesource",children:"quadbinTableSource"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"./data-sources#quadbinquerysource",children:"quadbinQuerySource"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"./data-sources#quadbintilesetsource",children:"quadbinTilesetSource"})}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"H3 sources:"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"./data-sources#h3tablesource",children:"h3TableSource"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"./data-sources#h3querysource",children:"h3QuerySource"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"./data-sources#h3tilesetsource",children:"h3TilesetSource"})}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"render-options",children:"Render Options"}),"\n",(0,a.jsxs)(n.h4,{id:"radiuspixels",children:[(0,a.jsx)(n.code,{children:"radiusPixels"})," (number, optional) ",(0,a.jsx)(n.img,{src:"https://img.shields.io/badge/transition-enabled-green.svg?style=flat-square%22",alt:"transition-enabled"})]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Default: ",(0,a.jsx)(n.code,{children:"20"})]}),"\n",(0,a.jsxs)(n.li,{children:["Range: ",(0,a.jsx)(n.code,{children:"[0, 100]"})]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Radius of the heatmap blur in pixels, to which the weight of a cell is distributed. Larger values create a smoother heatmap but may impact performance."}),"\n",(0,a.jsxs)(n.h4,{id:"colordomain",children:[(0,a.jsx)(n.code,{children:"colorDomain"})," (number[2], optional) ",(0,a.jsx)(n.img,{src:"https://img.shields.io/badge/transition-enabled-green.svg?style=flat-square%22",alt:"transition-enabled"})]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Default: ",(0,a.jsx)(n.code,{children:"[0, 1]"})]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Controls how weight values are mapped to the ",(0,a.jsx)(n.code,{children:"colorRange"}),", as an array of two numbers [",(0,a.jsx)(n.code,{children:"minValue"}),", ",(0,a.jsx)(n.code,{children:"maxValue"}),"]. The values are normalized, with a value of ",(0,a.jsx)(n.code,{children:"1"})," corresponding to the maximum density present in the viewport."]}),"\n",(0,a.jsxs)(n.p,{children:["When ",(0,a.jsx)(n.code,{children:"colorDomain"})," is specified:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Values below ",(0,a.jsx)(n.code,{children:"minValue"})," are gradually faded out (alpha transitions from 0 to 1)"]}),"\n",(0,a.jsxs)(n.li,{children:["Values between ",(0,a.jsx)(n.code,{children:"minValue"})," and ",(0,a.jsx)(n.code,{children:"maxValue"})," are linearly mapped to colors in ",(0,a.jsx)(n.code,{children:"colorRange"})]}),"\n",(0,a.jsxs)(n.li,{children:["Values above ",(0,a.jsx)(n.code,{children:"maxValue"})," are capped to the last color in ",(0,a.jsx)(n.code,{children:"colorRange"})]}),"\n"]}),"\n",(0,a.jsxs)(n.h4,{id:"colorrange",children:[(0,a.jsx)(n.code,{children:"colorRange"})," (Color[], optional)"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Default: ",(0,a.jsx)(n.a,{href:"http://colorbrewer2.org/#type=sequential&scheme=YlOrRd&n=6",children:"colorbrewer"})," ",(0,a.jsx)(n.code,{children:"6-class YlOrRd"})," ",(0,a.jsx)("img",{src:"https://deck.gl/images/colorbrewer_YlOrRd_6.png"})]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["The color palette used in the heatmap, as an array of colors [color1, color2, ...]. Each color is in the format of ",(0,a.jsx)(n.code,{children:"[r, g, b]"})," or ",(0,a.jsx)(n.code,{children:"[r, g, b, a]"}),". Each channel is a number between 0-255."]}),"\n",(0,a.jsxs)(n.h4,{id:"intensity",children:[(0,a.jsx)(n.code,{children:"intensity"})," (number, optional) ",(0,a.jsx)(n.img,{src:"https://img.shields.io/badge/transition-enabled-green.svg?style=flat-square%22",alt:"transition-enabled"})]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Default: ",(0,a.jsx)(n.code,{children:"1"})]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Value that is multiplied with the total weight at a pixel to obtain the final weight:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Values > 1 emphasize high-density areas"}),"\n",(0,a.jsx)(n.li,{children:"Values < 1 emphasize low-density areas"}),"\n",(0,a.jsx)(n.li,{children:"Value of 1 provides linear mapping"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"data-accessors",children:"Data Accessors"}),"\n",(0,a.jsxs)(n.h4,{id:"getweight",children:[(0,a.jsx)(n.code,{children:"getWeight"})," (",(0,a.jsx)(n.a,{href:"/docs/developer-guide/using-layers#accessors",children:"Accessor<number>"}),", optional)"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Default: ",(0,a.jsx)(n.code,{children:"1"})]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Method called to retrieve weight of each spatial index cell (quadbin or H3). By default each cell will use a weight of ",(0,a.jsx)(n.code,{children:"1"}),"."]}),"\n",(0,a.jsx)(n.h3,{id:"callbacks",children:"Callbacks"}),"\n",(0,a.jsxs)(n.h4,{id:"onmaxdensitychange",children:[(0,a.jsx)(n.code,{children:"onMaxDensityChange"})," (Function, optional)"]}),"\n",(0,a.jsxs)(n.p,{children:["Function that is called when the maximum density of the displayed data changes. The units correspond to a density, such that a value of ",(0,a.jsx)(n.code,{children:"1"})," is a weight of ",(0,a.jsx)(n.code,{children:"1"})," across the entire world, in Mercator projection space. To obtain the density the layer invokes the ",(0,a.jsx)(n.code,{children:"getWeight"})," accessor on all visible quadbin cells, normalizing by the cell area (",(0,a.jsx)(n.code,{children:"0.25 ** cellZ"}),"). The value is then heurstically adjusted based on the viewport zoom to give smooth transitions when the data changes."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Default: ",(0,a.jsx)(n.code,{children:"null"})]}),"\n"]}),"\n",(0,a.jsx)(n.h5,{id:"example",children:"Example"}),"\n",(0,a.jsxs)(n.p,{children:["A quadbin cell at zoom level ",(0,a.jsx)(n.code,{children:"2"})," with a ",(0,a.jsx)(n.code,{children:"weight"})," of ",(0,a.jsx)(n.code,{children:"1000"})," gives a density of ",(0,a.jsx)(n.code,{children:"16000"})," (",(0,a.jsx)(n.code,{children:"1000 / (0.25 ** 2)"}),"). Upon zooming in, there are different ways the data can be distributed, with the extremes are given here:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["At zoom level ",(0,a.jsx)(n.code,{children:"3"})," the cell splits equally into four cells with weight ",(0,a.jsx)(n.code,{children:"250"}),". The density stays at ",(0,a.jsx)(n.code,{children:"16000"})," (",(0,a.jsx)(n.code,{children:"250 / (0.25 ** 3)"}),")."]}),"\n",(0,a.jsxs)(n.li,{children:["The cell splits into three empty cells and one with weight ",(0,a.jsx)(n.code,{children:"1000"}),". The density increases to ",(0,a.jsx)(n.code,{children:"64000"})," (",(0,a.jsx)(n.code,{children:"1000 / (0.25 ** 3)"}),")."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>t});var s=i(96540);const a={},l=s.createContext(a);function r(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);