(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{6:function(e,n){},"7UmL":function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));t("WevN"),t("TAD1");var i=t("o0o1"),r=t.n(i),a=t("HaE+"),o=t("nGEl"),s=t(6),u=t("DYWF"),c={};function l(e){return f.apply(this,arguments)}function f(){return(f=Object(a.a)(r.a.mark((function e(n){var t,i,a=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>1&&void 0!==a[1]?a[1]:null,i=a.length>2&&void 0!==a[2]?a[2]:{},t&&(n=p(n,t,i)),c[n]=c[n]||d(n),e.next=6,c[n];case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,n,t){var i=t.modules||{};return i[e]?i[e]:o.b?t.CDN?(Object(u.a)(t.CDN.startsWith("http")),"".concat(t.CDN,"/").concat(n,"@").concat("2.3.0","/dist/libs/").concat(e)):o.c?"../src/libs/".concat(e):"modules/".concat(n,"/src/libs/").concat(e):"modules/".concat(n,"/dist/libs/").concat(e)}function d(e){return v.apply(this,arguments)}function v(){return(v=Object(a.a)(r.a.mark((function e(n){var t,i,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.endsWith("wasm")){e.next=7;break}return e.next=3,fetch(n);case 3:return t=e.sent,e.next=6,t.arrayBuffer();case 6:return e.abrupt("return",e.sent);case 7:if(o.b){e.next=9;break}return e.abrupt("return",s.requireFromFile&&s.requireFromFile(n));case 9:if(!o.c){e.next=11;break}return e.abrupt("return",importScripts(n));case 11:return e.next=13,fetch(n);case 13:return i=e.sent,e.next=16,i.text();case 16:return a=e.sent,e.abrupt("return",h(a,n));case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,n){if(!o.b)return s.requireFromString&&s.requireFromString(e,n);if(o.c)return eval.call(o.a,e),null;var t=document.createElement("script");t.id=n;try{t.appendChild(document.createTextNode(e))}catch(i){t.text=e}return document.body.appendChild(t),null}},GHY8:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));t("t+I+");function i(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof e)return e.slice(0,n);if(ArrayBuffer.isView(e))return r(e.buffer,e.byteOffset,n);if(e instanceof ArrayBuffer){var t=0;return r(e,t,n)}return""}function r(e,n,t){if(e.byteLength<=n+t)return"";for(var i=new DataView(e),r="",a=0;a<t;a++)r+=String.fromCharCode(i.getUint8(n+a));return r}},YkLe:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t("Dm9C");function r(e){var n=Object(i.a)(e);return n?n.mimeType:null}},h5Ug:function(e,n,t){"use strict";t.d(n,"c",(function(){return r})),t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return o}));t("CtJk");var i=t("16Iq");function r(e){return e+3&-4}function a(e,n,t){return Object(i.c)(e,n,t)}function o(e,n,t){var i;if(e instanceof ArrayBuffer)i=new Uint8Array(e);else{var a=e.byteOffset,o=e.byteLength;i=new Uint8Array(e.buffer,a,o)}return n.set(i,t),t+r(i.byteLength)}},ro6J:function(e,n,t){"use strict";t.d(n,"a",(function(){return $}));t("pJf4"),t("v9g0"),t("9ZhD"),t("rzGZ"),t("Dq+y"),t("8npG"),t("Ggvi"),t("zGcK"),t("E5k/"),t("YBKJ"),t("m5Zt");var i=t("74We"),r=t("2jYZ"),a=t("iIhu"),o=t("5deG"),s=t("SOuN"),u={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if (__VERSION__ < 300)\n#extension GL_EXT_shader_texture_lod: enable\n#extension GL_OES_standard_derivatives : enable\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLodEXT(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[t("pspH").a]},c=t("1OyB"),l=t("vuIU"),f=t("1+Ew"),p=t("HYgG"),d=t("HEtN"),v=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,e);var t=n.id;this.id=t||Object(p.c)(this.constructor.name),this.display=!0,this.position=new f.d,this.rotation=new f.d,this.scale=new f.d(1,1,1),this.matrix=new f.a,this.userData={},this.props={},this._setScenegraphNodeProps(n)}return Object(l.a)(e,[{key:"delete",value:function(){}},{key:"setProps",value:function(e){return this._setScenegraphNodeProps(e),this}},{key:"toString",value:function(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}},{key:"setPosition",value:function(e){return Object(d.a)(3===e.length,"setPosition requires vector argument"),this.position=e,this}},{key:"setRotation",value:function(e){return Object(d.a)(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}},{key:"setScale",value:function(e){return Object(d.a)(3===e.length,"setScale requires vector argument"),this.scale=e,this}},{key:"setMatrix",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n?this.matrix.copy(e):this.matrix=e}},{key:"setMatrixComponents",value:function(e){var n=e.position,t=e.rotation,i=e.scale,r=e.update,a=void 0===r||r;return n&&this.setPosition(n),t&&this.setRotation(t),i&&this.setScale(i),a&&this.updateMatrix(),this}},{key:"updateMatrix",value:function(){var e=this.position,n=this.rotation,t=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(n),this.matrix.scale(t),this}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.position,t=e.rotation,i=e.scale;return n&&this.setPosition(n),t&&this.setRotation(t),i&&this.setScale(i),this.updateMatrix(),this}},{key:"getCoordinateUniforms",value:function(e,n){Object(d.a)(e),n=n||this.matrix;var t=new f.a(e).multiplyRight(n),i=t.invert(),r=i.transpose();return{viewMatrix:e,modelMatrix:n,objectMatrix:n,worldMatrix:t,worldInverseMatrix:i,worldInverseTransposeMatrix:r}}},{key:"_setScenegraphNodeProps",value:function(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}]),e}(),h=(t("JHok"),t("MIFh"),t("AqHK"),t("8nqg")),m=t("HaLk"),g=(t("m210"),t("4DPX"),t("sc67"),t("KQm4")),_=t("md7G"),b=t("foSv"),S=t("ReuC"),A=t("Ji7U"),y=function(e){function n(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,n);var i=t=Array.isArray(t)?{children:t}:t,r=i.children,a=void 0===r?[]:r;return s.h.assert(a.every((function(e){return e instanceof v})),"every child must an instance of ScenegraphNode"),(e=Object(_.a)(this,Object(b.a)(n).call(this,t))).children=a,e}return Object(A.a)(n,e),Object(l.a)(n,[{key:"add",value:function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];for(var i=0,r=n;i<r.length;i++){var a=r[i];Array.isArray(a)?this.add.apply(this,Object(g.a)(a)):this.children.push(a)}return this}},{key:"remove",value:function(e){var n=this.children,t=n.indexOf(e);return t>-1&&n.splice(t,1),this}},{key:"removeAll",value:function(){return this.children=[],this}},{key:"delete",value:function(){this.children.forEach((function(e){return e.delete()})),this.removeAll(),Object(S.a)(Object(b.a)(n.prototype),"delete",this).call(this)}},{key:"traverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.worldMatrix,r=void 0===i?new f.a:i,a=new f.a(r).multiplyRight(this.matrix),o=!0,s=!1,u=void 0;try{for(var c,l=this.children[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var p=c.value;p instanceof n?p.traverse(e,{worldMatrix:a}):e(p,{worldMatrix:a})}}catch(d){s=!0,u=d}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}}}]),n}(v),O=(t("zTTH"),t("YbXK"),t("cFtU"),t("5irr"),t("SIeT"),t("h3Sa"),t("AItV"),t("CtJk"),t("88iX"),{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),R={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function x(e){if(!e._animation){var n=R[e.componentType],t=O[e.type],i=t*e.count,r=e.bufferView.data,a=new n(r.buffer,r.byteOffset+(e.byteOffset||0),i);if(1===t)e._animation=Array.from(a);else{for(var o=[],s=0;s<a.length;s+=t)o.push(Array.from(a.slice(s,s+t)));e._animation=o}}return e._animation}var M=new f.a;var I=new f.b;function N(e,n,t,i){var r=n.input,a=n.interpolation,o=n.output,u=e%r[r.length-1],c=r.findIndex((function(e){return e>=u})),l=Math.max(0,c-1);if(!Array.isArray(t[i]))switch(i){case"translation":t[i]=[0,0,0];break;case"rotation":t[i]=[0,0,0,1];break;case"scale":t[i]=[1,1,1];break;default:s.h.warn("Bad animation path ".concat(i))()}Object(d.a)(t[i].length===o[l].length);var f=r[l],p=r[c];switch(a){case"STEP":!function(e,n,t){for(var i=0;i<t.length;i++)e[n][i]=t[i]}(t,i,o[l]);break;case"LINEAR":if(p>f){var v=(u-f)/(p-f);!function(e,n,t,i,r){if("rotation"===n){I.slerp({start:t,target:i,ratio:r});for(var a=0;a<I.length;a++)e[n][a]=I[a]}else for(var o=0;o<t.length;o++)e[n][o]=r*i[o]+(1-r)*t[o]}(t,i,o[l],o[c],v)}break;case"CUBICSPLINE":if(p>f){var h=(u-f)/(p-f),m=p-f;!function(e,n,t){for(var i=t.p0,r=t.outTangent0,a=t.inTangent1,o=t.p1,s=t.tDiff,u=t.ratio,c=0;c<e[n].length;c++){var l=r[c]*s,f=a[c]*s;e[n][c]=(2*Math.pow(u,3)-3*Math.pow(u,2)+1)*i[c]+(Math.pow(u,3)-2*Math.pow(u,2)+u)*l+(-2*Math.pow(u,3)+3*Math.pow(u,2))*o[c]+(Math.pow(u,3)-Math.pow(u,2))*f}}(t,i,{p0:o[3*l+1],outTangent0:o[3*l+2],inTangent1:o[3*c+0],p1:o[3*c+1],tDiff:m,ratio:h})}break;default:s.h.warn("Interpolation ".concat(a," not supported"))()}}var L=function(){function e(n){Object(c.a)(this,e),this.startTime=0,this.playing=!0,this.speed=1,Object.assign(this,n)}return Object(l.a)(e,[{key:"animate",value:function(e){if(this.playing){var n=(e/1e3-this.startTime)*this.speed;this.channels.forEach((function(e){var t=e.sampler,i=e.target,r=e.path;N(n,t,i,r),function(e,n){if(n.matrix.identity(),e.translation&&n.matrix.translate(e.translation),e.rotation){var t=M.fromQuaternion(e.rotation);n.matrix.multiplyRight(t)}e.scale&&n.matrix.scale(e.scale)}(i,i._node)}))}}}]),e}(),C=function(){function e(n){Object(c.a)(this,e),this.animations=n.animations.map((function(e,t){var i=e.name||"Animation-".concat(t),r=e.samplers.map((function(e){var t=e.input,i=e.interpolation,r=void 0===i?"LINEAR":i,a=e.output;return{input:x(n.accessors[t]),interpolation:r,output:x(n.accessors[a])}})),a=e.channels.map((function(e){var t=e.sampler,i=e.target;return{sampler:r[t],target:n.nodes[i.node],path:i.path}}));return new L({name:i,channels:a})}))}return Object(l.a)(e,[{key:"animate",value:function(e){this.setTime(e)}},{key:"setTime",value:function(e){this.animations.forEach((function(n){return n.animate(e)}))}},{key:"getAnimations",value:function(){return this.animations}}]),e}(),E=(t("cxuS"),t("oFBv")),P=function(e){function n(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(c.a)(this,n),(t=Object(_.a)(this,Object(b.a)(n).call(this,i))).onBeforeRender=null,t.AfterRender=null,e instanceof E.a?(t.model=e,t._setModelNodeProps(i)):t.model=new E.a(e,i),t.managedResources=i.managedResources||[],t}return Object(A.a)(n,e),Object(l.a)(n,[{key:"setProps",value:function(e){return Object(S.a)(Object(b.a)(n.prototype),"setProps",this).call(this,e),this._setModelNodeProps(e),this}},{key:"delete",value:function(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach((function(e){return e.delete()})),this.managedResources=[]}},{key:"draw",value:function(){var e;return(e=this.model).draw.apply(e,arguments)}},{key:"setUniforms",value:function(){var e;return(e=this.model).setUniforms.apply(e,arguments),this}},{key:"setAttributes",value:function(){var e;return(e=this.model).setAttributes.apply(e,arguments),this}},{key:"updateModuleSettings",value:function(){var e;return(e=this.model).updateModuleSettings.apply(e,arguments),this}},{key:"_setModelNodeProps",value:function(e){this.model.setProps(e)}}]),n}(v),T=t("rePB"),B=t("EYM9"),w=t("tvsr"),D=t("yzHf"),U=function(){function e(n,t){var i=t.attributes,r=t.material,a=t.pbrDebug,o=t.imageBasedLightingEnvironment,s=t.lights,u=t.useTangents;Object(c.a)(this,e),this.gl=n,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},Object(B.b)(n,w.a.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),a&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(i.NORMAL,"HAS_NORMALS"),this.defineIfPresent(i.TANGENT&&u,"HAS_TANGENTS"),this.defineIfPresent(i.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(s,"USE_LIGHTS"),this.defineIfPresent(a,"PBR_DEBUG"),r&&this.parseMaterial(r)}return Object(l.a)(e,[{key:"defineIfPresent",value:function(e,n){e&&(this.defines[n]=1)}},{key:"parseTexture",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},r=new D.a(this.gl,{id:e.name||e.id,parameters:i,pixelStore:Object(T.a)({},this.gl.UNPACK_FLIP_Y_WEBGL,!1),data:e.texture.source.image});this.uniforms[n]=r,this.defineIfPresent(t,t),this.generatedTextures.push(r)}},{key:"parsePbrMetallicRoughness",value:function(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");var n=e.metallicFactor,t=void 0===n?1:n,i=e.roughnessFactor,r=void 0===i?1:i;this.uniforms.u_MetallicRoughnessValues=[t,r]}},{key:"parseMaterial",value:function(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");var n=e.normalTexture.scale,t=void 0===n?1:n;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");var i=e.occlusionTexture.strength,r=void 0===i?1:i;this.uniforms.u_OcclusionStrength=r}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){var a=e.alphaCutoff,o=void 0===a?.5:a;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=o}else"BLEND"===e.alphaMode&&(s.h.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}]),e}();function H(e,n){return Object(s.g)(e)?"#version 300 es\n".concat(n):n}var V={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},k={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1},G=function(){function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(c.a)(this,e),this.gl=n,this.options=Object.assign({},k,t)}return Object(l.a)(e,[{key:"instantiate",value:function(e){var n=this;return this.gltf=e,(e.scenes||[]).map((function(e){return n.createScene(e)}))}},{key:"createAnimator",value:function(){return Array.isArray(this.gltf.animations)?new C(this.gltf):null}},{key:"createScene",value:function(e){var n=this,t=(e.nodes||[]).map((function(e){return n.createNode(e)}));return new y({id:e.name||e.id,children:t})}},{key:"createNode",value:function(e){var n=this;if(!e._node){var t=(e.children||[]).map((function(e){return n.createNode(e)}));e.mesh&&t.push(this.createMesh(e.mesh));var i=new y({id:e.name||e.id,children:t});if(e.matrix)i.setMatrix(e.matrix);else{if(i.matrix.identity(),e.translation&&i.matrix.translate(e.translation),e.rotation){var r=(new f.a).fromQuaternion(e.rotation);i.matrix.multiplyRight(r)}e.scale&&i.matrix.scale(e.scale)}e._node=i}return e._node}},{key:"createMesh",value:function(e){var n=this;if(!e._mesh){var t=(e.primitives||[]).map((function(t,i){return n.createPrimitive(t,i,e)})),i=new y({id:e.name||e.id,children:t});e._mesh=i}return e._mesh}},{key:"getVertexCount",value:function(e){s.h.warn("getVertexCount() not found")()}},{key:"createPrimitive",value:function(e,n,t){return function(e,n){var t=n.id,i=n.drawMode,r=n.vertexCount,a=n.attributes,o=n.modelOptions,c=new U(e,n);s.h.info(4,"createGLTFModel defines: ",c.defines)();var l=[];l.push.apply(l,Object(g.a)(c.generatedTextures)),l.push.apply(l,Object(g.a)(Object.values(a).map((function(e){return e.buffer}))));var f=new P(e,Object.assign({id:t,drawMode:i,vertexCount:r,modules:[u],defines:c.defines,parameters:c.parameters,vs:H(e,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:H(e,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l},o));return f.setProps({attributes:a}),f.setUniforms(c.uniforms),f}(this.gl,Object.assign({id:e.name||"".concat(t.name||t.id,"-primitive-").concat(n),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}},{key:"createAttributes",value:function(e,n){var t=this,i={};return Object.keys(e).forEach((function(n){i[n]=t.createAccessor(e[n],t.createBuffer(e[n],t.gl.ARRAY_BUFFER))})),n&&(i.indices=this.createAccessor(n,this.createBuffer(n,this.gl.ELEMENT_ARRAY_BUFFER))),s.h.info(4,"glTF Attributes",{attributes:e,indices:n,generated:i})(),i}},{key:"createBuffer",value:function(e,n){e.bufferView||(e.bufferView={});var t=e.bufferView;return t.lumaBuffers||(t.lumaBuffers={}),t.lumaBuffers[n]||(t.lumaBuffers[n]=new h.a(this.gl,{id:"from-".concat(t.id),data:t.data||e.value,target:n})),t.lumaBuffers[n]}},{key:"createAccessor",value:function(e,n){return new m.a({buffer:n,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:V[e.type]})}},{key:"createSampler",value:function(e){return e}},{key:"needsPOT",value:function(){return!1}}]),e}();var F=t("0mpS"),j=t("o0o1"),z=t.n(j);t("wcNg"),t("6kNP");function X(e,n,t,i,r,a,o){try{var s=e[a](o),u=s.value}catch(c){return void t(c)}s.done?n(u):Promise.resolve(u).then(i,r)}function W(e){return function(){var n=this,t=arguments;return new Promise((function(i,r){var a=e.apply(n,t);function o(e){X(a,i,r,o,s,"next",e)}function s(e){X(a,i,r,o,s,"throw",e)}o(void 0)}))}}function q(){return(q=W(z.a.mark((function e(n){var t;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n.scenes.forEach((function(e){e.traverse((function(e){Object.values(e.model.getUniforms()).forEach((function(e){!1===e.loaded&&t.push(e)}))}))})),e.next=4,Y((function(){return t.some((function(e){return!e.loaded}))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){return K.apply(this,arguments)}function K(){return(K=W(z.a.mark((function e(n){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n()){e.next=5;break}return e.next=3,new Promise((function(e){return requestAnimationFrame(e)}));case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J=t("6fpb");var Z=[255,255,255,255],Q={scenegraph:{type:"object",value:null,async:!0},getScene:function(e){return e&&e.scenes?"object"==typeof e.scene?e.scene:e.scenes[e.scene||0]:e},getAnimator:function(e){return e&&e.animator},_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:Z},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}},$=function(e){var n,t;function o(){return e.apply(this,arguments)||this}t=e,(n=o).prototype=Object.create(t.prototype),n.prototype.constructor=n,n.__proto__=t;var c=o.prototype;return c.initializeState=function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:F.a.DOUBLE,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:F.a.UNSIGNED_BYTE,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:Z,transition:!0},instanceModelMatrix:J.a})},c.updateState=function(n){e.prototype.updateState.call(this,n);var t=n.props,i=n.oldProps;t.scenegraph!==i.scenegraph?this._updateScenegraph(t):t._animations!==i._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,t._animations)},c.finalizeState=function(){e.prototype.finalizeState.call(this),this._deleteScenegraph()},c._updateScenegraph=function(e){var n,t=this,r=this.context.gl;if(e.scenegraph instanceof v)n={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){var a=e.scenegraph,o=function(e,n,t){var i=new G(e,t);return{scenes:i.instantiate(n),animator:i.createAnimator()}}(r,a,this.getLoadOptions());n=Object.assign({gltf:a},o),function(e){return q.apply(this,arguments)}(o).then((function(){return t.setNeedsRedraw()}))}else i.a.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),n=e.scenegraph;var s={layer:this,gl:r},u=e.getScene(n,s),c=e.getAnimator(n,s);u instanceof v?(this._deleteScenegraph(),this._applyAllAttributes(u),this._applyAnimationsProp(u,c,e._animations),this.setState({scenegraph:u,animator:c})):null!==u&&i.a.warn("invalid scenegraph:",u)()},c._applyAllAttributes=function(e){var n=this;if(this.state.attributesAvailable){var t=this.getAttributeManager().getAttributes();e.traverse((function(e){n._setModelAttributes(e.model,t)}))}},c._applyAnimationsProp=function(e,n,t){if(e&&n&&t){var r=n.getAnimations();Object.keys(t).sort().forEach((function(e){var n=t[e];if("*"===e)r.forEach((function(e){Object.assign(e,n)}));else if(Number.isFinite(Number(e))){var a=Number(e);a>=0&&a<r.length?Object.assign(r[a],n):i.a.warn("animation "+e+" not found")()}else{var o=r.find((function(n){return n.name===e}));o?Object.assign(o,n):i.a.warn("animation "+e+" not found")()}}))}},c._deleteScenegraph=function(){var e=this.state.scenegraph;e instanceof v&&e.delete()},c.getLoadOptions=function(){var e=[r.a,a.a],n=this.props,t=n._lighting,i=n._imageBasedLightingEnvironment;"pbr"===t&&e.push(u);var o=null;return i&&(o="function"==typeof i?i({gl:this.context.gl,layer:this}):i),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:o,modelOptions:{vs:"#version 300 es\n\n// Instance attributes\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\n\n// Uniforms\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\n\n// Attributes\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\n\n// Varying\nout vec4 vColor;\n\n// MODULE_PBR contains all the varying definitions needed\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\n\n// Main\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    // set PBR data\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    // set PBR data\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n\n// Uniforms\nuniform float opacity;\n\n// Varying\nin vec4 vColor;\n\nout vec4 fragmentColor;\n\n// MODULE_PBR contains all the varying definitions needed\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:e,isInstanced:!0,transpileToGLSL100:!Object(s.g)(this.context.gl)},useTangents:!1}},c.updateAttributes=function(e){var n=this;this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse((function(t){n._setModelAttributes(t.model,e)}))},c.draw=function(e){var n=e.moduleParameters,t=void 0===n?null:n,i=e.parameters,r=void 0===i?{}:i,a=e.context;if(this.state.scenegraph){this.props._animations&&this.state.animator&&this.state.animator.animate(a.animationProps.time);var o=this.context.viewport,s=this.props,u=s.sizeScale,c=s.sizeMinPixels,l=s.sizeMaxPixels,f=s.opacity,p=s.coordinateSystem,d=this.getNumInstances();this.state.scenegraph.traverse((function(e,n){var i=n.worldMatrix;e.model.setInstanceCount(d),e.updateModuleSettings(t),e.draw({parameters:r,uniforms:{sizeScale:u,opacity:f,sizeMinPixels:c,sizeMaxPixels:l,composeModelMatrix:Object(J.b)(o,p),sceneModelMatrix:i,u_Camera:e.model.getUniforms().project_uCameraPosition}})}))}},o}(o.a);$.layerName="ScenegraphLayer",$.defaultProps=Q},sx9D:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t("GHY8");function r(e){try{return JSON.parse(e)}catch(n){throw new Error('Failed to parse JSON from data starting with "'.concat(Object(i.a)(e),'"'))}}}}]);