<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <title>deck.gl GeoJsonLayer (Path) Example | WebGL visualization</title>
    <link rel="stylesheet" id="font-link" href="https://d1a3f4spazzrp4.cloudfront.net/uber-fonts/3.1.0/refresh.css">

    <meta name="description" content="WebGL-based visualization examples using deck.gl">

    <link rel="icon" type="img/ico" href="https://visgl.github.io/deck.gl/favicon.ico">

    <!-— facebook open graph tags -->
    <meta property="og:url" content="https://visgl.github.io/deck.gl/showcases/gallery" />
    <meta property="og:title" content="deck.gl GeoJsonLayer (Path) Example | WebGL visualization" />
    <meta property="og:description" content="WebGL-based visualization examples using deck.gl" />
    <meta property="og:site_name" content="deck.gl" />
    <meta property="og:image" content="https://visgl.github.io/deck.gl/showcases/gallery/images/highway.jpg" />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:width" content="800" />
    <meta property="og:image:height" content="480" />
    
    <!-— twitter card tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@uber">
    <meta name="twitter:creator" content="@uber">
    <meta name="twitter:title" content="deck.gl GeoJsonLayer (Path) Example | WebGL visualization">
    <meta name="twitter:description" content="WebGL-based visualization examples using deck.gl">
    <meta name="twitter:image" content="https://visgl.github.io/deck.gl/showcases/gallery/images/highway.jpg" />

    <style>
      body {font-family: ff-clan-web-pro, "Helvetica Neue", Helvetica, sans-serif !important; font-size: 12px;}
      #container {width: 100%; max-width: 960px; padding: 40px 12px; margin: auto;}
      #source {margin: 12px 0; border: solid 1px #ccc; padding: 24px}
      #links {margin: 12px 0;}
      #links a {text-decoration: none; color: #444;}
      #links a:hover {color: #08f;}
    </style>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-7157694-83', 'auto');
  ga('send', 'pageview');
</script>
  </head>
  <body>
    <div id="container">
      <h1>deck.gl GeoJsonLayer (Path) Example</h1>
      <div id="links">
        <a href="./">↩ Back to Gallery</a>
      </div>
      <h2>Demo</h2>
      <iframe width="100%" height="450" frameborder="0" ></iframe>
      <h2>Source</h2>
      <div id="source">
        <code class="prettyprint">&lt;html&gt;<br/>&nbsp;&nbsp;&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;deck.gl GeoJsonLayer (Path) Example&lt;/title&gt;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;script src="https://unpkg.com/deck.gl@^9.0.0/dist.min.js"&gt;&lt;/script&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;script src="https://d3js.org/d3.v5.min.js"&gt;&lt;/script&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;script src='https://unpkg.com/maplibre-gl@3.6.0/dist/maplibre-gl.js'&gt;&lt;/script&gt;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;link href='https://unpkg.com/maplibre-gl@3.6.0/dist/maplibre-gl.css' rel='stylesheet' /&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;style type="text/css"&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width: 100vw;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height: 100vh;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin: 0;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflow: hidden;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.deck-tooltip {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family: Helvetica, Arial, sans-serif;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding: 6px !important;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin: 8px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max-width: 300px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size: 10px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#options {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position: fixed;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z-index: 1;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;background: #fff;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;top: 0;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left: 0;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin: 20px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding: 12px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size: 11px;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;box-shadow: 0 0 8px rgba(0,0,0,0.3);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;<br/>&nbsp;&nbsp;&lt;/head&gt;<br/><br/>&nbsp;&nbsp;&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;div id="options"&gt;&lt;/div&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;div id="tooltip"&gt;&lt;/div&gt;<br/>&nbsp;&nbsp;&lt;/body&gt;<br/><br/>&nbsp;&nbsp;&lt;script type="text/javascript"&gt;<br/><br/>&nbsp;&nbsp;const {DeckGL, GeoJsonLayer} = deck;<br/><br/>&nbsp;&nbsp;const COLOR_SCALE = d3.scaleThreshold()<br/>&nbsp;&nbsp;&nbsp;&nbsp;.domain([0, 4, 8, 12, 20, 32, 52, 84, 136, 220])<br/>&nbsp;&nbsp;&nbsp;&nbsp;.range([<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[26, 152, 80],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[102, 189, 99],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[166, 217, 106],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[217, 239, 139],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[255, 255, 191],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[254, 224, 139],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[253, 174, 97],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[244, 109, 67],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[215, 48, 39],<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[168, 0, 0]<br/>&nbsp;&nbsp;&nbsp;&nbsp;]);<br/><br/>&nbsp;&nbsp;const WIDTH_SCALE = d3.scaleLinear()<br/>&nbsp;&nbsp;&nbsp;&nbsp;.clamp(true)<br/>&nbsp;&nbsp;&nbsp;&nbsp;.domain([0, 200])<br/>&nbsp;&nbsp;&nbsp;&nbsp;.range([10, 2000]);<br/><br/>&nbsp;&nbsp;let accidents = {};<br/>&nbsp;&nbsp;let fatalities = {};<br/>&nbsp;&nbsp;let year = -1;<br/><br/>&nbsp;&nbsp;const deckgl = new deck.DeckGL({<br/>&nbsp;&nbsp;&nbsp;&nbsp;initialViewState: {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;longitude: -100,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;latitude: 38,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zoom: 4,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pitch: 0,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minZoom: 2,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxZoom: 8<br/>&nbsp;&nbsp;&nbsp;&nbsp;},<br/>&nbsp;&nbsp;&nbsp;&nbsp;controller: true,<br/>&nbsp;&nbsp;&nbsp;&nbsp;mapStyle: 'https://basemaps.cartocdn.com/gl/dark-matter-nolabels-gl-style/style.json',<br/>&nbsp;&nbsp;&nbsp;&nbsp;pickingRadius: 5,<br/>&nbsp;&nbsp;&nbsp;&nbsp;layers: [],<br/>&nbsp;&nbsp;&nbsp;&nbsp;getTooltip<br/>&nbsp;&nbsp;});<br/><br/>&nbsp;&nbsp;d3.csv('https://raw.githubusercontent.com/visgl/deck.gl-data/master/examples/highway/accidents.csv')<br/>&nbsp;&nbsp;&nbsp;&nbsp;.then(accidents =&gt; {<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;// sort accident data<br/>&nbsp;&nbsp;&nbsp;&nbsp;incidents = {};<br/>&nbsp;&nbsp;&nbsp;&nbsp;fatalities = {};<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;accidents.forEach(a =&gt; {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const r = (incidents[a.year] = incidents[a.year] || {});<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const f = (fatalities[a.year] = fatalities[a.year] || {});<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const key = getKey(a);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r[key] = a.incidents;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f[key] = a.fatalities;<br/>&nbsp;&nbsp;&nbsp;&nbsp;});<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;year = accidents[0].year;<br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;initInputs(d3.select('#options'));<br/>&nbsp;&nbsp;&nbsp;&nbsp;redraw();<br/>&nbsp;&nbsp;});<br/><br/>&nbsp;&nbsp;// Update deck.gl layers<br/>&nbsp;&nbsp;function redraw() {<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;const layers = [<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new GeoJsonLayer({<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id: 'geojson',<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data: 'https://raw.githubusercontent.com/visgl/deck.gl-data/master/examples/highway/roads.json',<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stroked: false,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filled: false,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lineWidthMinPixels: 1,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameters: {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;depthTest: false<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getLineColor: getLineColor,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getLineWidth: getLineWidth,<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pickable: true,<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;updateTriggers: {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getLineColor: {year},<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getLineWidth: {year}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transitions: {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getLineColor: 1000,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getLineWidth: 1000<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<br/>&nbsp;&nbsp;&nbsp;&nbsp;];<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;deckgl.setProps({layers});<br/>&nbsp;&nbsp;}<br/><br/>&nbsp;&nbsp;function getKey({state, type, id}) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;return `${state}-${type}-${id}`;<br/>&nbsp;&nbsp;}<br/><br/>&nbsp;&nbsp;function getLineColor(f) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;if (!fatalities[year]) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [200, 200, 200];<br/>&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;const key = getKey(f.properties);<br/>&nbsp;&nbsp;&nbsp;&nbsp;const fatalitiesPer1KMile = ((fatalities[year][key] || 0) / f.properties.length) * 1000;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return COLOR_SCALE(fatalitiesPer1KMile);<br/>&nbsp;&nbsp;}<br/><br/>&nbsp;&nbsp;function getLineWidth(f) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;if (!incidents[year]) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 10;<br/>&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;const key = getKey(f.properties);<br/>&nbsp;&nbsp;&nbsp;&nbsp;const incidentsPer1KMile = ((incidents[year][key] || 0) / f.properties.length) * 1000;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return WIDTH_SCALE(incidentsPer1KMile);<br/>&nbsp;&nbsp;}<br/><br/>&nbsp;&nbsp;/* UI */<br/><br/>&nbsp;&nbsp;function initInputs(container) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;const inputValue = container.append('div').text(`YEAR: ${year}`);<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;const yearRange = Object.keys(incidents).map(Number);<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;const input = container.append('input').attr('type', 'range')<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.attr('min', d3.min(yearRange))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.attr('max', d3.max(yearRange))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.attr('step', 5)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.attr('value', year)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.on('input', () =&gt; {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;year = input.property('value');<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inputValue.text(`YEAR: ${year}`);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redraw();<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br/>&nbsp;&nbsp;}<br/><br/>&nbsp;&nbsp;function getTooltip(info) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;const props = info.object ? info.object.properties : null;<br/>&nbsp;&nbsp;&nbsp;&nbsp;let content = '';<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;if (props) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const key = getKey(props);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const r = incidents[year][key];<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const f = fatalities[year][key];<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let content = `&lt;big&gt;${props.name} (${props.state})&lt;/big&gt;`;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (r) {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content += `<br/>&nbsp;&nbsp;&lt;div&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;${f}&lt;/b&gt; people died in<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;${r}&lt;/b&gt; crashes<br/>&nbsp;&nbsp;&nbsp;&nbsp;on ${props.type === 'SR' ? props.state : props.type}-${props.id}<br/>&nbsp;&nbsp;&nbsp;&nbsp;in &lt;b&gt;${year}&lt;/b&gt;<br/>&nbsp;&nbsp;&lt;/div&gt;`;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content += `&lt;div&gt;no accidents recorded in &lt;b&gt;${year}&lt;/b&gt;&lt;/div&gt;`;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return {html: content};<br/>&nbsp;&nbsp;&nbsp;&nbsp;} else {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return null;<br/>&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;}<br/><br/>&nbsp;&nbsp;&lt;/script&gt;<br/>&lt;/html&gt;</code>
      </div>
    </div>
    <script>var src = unescape('%3Chtml%3E%0A%20%20%3Chead%3E%0A%20%20%20%20%3Ctitle%3Edeck.gl%20GeoJsonLayer%20%28Path%29%20Example%3C/title%3E%0A%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//unpkg.com/deck.gl@%5E9.0.0/dist.min.js%22%3E%3C/script%3E%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//d3js.org/d3.v5.min.js%22%3E%3C/script%3E%0A%20%20%20%20%3Cscript%20src%3D%27https%3A//unpkg.com/maplibre-gl@3.6.0/dist/maplibre-gl.js%27%3E%3C/script%3E%0A%0A%20%20%20%20%3Clink%20href%3D%27https%3A//unpkg.com/maplibre-gl@3.6.0/dist/maplibre-gl.css%27%20rel%3D%27stylesheet%27%20/%3E%0A%20%20%20%20%3Cstyle%20type%3D%22text/css%22%3E%0A%20%20%20%20%20%20body%20%7B%0A%20%20%20%20%20%20%20%20width%3A%20100vw%3B%0A%20%20%20%20%20%20%20%20height%3A%20100vh%3B%0A%20%20%20%20%20%20%20%20margin%3A%200%3B%0A%20%20%20%20%20%20%20%20overflow%3A%20hidden%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20.deck-tooltip%20%7B%0A%20%20%20%20%20%20%20%20font-family%3A%20Helvetica%2C%20Arial%2C%20sans-serif%3B%0A%20%20%20%20%20%20%20%20padding%3A%206px%20%21important%3B%0A%20%20%20%20%20%20%20%20margin%3A%208px%3B%0A%20%20%20%20%20%20%20%20max-width%3A%20300px%3B%0A%20%20%20%20%20%20%20%20font-size%3A%2010px%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%23options%20%7B%0A%20%20%20%20%20%20%20%20position%3A%20fixed%3B%0A%20%20%20%20%20%20%20%20z-index%3A%201%3B%0A%20%20%20%20%20%20%20%20background%3A%20%23fff%3B%0A%20%20%20%20%20%20%20%20top%3A%200%3B%0A%20%20%20%20%20%20%20%20left%3A%200%3B%0A%20%20%20%20%20%20%20%20margin%3A%2020px%3B%0A%20%20%20%20%20%20%20%20padding%3A%2012px%3B%0A%20%20%20%20%20%20%20%20font-size%3A%2011px%3B%0A%20%20%20%20%20%20%20%20box-shadow%3A%200%200%208px%20rgba%280%2C0%2C0%2C0.3%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%3C/style%3E%0A%20%20%3C/head%3E%0A%0A%20%20%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id%3D%22options%22%3E%3C/div%3E%0A%20%20%20%20%3Cdiv%20id%3D%22tooltip%22%3E%3C/div%3E%0A%20%20%3C/body%3E%0A%0A%20%20%3Cscript%20type%3D%22text/javascript%22%3E%0A%0A%20%20const%20%7BDeckGL%2C%20GeoJsonLayer%7D%20%3D%20deck%3B%0A%0A%20%20const%20COLOR_SCALE%20%3D%20d3.scaleThreshold%28%29%0A%20%20%20%20.domain%28%5B0%2C%204%2C%208%2C%2012%2C%2020%2C%2032%2C%2052%2C%2084%2C%20136%2C%20220%5D%29%0A%20%20%20%20.range%28%5B%0A%20%20%20%20%20%20%5B26%2C%20152%2C%2080%5D%2C%0A%20%20%20%20%20%20%5B102%2C%20189%2C%2099%5D%2C%0A%20%20%20%20%20%20%5B166%2C%20217%2C%20106%5D%2C%0A%20%20%20%20%20%20%5B217%2C%20239%2C%20139%5D%2C%0A%20%20%20%20%20%20%5B255%2C%20255%2C%20191%5D%2C%0A%20%20%20%20%20%20%5B254%2C%20224%2C%20139%5D%2C%0A%20%20%20%20%20%20%5B253%2C%20174%2C%2097%5D%2C%0A%20%20%20%20%20%20%5B244%2C%20109%2C%2067%5D%2C%0A%20%20%20%20%20%20%5B215%2C%2048%2C%2039%5D%2C%0A%20%20%20%20%20%20%5B168%2C%200%2C%200%5D%0A%20%20%20%20%5D%29%3B%0A%0A%20%20const%20WIDTH_SCALE%20%3D%20d3.scaleLinear%28%29%0A%20%20%20%20.clamp%28true%29%0A%20%20%20%20.domain%28%5B0%2C%20200%5D%29%0A%20%20%20%20.range%28%5B10%2C%202000%5D%29%3B%0A%0A%20%20let%20accidents%20%3D%20%7B%7D%3B%0A%20%20let%20fatalities%20%3D%20%7B%7D%3B%0A%20%20let%20year%20%3D%20-1%3B%0A%0A%20%20const%20deckgl%20%3D%20new%20deck.DeckGL%28%7B%0A%20%20%20%20initialViewState%3A%20%7B%0A%20%20%20%20%20%20longitude%3A%20-100%2C%0A%20%20%20%20%20%20latitude%3A%2038%2C%0A%20%20%20%20%20%20zoom%3A%204%2C%0A%20%20%20%20%20%20pitch%3A%200%2C%0A%20%20%20%20%20%20minZoom%3A%202%2C%0A%20%20%20%20%20%20maxZoom%3A%208%0A%20%20%20%20%7D%2C%0A%20%20%20%20controller%3A%20true%2C%0A%20%20%20%20mapStyle%3A%20%27https%3A//basemaps.cartocdn.com/gl/dark-matter-nolabels-gl-style/style.json%27%2C%0A%20%20%20%20pickingRadius%3A%205%2C%0A%20%20%20%20layers%3A%20%5B%5D%2C%0A%20%20%20%20getTooltip%0A%20%20%7D%29%3B%0A%0A%20%20d3.csv%28%27https%3A//raw.githubusercontent.com/visgl/deck.gl-data/master/examples/highway/accidents.csv%27%29%0A%20%20%20%20.then%28accidents%20%3D%3E%20%7B%0A%0A%20%20%20%20//%20sort%20accident%20data%0A%20%20%20%20incidents%20%3D%20%7B%7D%3B%0A%20%20%20%20fatalities%20%3D%20%7B%7D%3B%0A%0A%20%20%20%20accidents.forEach%28a%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20r%20%3D%20%28incidents%5Ba.year%5D%20%3D%20incidents%5Ba.year%5D%20%7C%7C%20%7B%7D%29%3B%0A%20%20%20%20%20%20const%20f%20%3D%20%28fatalities%5Ba.year%5D%20%3D%20fatalities%5Ba.year%5D%20%7C%7C%20%7B%7D%29%3B%0A%20%20%20%20%20%20const%20key%20%3D%20getKey%28a%29%3B%0A%20%20%20%20%20%20r%5Bkey%5D%20%3D%20a.incidents%3B%0A%20%20%20%20%20%20f%5Bkey%5D%20%3D%20a.fatalities%3B%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20year%20%3D%20accidents%5B0%5D.year%3B%0A%20%20%20%20%0A%20%20%20%20initInputs%28d3.select%28%27%23options%27%29%29%3B%0A%20%20%20%20redraw%28%29%3B%0A%20%20%7D%29%3B%0A%0A%20%20//%20Update%20deck.gl%20layers%0A%20%20function%20redraw%28%29%20%7B%0A%0A%20%20%20%20const%20layers%20%3D%20%5B%0A%20%20%20%20%20%20new%20GeoJsonLayer%28%7B%0A%20%20%20%20%20%20%20%20id%3A%20%27geojson%27%2C%0A%20%20%20%20%20%20%20%20data%3A%20%27https%3A//raw.githubusercontent.com/visgl/deck.gl-data/master/examples/highway/roads.json%27%2C%0A%20%20%20%20%20%20%20%20stroked%3A%20false%2C%0A%20%20%20%20%20%20%20%20filled%3A%20false%2C%0A%20%20%20%20%20%20%20%20lineWidthMinPixels%3A%201%2C%0A%20%20%20%20%20%20%20%20parameters%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20depthTest%3A%20false%0A%20%20%20%20%20%20%20%20%7D%2C%0A%0A%20%20%20%20%20%20%20%20getLineColor%3A%20getLineColor%2C%0A%20%20%20%20%20%20%20%20getLineWidth%3A%20getLineWidth%2C%0A%0A%20%20%20%20%20%20%20%20pickable%3A%20true%2C%0A%0A%20%20%20%20%20%20%20%20updateTriggers%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20getLineColor%3A%20%7Byear%7D%2C%0A%20%20%20%20%20%20%20%20%20%20getLineWidth%3A%20%7Byear%7D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%0A%20%20%20%20%20%20%20%20transitions%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20getLineColor%3A%201000%2C%0A%20%20%20%20%20%20%20%20%20%20getLineWidth%3A%201000%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%0A%20%20%20%20%5D%3B%0A%0A%20%20%20%20deckgl.setProps%28%7Blayers%7D%29%3B%0A%20%20%7D%0A%0A%20%20function%20getKey%28%7Bstate%2C%20type%2C%20id%7D%29%20%7B%0A%20%20%20%20return%20%60%24%7Bstate%7D-%24%7Btype%7D-%24%7Bid%7D%60%3B%0A%20%20%7D%0A%0A%20%20function%20getLineColor%28f%29%20%7B%0A%20%20%20%20if%20%28%21fatalities%5Byear%5D%29%20%7B%0A%20%20%20%20%20%20return%20%5B200%2C%20200%2C%20200%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20key%20%3D%20getKey%28f.properties%29%3B%0A%20%20%20%20const%20fatalitiesPer1KMile%20%3D%20%28%28fatalities%5Byear%5D%5Bkey%5D%20%7C%7C%200%29%20/%20f.properties.length%29%20*%201000%3B%0A%20%20%20%20return%20COLOR_SCALE%28fatalitiesPer1KMile%29%3B%0A%20%20%7D%0A%0A%20%20function%20getLineWidth%28f%29%20%7B%0A%20%20%20%20if%20%28%21incidents%5Byear%5D%29%20%7B%0A%20%20%20%20%20%20return%2010%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20key%20%3D%20getKey%28f.properties%29%3B%0A%20%20%20%20const%20incidentsPer1KMile%20%3D%20%28%28incidents%5Byear%5D%5Bkey%5D%20%7C%7C%200%29%20/%20f.properties.length%29%20*%201000%3B%0A%20%20%20%20return%20WIDTH_SCALE%28incidentsPer1KMile%29%3B%0A%20%20%7D%0A%0A%20%20/*%20UI%20*/%0A%0A%20%20function%20initInputs%28container%29%20%7B%0A%20%20%20%20const%20inputValue%20%3D%20container.append%28%27div%27%29.text%28%60YEAR%3A%20%24%7Byear%7D%60%29%3B%0A%0A%20%20%20%20const%20yearRange%20%3D%20Object.keys%28incidents%29.map%28Number%29%3B%0A%0A%20%20%20%20const%20input%20%3D%20container.append%28%27input%27%29.attr%28%27type%27%2C%20%27range%27%29%0A%20%20%20%20%20%20.attr%28%27min%27%2C%20d3.min%28yearRange%29%29%0A%20%20%20%20%20%20.attr%28%27max%27%2C%20d3.max%28yearRange%29%29%0A%20%20%20%20%20%20.attr%28%27step%27%2C%205%29%0A%20%20%20%20%20%20.attr%28%27value%27%2C%20year%29%0A%20%20%20%20%20%20.on%28%27input%27%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20year%20%3D%20input.property%28%27value%27%29%3B%0A%20%20%20%20%20%20%20%20inputValue.text%28%60YEAR%3A%20%24%7Byear%7D%60%29%3B%0A%20%20%20%20%20%20%20%20redraw%28%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%0A%20%20function%20getTooltip%28info%29%20%7B%0A%20%20%20%20const%20props%20%3D%20info.object%20%3F%20info.object.properties%20%3A%20null%3B%0A%20%20%20%20let%20content%20%3D%20%27%27%3B%0A%0A%20%20%20%20if%20%28props%29%20%7B%0A%20%20%20%20%20%20const%20key%20%3D%20getKey%28props%29%3B%0A%20%20%20%20%20%20const%20r%20%3D%20incidents%5Byear%5D%5Bkey%5D%3B%0A%20%20%20%20%20%20const%20f%20%3D%20fatalities%5Byear%5D%5Bkey%5D%3B%0A%0A%20%20%20%20%20%20let%20content%20%3D%20%60%3Cbig%3E%24%7Bprops.name%7D%20%28%24%7Bprops.state%7D%29%3C/big%3E%60%3B%0A%20%20%20%20%20%20if%20%28r%29%20%7B%0A%20%20%20%20%20%20%20%20content%20+%3D%20%60%0A%20%20%3Cdiv%3E%0A%20%20%20%20%3Cb%3E%24%7Bf%7D%3C/b%3E%20people%20died%20in%0A%20%20%20%20%3Cb%3E%24%7Br%7D%3C/b%3E%20crashes%0A%20%20%20%20on%20%24%7Bprops.type%20%3D%3D%3D%20%27SR%27%20%3F%20props.state%20%3A%20props.type%7D-%24%7Bprops.id%7D%0A%20%20%20%20in%20%3Cb%3E%24%7Byear%7D%3C/b%3E%0A%20%20%3C/div%3E%60%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20content%20+%3D%20%60%3Cdiv%3Eno%20accidents%20recorded%20in%20%3Cb%3E%24%7Byear%7D%3C/b%3E%3C/div%3E%60%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20%7Bhtml%3A%20content%7D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20%3C/script%3E%0A%3C/html%3E');</script>
    <script type="text/javascript">
      var blob = new Blob([src], {type: 'text/html'});
      document.querySelector('iframe').src = URL.createObjectURL(blob);
    </script>
  </body>
</html>