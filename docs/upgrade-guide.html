<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-upgrade-guide" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Upgrade Guide | deck.gl</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://deck.gl/docs/upgrade-guide"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Upgrade Guide | deck.gl"><meta data-rh="true" name="description" content="Upgrading to v9.1"><meta data-rh="true" property="og:description" content="Upgrading to v9.1"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://deck.gl/docs/upgrade-guide"><link data-rh="true" rel="alternate" href="https://deck.gl/docs/upgrade-guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://deck.gl/docs/upgrade-guide" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://8EVYAVB4KT-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.e45d0f9f.css">
<script src="/assets/js/runtime~main.65f730d8.js" defer="defer"></script>
<script src="/assets/js/main.0cf8a2a7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/visgl-logo-dark.png" alt="vis.gl Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/visgl-logo-light.png" alt="vis.gl Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">deck.gl</b></a><a class="navbar__item navbar__link" href="/examples">Examples</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/showcase">Showcase</a><a href="https://medium.com/vis-gl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/visgl/deck.gl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs">Overview</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/whats-new">What&#x27;s New</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/upgrade-guide">Upgrade Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contributing">Contributing to deck.gl</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/faq">Frequently Asked Questions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/get-started/getting-started">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/developer-guide/using-layers">Developer Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/api-reference/core/deck">API Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/api-reference/arcgis/overview">Submodule API Reference</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Overview</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Upgrade Guide</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Upgrade Guide</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-to-v91">Upgrading to v9.1<a href="#upgrading-to-v91" class="hash-link" aria-label="Direct link to Upgrading to v9.1" title="Direct link to Upgrading to v9.1">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-input-handling">User input handling<a href="#user-input-handling" class="hash-link" aria-label="Direct link to User input handling" title="Direct link to User input handling">​</a></h3>
<ul>
<li>
<p>The main gesture recognition library, <a href="https://visgl.github.io/mjolnir.js" target="_blank" rel="noopener noreferrer">mjolnir.js</a>, is upgraded to v3.0. Hammer.js is no longer an (indirect) dependency, due to its lack of maintenance and various issues with SSR and test environments.</p>
</li>
<li>
<p>The default gesture to manipulate viewport <code>pitch</code> by touch has been changed from three-finger to two-finger dragging vertically. You can revert this behavior by setting the <a href="/docs/api-reference/core/deck#eventrecognizeroptions">eventRecognizerOptions</a> prop of <code>Deck</code>:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">eventRecognizerOptions</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  multipan</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">pointers</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">3</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>If your app already uses Deck&#x27;s <code>eventRecognizerOptions</code> prop or implement a custom <a href="/docs/api-reference/core/controller">Controller</a>, some events have been renamed:</p>
<ul>
<li><code>tripan</code> -&gt; <code>multipan</code></li>
<li><code>tap</code> -&gt; <code>click</code></li>
<li><code>doubletap</code> -&gt; <code>dblclick</code></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="globe-view">Globe View<a href="#globe-view" class="hash-link" aria-label="Direct link to Globe View" title="Direct link to Globe View">​</a></h3>
<p>Breaking changes:</p>
<ul>
<li>The <code>zoom</code> value is now interpreted differently to match MapLibre&#x27;s behavior. The appearance adapts based on <code>latitude</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="aggregation-layers">Aggregation layers<a href="#aggregation-layers" class="hash-link" aria-label="Direct link to Aggregation layers" title="Direct link to Aggregation layers">​</a></h3>
<p>Breaking changes:</p>
<ul>
<li><code>GPUGridLayer</code> is removed. Use <code>GridLayer</code> with <code>gpuAggregation: true</code>.</li>
<li><code>CPUGridLayer</code> is removed. Use <code>GridLayer</code> with <code>gpuAggregation: false</code>.</li>
<li>If you are supplying a custom <a href="/docs/api-reference/aggregation-layers/hexagon-layer#hexagonaggregator">hexagonAggregator</a> to <code>HexagonLayer</code>, its function signiature has changed.</li>
<li><code>HexagonLayer</code>&#x27;s sub layer is renamed <code>&lt;id&gt;-cells</code> and is no longer a vanilla <code>ColumnLayer</code>. If you were overriding the sub layer class with your own, please open a Discussion on GitHub for support.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lightingeffect">LightingEffect<a href="#lightingeffect" class="hash-link" aria-label="Direct link to LightingEffect" title="Direct link to LightingEffect">​</a></h3>
<ul>
<li><code>PointLight.attenuation</code> was previously ignored. To retain old behavior, use the default (<code>[1, 0, 0]</code>).</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="uniform-buffers">Uniform buffers<a href="#uniform-buffers" class="hash-link" aria-label="Direct link to Uniform buffers" title="Direct link to Uniform buffers">​</a></h3>
<p>GLSL shaders that take inputs via WebGL1-style uniforms need to be migrated to use uniform buffers instead. For example:</p>
<div class="language-glsl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-glsl codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">// Global uniform</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">uniform float opacity;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">// UBO</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">uniform layerUniforms {</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  uniform float opacity;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">} layer;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <a href="https://luma.gl/docs/api-reference/shadertools/shader-module" target="_blank" rel="noopener noreferrer">ShaderModule</a> class is used to encapsulate and inject the uniforms, as well as providing using useful type checks. It maps (typed) props to bindings and uniforms defined in the UBO block, which <a href="https://luma.gl/docs/api-reference/engine/shader-inputs" target="_blank" rel="noopener noreferrer">ShaderInputs</a> uses to update bindings and uniform buffers on the GPU.</p>
<p>See <a href="https://github.com/visgl/deck.gl/tree/9.1-release/modules/core/src/shaderlib/misc/layer-uniforms.ts" target="_blank" rel="noopener noreferrer">layerUniforms</a> for an example.</p>
<p>Layers need to be modified:</p>
<ul>
<li><code>getShaders()</code> needs to additionaly return the <code>ShaderModule</code> that defines the UBO</li>
<li>Instead of calling <code>model.setUniforms</code> (or <code>model.setBindings</code>) use <code>model.shaderInputs.setProps</code> to update the UBO with props</li>
</ul>
<p>For more information see <a href="https://docs.google.com/presentation/d/1OcjA_hdu6vEvL_nxm7ywnXZQbMr5eR4R_L-wcz6K0HI/" target="_blank" rel="noopener noreferrer">presentation</a> (<a href="https://www.youtube.com/watch?v=ei6scnRpNhU" target="_blank" rel="noopener noreferrer">recording</a>)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-to-v90">Upgrading to v9.0<a href="#upgrading-to-v90" class="hash-link" aria-label="Direct link to Upgrading to v9.0" title="Direct link to Upgrading to v9.0">​</a></h2>
<p><strong>Before you upgrade: known issues</strong></p>
<p>The following issues are known and can be expected to resolve in a 9.0 patch:</p>
<ul>
<li>GPU aggregation is not working for the following layers: <code>ScreenGridLayer</code>, <code>GPUGridLayer</code>, <code>GridLayer</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="typescript">Typescript<a href="#typescript" class="hash-link" aria-label="Direct link to Typescript" title="Direct link to Typescript">​</a></h3>
<p>Typescript is now enabled on all modules. The <code>&#x27;@deck.gl/xxx/typed&#x27;</code> packages are removed.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lumagl-v9-updates">luma.gl v9 Updates<a href="#lumagl-v9-updates" class="hash-link" aria-label="Direct link to luma.gl v9 Updates" title="Direct link to luma.gl v9 Updates">​</a></h3>
<p>The biggest changes in deck.gl v9 are due to the upgrade to the luma.gl v9 API. Fortunately, deck.gl encapsulates most of the luma.gl API so the changes to deck.gl applications should be limited, in particular if the application does not directly interact with GPU resources.</p>
<p>Quick summary:</p>
<ul>
<li><code>DeckProps.gl (WebGLRenderingContext)</code> should be replaced with <code>device</code>: <a href="https://luma.gl/docs/api-reference/core/device" target="_blank" rel="noopener noreferrer">Device</a>.</li>
<li><code>DeckProps.glOptions (WebGLContextAttributes)</code> should be replaced with <code>DeckProps.deviceProps.webgl</code>: <code>deviceProps: {type: &#x27;webgl&#x27;, webgl: ...glOptions}</code>: <a href="https://luma.gl/docs/api-reference/webgl/#webgldeviceprops" target="_blank" rel="noopener noreferrer">WebGLDeviceProps</a></li>
<li><code>DeckProps.glOptions.preserveDrawingBuffers</code> is now set by default, and does not need to be overridden.</li>
<li><code>DeckProps.onWebGLInitialized</code> callback is now <code>DeckProps.onDeviceInitialized</code>.</li>
<li><code>LayerProps.parameters</code> and <code>LayerProps.textureParameters</code> no longer use WebGL constants, but instead use (WebGPU style) <a href="https://luma.gl/docs/api-reference/core/parameters/" target="_blank" rel="noopener noreferrer">string constants</a>.</li>
<li>When providing <a href="/docs/api-reference/core/layer#data">binary data attributes</a>, <code>type</code> is now a WebGPU-style <a href="https://luma.gl/docs/api-guide/gpu/gpu-attributes#vertexformat" target="_blank" rel="noopener noreferrer">string format</a> instead of a GL constant.</li>
<li>GPU resources should no longer be created by directly instantiating classes. For example, instead of <code>new Buffer(gl)</code> use <code>device.createBuffer()</code>, instead of <code>new Texture()</code> use <code>device.createTexture()</code>. See <a href="https://luma.gl/docs/api-reference/core/device#methods" target="_blank" rel="noopener noreferrer">Device methods</a>.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="custom-layers">Custom Layers<a href="#custom-layers" class="hash-link" aria-label="Direct link to Custom Layers" title="Direct link to Custom Layers">​</a></h4>
<p>Model creation needs to adapt to the <a href="https://luma.gl/docs/upgrade-guide" target="_blank" rel="noopener noreferrer">luma.gl v9 API</a>:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">MyLayer</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">getModel</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Model</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Replaces this.context.gl</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">this</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// GLSL 1.00 shaders no longer supported, must be updated to GLSL 3.00</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        vs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        fs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// New in v9 Model API</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        bufferLayout</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">this</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">getAttributeManager</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">getBufferLayouts</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Replaces GL constant `drawMode`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        topology</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;triangle-strip&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>While the 9.0 release of deck.gl does not yet support WebGPU, our goal is to enable WebGPU soon in a 9.x release. A number of changes will be required to deck.gl curtom layers:</p>
<ul>
<li>deck.gl now uses uniform buffers instead of global uniforms. It is not yet required to use uniform buffers but it will be necessary if you would like to run deck.gl on WebGPU in future releases.</li>
<li>When defining an attribute, <code>type</code> is now a WebGPU-style <a href="https://luma.gl/docs/api-guide/gpu/gpu-attributes#vertexformat" target="_blank" rel="noopener noreferrer">string format</a> instead of GL constant, and <code>divisor</code> is replaced by <code>stepMode</code>. See <a href="/docs/api-reference/core/attribute-manager#add">AttributeManager.add</a></li>
<li>WebGL draw modes <code>GL.TRIANGLE_FAN</code> and <code>GL.LINE_LOOP</code> are not supported on WebGPU. Select a different topology when creating geometries.</li>
<li>The luma picking module now <a href="https://github.com/visgl/luma.gl/blob/master/modules/shadertools/src/modules/engine/picking/picking.ts#L34-L50" target="_blank" rel="noopener noreferrer">uses uniform buffers</a>. To access picking state in shaders use <code>picking.isActive</code> rather than <code>picking_isActive</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deckglmapbox">@deck.gl/mapbox<a href="#deckglmapbox" class="hash-link" aria-label="Direct link to @deck.gl/mapbox" title="Direct link to @deck.gl/mapbox">​</a></h3>
<p><code>MapboxLayer</code> has been removed. Use <code>MapboxOverlay</code> instead.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// deck.gl v9</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">MapboxOverlay</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@deck.gl/mapbox&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">map</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">addControl</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">MapboxOverlay</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  interleaved</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  layers</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">ArcLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token operator" style="color:rgb(12, 150, 155)">...</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// deck.gl v8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">MapboxLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@deck.gl/mapbox&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">map</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">addLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">MapboxLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">type</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> ArcLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">...</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deckglcarto">@deck.gl/carto<a href="#deckglcarto" class="hash-link" aria-label="Direct link to @deck.gl/carto" title="Direct link to @deck.gl/carto">​</a></h3>
<ul>
<li><code>CartoLayer</code> has been removed. Use a <a href="/docs/api-reference/carto/data-sources">Data Source</a> in combination with an <a href="/docs/api-reference/carto/overview#custom-layers-connected-to-carto-datasource">appropriate Layer</a> instead.</li>
<li><code>setDefaultCredentials</code> has been removed. Authentication is now passed to the <a href="/docs/api-reference/carto/data-sources">Data Source</a>.</li>
<li><code>fetchLayerData</code> has been replaced by <code>query</code>. Find <a href="/docs/api-reference/carto/overview">a working example here</a></li>
</ul>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// deck.gl v9</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">VectorTileLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> vectorQuerySource</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@deck.gl/carto&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> data </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">vectorQuerySource</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  accessToken</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;XXX&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  connectionName</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;carto_dw&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  sqlQuery</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;SELECT * FROM cartobq.testtables.points_10k&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> layer </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">VectorTileLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">...</span><span class="token plain">styleProps</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// deck.gl v8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">CartoLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> setDefaultCredentials</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(72, 118, 214)">MAP_TYPES</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@deck.gl/carto&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">setDefaultCredentials</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">accessToken</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;XXX&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> layer </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">CartoLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  type</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(72, 118, 214)">MAP_TYPES</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token constant" style="color:rgb(72, 118, 214)">QUERY</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  connection</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;carto_dw&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  data</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;SELECT * FROM cartobq.testtables.points_10k&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token operator" style="color:rgb(12, 150, 155)">...</span><span class="token plain">styleProps</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="loadersgl">loaders.gl<a href="#loadersgl" class="hash-link" aria-label="Direct link to loaders.gl" title="Direct link to loaders.gl">​</a></h3>
<p>loaders.gl dependencies are updated to v4. Although most version differences are handled internal to deck.gl, some changes may be required for applications that work directly with loaders:</p>
<ul>
<li>If an application imports <code>@loaders.gl/*</code> sub packages to load specific data formats, they should be upgraded from v3.x to v4.x.</li>
<li>If the layer prop <code>dataTransform</code> is used to pre-process data, the loaded data object might have changed. For example, <code>CSVLoader</code> now yields <a href="https://loaders.gl/docs/specifications/category-table" target="_blank" rel="noopener noreferrer">a new table format</a>.</li>
<li>For a complete list of breaking changes and improvements, see <a href="https://loaders.gl/docs/upgrade-guide#upgrading-to-v40" target="_blank" rel="noopener noreferrer">loaders.gl 4.0 upgrade guide</a>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="others">Others<a href="#others" class="hash-link" aria-label="Direct link to Others" title="Direct link to Others">​</a></h3>
<ul>
<li><code>Deck.pickObjects()</code>  -  minor breaking change: if the same <code>data</code> is used by multiple top-level layers (e.g. a <code>ScatterplotLayer</code> and a <code>TextLayer</code>) that are visible in the picking bounds, <code>pickObjects</code> will yield one result for each picked object+layer combination, instead of one result for each picked object in previous versions.</li>
<li>Custom effects: the <code>Effect</code> interface has changed. <code>preRender</code> and <code>postRender</code> no longer receives device/context as an argument, implement the <code>setup()</code> lifecycle method instead.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v88-to-v89">Upgrading from deck.gl v8.8 to v8.9<a href="#upgrading-from-deckgl-v88-to-v89" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v8.8 to v8.9" title="Direct link to Upgrading from deck.gl v8.8 to v8.9">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="breaking-changes">Breaking changes<a href="#breaking-changes" class="hash-link" aria-label="Direct link to Breaking changes" title="Direct link to Breaking changes">​</a></h4>
<ul>
<li><code>TextLayer</code>&#x27;s <code>maxWidth</code> is now relative to the text size. This change aims to make this prop more intuitive to use. If you have been using this prop in previous versions, divide its value by <code>64</code> (or <code>fontSettings.fontSize</code> if it&#x27;s set manually).</li>
<li><code>BitmapLayer</code> now handles translucent pixels correctly. In previous versions alpha was applied twice, leading to overly dim colors.</li>
<li><code>GoogleMapsOverlays</code> now also triggers <code>onClick</code> for rightclick events. To filter out these events check for <code>event.srcEvent.domEvent.button === 2</code> in <code>onClick</code>.</li>
<li>Some dependencies are upgraded to their next major version, including <code>@mapbox/tiny-sdf</code> and <code>d3-*</code>. This upgrade is necessary because certain security vulnerabilities in these packages are only fixed in the latest versions. Unfortunately, they became <a href="https://nodejs.org/api/packages.html" target="_blank" rel="noopener noreferrer">ES modules</a> and no longer support <code>require()</code> from the commonjs entry point. This will break Server Side Rendering in frameworks such as Next.js. To mitigate this, you must exclude deck.gl from SSR either by framework config or by using dynamic import. See <a href="/docs/get-started/using-with-react#using-deckgl-with-ssr">here</a> for details.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v87-to-v88">Upgrading from deck.gl v8.7 to v8.8<a href="#upgrading-from-deckgl-v87-to-v88" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v8.7 to v8.8" title="Direct link to Upgrading from deck.gl v8.7 to v8.8">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="breaking-changes-1">Breaking changes<a href="#breaking-changes-1" class="hash-link" aria-label="Direct link to Breaking changes" title="Direct link to Breaking changes">​</a></h4>
<ul>
<li>In order to generalize the <code>TileLayer</code> to work with non-OSM indexing systems, the <code>Tile</code> class no longer has <code>x</code>, <code>y</code>, and <code>z</code> as top level properties, but instead an <code>index</code> property with shape <code>{x, y, z}</code>. This affects the following callback props:<!-- -->
<ul>
<li><code>getTileData({x, y, z, ...opts})</code> --&gt; <code>getTileData({index: {x, y, z}, ...opts})</code></li>
<li><code>onViewportLoad(tiles)</code></li>
<li><code>onTileLoad(tile)</code></li>
<li><code>onTileUnload(tile)</code></li>
<li><code>onTileError(tile)</code></li>
<li><code>pickingInfo.tile</code> returned by <code>onHover</code>, <code>onClick</code> etc.</li>
</ul>
</li>
<li><code>TileLayer</code> and <code>MVTLayer</code> that render extruded GeoJSON content must set the <a href="/docs/api-reference/geo-layers/tile-layer#zrange">zRange</a> prop. See documentation for details.</li>
<li>The base <code>Effect</code> class is removed. Custom effects should implement the new <code>interface Effect</code> in TypeScript.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="carto">CARTO<a href="#carto" class="hash-link" aria-label="Direct link to CARTO" title="Direct link to CARTO">​</a></h4>
<ul>
<li><code>format</code> prop is removed from <code>CartoLayer</code>, with <code>format</code> is fixed to <code>&#x27;tilejson&#x27;</code>. <code>CartoLayer</code> no longer creates non-tiled layers. Use the <code>fetchLayerData</code> function with <code>GeoJSONLayer</code> for static queries and tables.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v86-to-v87">Upgrading from deck.gl v8.6 to v8.7<a href="#upgrading-from-deckgl-v86-to-v87" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v8.6 to v8.7" title="Direct link to Upgrading from deck.gl v8.6 to v8.7">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deprecations">Deprecations<a href="#deprecations" class="hash-link" aria-label="Direct link to Deprecations" title="Direct link to Deprecations">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="core">Core<a href="#core" class="hash-link" aria-label="Direct link to Core" title="Direct link to Core">​</a></h5>
<ul>
<li>
<p><code>H3HexagonLayer</code> now uses flat shading when it renders a <code>ColumnLayer</code>. This change improves the visual consistency when using <code>highPrecision: &#x27;auto&#x27;</code>. To revert to the old behavior, set the following prop:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token literal-property property" style="color:rgb(12, 150, 155)">_subLayerProps</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token string-property property" style="color:rgb(12, 150, 155)">&#x27;hexagon-cell&#x27;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token literal-property property" style="color:rgb(12, 150, 155)">flatShading</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">false</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><code>H3ClusterLayer</code> sublayer is now called <code>&#x27;cell&#x27;</code> not <code>&#x27;cluster-region&#x27;</code></p>
</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="carto-1">CARTO<a href="#carto-1" class="hash-link" aria-label="Direct link to CARTO" title="Direct link to CARTO">​</a></h5>
<ul>
<li><code>CartoBQTilerLayer</code> is removed. Use <code>CartoLayer</code> instead with <code>type</code> set to <code>MAP_TYPES.TILESET</code>.</li>
<li><code>CartoSQLLayer</code> is removed. Use <code>CartoLayer</code> instead with <code>type</code> set to <code>MAP_TYPES.QUERY</code>.</li>
<li><code>API_VERSIONS.V3</code> is the default for the CARTO module API calls. Use <code>setDefaultCredentials</code> to explicitly specify <code>V2</code>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v85-to-v86">Upgrading from deck.gl v8.5 to v8.6<a href="#upgrading-from-deckgl-v85-to-v86" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v8.5 to v8.6" title="Direct link to Upgrading from deck.gl v8.5 to v8.6">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="changes-to-layer-prop-defaults">Changes to layer prop defaults<a href="#changes-to-layer-prop-defaults" class="hash-link" aria-label="Direct link to Changes to layer prop defaults" title="Direct link to Changes to layer prop defaults">​</a></h3>
<ul>
<li><code>H3HexagonLayer</code>&#x27;s <code>highPrecision</code> prop now defaults to <code>&#x27;auto&#x27;</code>. Explicitly setting <code>highPrecision: false</code> now forces the layer to use low-precision (instanced rendering) mode.</li>
<li><code>MVTLayer</code>&#x27;s <code>binary</code> prop now defaults to <code>true</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="meter-size-projection">Meter size projection<a href="#meter-size-projection" class="hash-link" aria-label="Direct link to Meter size projection" title="Direct link to Meter size projection">​</a></h3>
<p>Dimensions (radius/width/size) that are defined in meters are now projected accurately in the <code>MapView</code> according to the Web Mercator projection. This means that scatterplot radius, path widths etc. may now appear larger than they used to at high latitudes, reflecting the <a href="https://en.wikipedia.org/wiki/Mercator_projection#/media/File:Mercator_with_Tissot&#x27;s_Indicatrices_of_Distortion.svg" target="_blank" rel="noopener noreferrer">distortion of the Mercator projection</a>. The visual difference is visible when viewing a dataset covering a large range of latitudes on a global scale.</p>
<p>This change is technically a bug fix. However, if you have been using meter sizes to visualize non-cartographic values (e.g. population, income), the Mercator distortion may be undesirable. If this is the case, consider moving to <code>radiusUnits</code>/<code>widthUnits</code>/<code>sizeUnits</code>: <code>&#x27;common&#x27;</code>, as detailed in the updated documentation on the <a href="/docs/developer-guide/coordinate-systems#supported-units">unit system</a>.</p>
<p>As a stop-gap measure, applications can revert to the old projection behavior with the following prop on <code>Deck</code>/<code>DeckGL</code>:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token literal-property property" style="color:rgb(12, 150, 155)">views</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">MapView</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token literal-property property" style="color:rgb(12, 150, 155)">legacyMeterSizes</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that this flag may be removed in a future release.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="layer-filtering">Layer filtering<a href="#layer-filtering" class="hash-link" aria-label="Direct link to Layer filtering" title="Direct link to Layer filtering">​</a></h3>
<ul>
<li>
<p><code>H3HexagonLayer</code>&#x27;s <code>highPrecision</code> prop default value is changed to <code>&#x27;auto&#x27;</code>. Setting <code>highPrecision</code> to <code>false</code> now forces instanced rendering. See updated <a href="/docs/api-reference/geo-layers/h3-hexagon-layer#highprecision">layer documentation</a> for details.</p>
</li>
<li>
<p><code>layerFilter</code> is now only called with top-level layers. For example, if you have a <code>GeoJsonLayer</code> with <code>id: &#x27;regions&#x27;</code>, in previous versions the callback would look like:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function-variable function" style="color:rgb(153, 76, 195);font-style:italic">layerFilter</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token parameter">layer</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token parameter"> viewport</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">layer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">id</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token method function property-access" style="color:rgb(153, 76, 195);font-style:italic">startsWith</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;regions&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// regions-points, regions-polygons, etc.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> viewport</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;main&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now the callback can be:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function-variable function" style="color:rgb(153, 76, 195);font-style:italic">layerFilter</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token parameter">layer</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token parameter"> viewport</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">layer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;region&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// everything rendered by the GeoJsonLayer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> viewport</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;main&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This change is intended to make this callback easier to use for the most common use cases. Using this callback to filter out specific nested sub layers is no longer supportd. Instead, you need to either set the <a href="/docs/api-reference/core/composite-layer#_sublayerprops">_subLayerProps</a> prop (stock layer) or implement the <a href="/docs/api-reference/core/composite-layer#filtersublayer">filterSubLayer</a> method (custom layer).</p>
</li>
<li>
<p>If a composite layer has <code>visible: false</code>, all of the layers generated by it will also be hidden regardless of their own <code>visible</code> prop. In previous versions, a descendant layer may be visible as long as it has <code>visible: true</code>, which often led to confusing behavior if a composite layer does not propagate its props correctly.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v84-to-v85">Upgrading from deck.gl v8.4 to v8.5<a href="#upgrading-from-deckgl-v84-to-v85" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v8.4 to v8.5" title="Direct link to Upgrading from deck.gl v8.4 to v8.5">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="transpilation">Transpilation<a href="#transpilation" class="hash-link" aria-label="Direct link to Transpilation" title="Direct link to Transpilation">​</a></h3>
<p>The module entry point is now only lightly transpiled for the most commonly used evergreen browsers. This change offers significant savings on bundle size. If your application needs to support older browsers such as IE 11, make sure to include <code>node_modules</code> in your babel config.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="layers">Layers<a href="#layers" class="hash-link" aria-label="Direct link to Layers" title="Direct link to Layers">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="breaking-changes-2">Breaking changes<a href="#breaking-changes-2" class="hash-link" aria-label="Direct link to Breaking changes" title="Direct link to Breaking changes">​</a></h4>
<ul>
<li>
<p>A bug is fixed in projecting sizes in billboard mode. Pixel sizes now match their CSS counterparts and objects now have the same size whether in billboard mode or not. As a result, some items are now 1.5 times bigger than they used to be in many common cases, because previously you didn&#x27;t get the sizes you were asking for. This change affects the following layers when used with a <code>MapView</code>:</p>
<ul>
<li><code>ArcLayer</code>, <code>LineLayer</code> and <code>PointCloudLayer</code></li>
<li><code>IconLayer</code> and <code>TextLayer</code> with the default <code>billboard</code> prop</li>
<li><code>PathLayer</code> with <code>billboard: true</code></li>
</ul>
<p>After upgrading to v8.5, in order to maintain the same appearance in these cases, you need to multiply the objects&#x27; width/size by <code>2/3</code>. This can be done by either changing the accessor (<code>getWidth</code>/<code>getSize</code>) or the scaling prop (<code>sizeScale</code>/<code>widthScale</code>).</p>
</li>
<li>
<p><code>TextLayer</code>&#x27;s default <code>fontSettings</code> have changed. When using <code>sdf</code>, the default <code>buffer</code> is now <code>4</code> and the default <code>radius</code> is now <code>12</code>.</p>
</li>
<li>
<p><code>GeoJsonLayer</code>&#x27;s <code>lineJointRounded</code> prop now only controls line joints. To use rounded line caps, set <code>lineCapRounded</code> to <code>true</code>.</p>
</li>
<li>
<p>Dashed lines via <code>PathStyleExtension</code> now draw rounded dash caps if <code>capRounded</code> is <code>true</code>.</p>
</li>
<li>
<p><code>@deck.gl/geo-layers</code> now depends on <code>@deck.gl/extensions</code>.</p>
</li>
<li>
<p><code>HeatmapLayer</code>&#x27;s <code>colorDomain</code> prop has redefined the unit of its values. See updated <a href="/docs/api-reference/aggregation-layers/heatmap-layer">layer documentation</a> for details.</p>
</li>
<li>
<p><code>TileLayer</code> no longer uses <code>tileSize</code> to offset zoom in non-geospatial views. It is recommended to use the new <code>zoomOffset</code> prop to affect the <code>zoom</code> resolution at which tiles are fetched.</p>
</li>
<li>
<p><code>MVTLayer</code> and <code>TerrainLayer</code>&#x27;s default loaders no longer support parsing on the main thread. This does not change the layers&#x27; default behavior, just reduces the bundle size by dropping unused code. Should you need to use the layers in an environment where web worker is not available, or debug the loaders, follow the examples in <a href="/docs/developer-guide/loading-data#loaders-and-web-workers">loaders and workers</a>.</p>
</li>
<li>
<p><code>TerrainLayer</code>&#x27;s <code>workerUrl</code> prop is removed, use <code>loadOptions.terrain.workerUrl</code> instead.</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deprecations-1">Deprecations<a href="#deprecations-1" class="hash-link" aria-label="Direct link to Deprecations" title="Direct link to Deprecations">​</a></h4>
<ul>
<li><code>TextLayer</code>&#x27;s <code>backgroundColor</code> prop is deprecated. Use <code>background: true</code> and <code>getBackgroundColor</code> instead.</li>
<li><code>PathLayer</code>&#x27;s <code>rounded</code> prop is deprecated, replaced by two separate flags <code>jointRounded</code> and <code>capRounded</code>.</li>
<li><code>GeoJsonLayer</code>&#x27;s <code>getRadius</code> props is deprecated, replaced by <code>getPointRadius</code>.</li>
<li><code>CartoBQTilerLayer</code> is deprecated and will be removed in 8.6. Use <code>CartoLayer</code> instead with <code>type</code> set to <code>MAP_TYPES.TILESET</code>.</li>
<li><code>CartoSQLLayer</code> is deprecated and will be removed in 8.6. Use <code>CartoLayer</code> instead with <code>type</code> set to <code>MAP_TYPES.QUERY</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="onerror-callback">onError Callback<a href="#onerror-callback" class="hash-link" aria-label="Direct link to onError Callback" title="Direct link to onError Callback">​</a></h3>
<p><code>Deck</code>&#x27;s default <code>onError</code> callback is changed to <code>console.error</code>. Explicitly setting <code>onError</code> to <code>null</code> now silently ignores all errors, instead of logging them to console.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="loadersgl-v30">loaders.gl v3.0<a href="#loadersgl-v30" class="hash-link" aria-label="Direct link to loaders.gl v3.0" title="Direct link to loaders.gl v3.0">​</a></h3>
<p>deck.gl now depends on <code>@loaders.gl/core@^3.0.0</code>. It is strongly recommended that you upgrade all loaders.gl dependencies to v3 as v2.x loaders are not tested with the v3.0 core. Visit loaders.gl&#x27;s <a href="https://loaders.gl/docs/upgrade-guide" target="_blank" rel="noopener noreferrer">upgrade guide</a> for instructions on each loader module.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="orbitview">OrbitView<a href="#orbitview" class="hash-link" aria-label="Direct link to OrbitView" title="Direct link to OrbitView">​</a></h3>
<p><code>OrbitView</code> no longer allows <code>orbitAxis</code> to be specified in the view state. Set <code>orbitAxis</code> in the <code>OrbitView</code> constructor instead.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v83-to-v84">Upgrading from deck.gl v8.3 to v8.4<a href="#upgrading-from-deckgl-v83-to-v84" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v8.3 to v8.4" title="Direct link to Upgrading from deck.gl v8.3 to v8.4">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wraplongitude">wrapLongitude<a href="#wraplongitude" class="hash-link" aria-label="Direct link to wrapLongitude" title="Direct link to wrapLongitude">​</a></h3>
<p>The behavior of <code>wrapLongitude</code> has changed. Before, setting this prop to <code>true</code> would project vertices to a copy of the map that is closer to the current center. Starting with v8.4, enabling this prop would &quot;normalize&quot; the geometry to the [-180, 180] longitude range. See the following list for layer-specific changes:</p>
<ul>
<li><code>LineLayer</code> and <code>ArcLayer</code>: always draw the shortest path between source and target positions. If the shortest path crosses the 180th meridian, it is split into two segments.</li>
<li>Layers that draw each object with a single position anchor, e.g. <code>ScatterplotLayer</code>, <code>IconLayer</code>, <code>TextLayer</code>: move the anchor point into the <code>[-180, 180]</code> range.</li>
</ul>
<p>This change makes layers render more predictably at low zoom levels. To draw horizontally continuous map with multiple copies of the world, use <a href="/docs/api-reference/core/map-view">MapView</a> with the <code>repeat</code> option:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Deck</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">views</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">MapView</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token literal-property property" style="color:rgb(12, 150, 155)">repeat</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(12, 150, 155)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pickinginfo">pickingInfo<a href="#pickinginfo" class="hash-link" aria-label="Direct link to pickingInfo" title="Direct link to pickingInfo">​</a></h3>
<p>A legacy field <code>pickingInfo.lngLat</code> has been removed. Use <code>pickingInfo.coordinate</code> instead.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="layers-1">Layers<a href="#layers-1" class="hash-link" aria-label="Direct link to Layers" title="Direct link to Layers">​</a></h3>
<ul>
<li><code>MVTLayer</code>&#x27;s <code>onHover</code> and <code>onClick</code> callbacks now yield the <code>info.object</code> feature coordinates in WGS84 standard.</li>
<li><code>ScenegraphLayer</code> now has built-in support for <code>GLTFLoader</code>. It&#x27;s no longer necessary to call <code>registerLoaders</code> before using it.</li>
<li><code>SolidPolygonLayer</code> now enforces the winding order for outer polygons and holes. This ensures the correct orientation of an extruded polygon&#x27;s surfaces, and therefore consistent culling and lighting effect results. This may change the visual outcome of your layers if the winding order was wrongly deduced in the previous versions. When using this layer with <code>_normalize: false</code>, a new prop <code>_windingOrder</code> can be used to specify the winding order used by your polygon data.</li>
<li><code>ColumnLayer</code> now enforces the winding order for vertices. This may change the lighting effect appearance in <code>HexagonLayer</code> and <code>H3HexagonLayer</code> slightly.</li>
<li><code>TileLayer</code>&#x27;s <code>onViewportLoad</code> callback now receives as argument an array of loaded <a href="/docs/api-reference/geo-layers/tile-layer#tile">Tile</a> instances. At previous version the argument was an array of tile content.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v82-to-v83">Upgrading from deck.gl v8.2 to v8.3<a href="#upgrading-from-deckgl-v82-to-v83" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v8.2 to v8.3" title="Direct link to Upgrading from deck.gl v8.2 to v8.3">​</a></h2>
<ul>
<li>The following is added to the default image loading options: <code>{imagebitmap: {premultiplyAlpha: &#x27;none&#x27;}}</code> (previously <code>default</code>). This generates more visually similar outcome between <code>ImageBitmap</code> and <code>Image</code> formats (see changes in 8.2 below). You can override this behavior with the <code>loadOptions</code> prop of a layer. See <a href="https://loaders.gl/modules/images/docs/api-reference/image-loader#options" target="_blank" rel="noopener noreferrer">ImageLoader options</a> for more information.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v81-to-v82">Upgrading from deck.gl v8.1 to v8.2<a href="#upgrading-from-deckgl-v81-to-v82" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v8.1 to v8.2" title="Direct link to Upgrading from deck.gl v8.1 to v8.2">​</a></h2>
<ul>
<li>The <code>TileLayer</code> now rounds the current <code>zoom</code> to determine the <code>z</code> at which to load tiles. This will load less tiles than the previous version. You can adjust the <code>tileSize</code> prop to modify this behavior.</li>
<li>Image URLs are now by default loaded in the <code>ImageBitmap</code> format, versus <code>Image</code> in the previous version. This improves the performance of loading textures. You may override this by supplying the <code>loadOptions</code> prop of a layer:</li>
</ul>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token literal-property property" style="color:rgb(12, 150, 155)">loadOptions</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">image</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token literal-property property" style="color:rgb(12, 150, 155)">type</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;image&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>See <a href="https://loaders.gl/modules/images/docs/api-reference/image-loader#options" target="_blank" rel="noopener noreferrer">ImageLoader options</a>;</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v80-to-v81">Upgrading from deck.gl v8.0 to v8.1<a href="#upgrading-from-deckgl-v80-to-v81" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v8.0 to v8.1" title="Direct link to Upgrading from deck.gl v8.0 to v8.1">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breaking-changes-3">Breaking Changes<a href="#breaking-changes-3" class="hash-link" aria-label="Direct link to Breaking Changes" title="Direct link to Breaking Changes">​</a></h3>
<ul>
<li><code>s2-geometry</code> is no longer a dependency of <code>@deck.gl/geo-layers</code>. If you were using this module in an application, it needs to be explicitly added to package.json.</li>
<li>deck.gl no longer crashes if one of the layers encounters an error during update and/or render. By default, errors are now logged to the console. Specify the <code>onError</code> callback to manually handle errors in your application.</li>
<li><code>Deck</code> now reacts to changes in the <code>initialViewState</code> prop. In 8.0 and earlier versions, this prop was not monitored after the deck instance was constructed. Starting 8.1, if <code>initialViewState</code> changes deeply, the camera will be reset. It is recommended that you use a constant for <code>initialViewState</code> to achieve behavior consistent with the previous versions.</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="tile3dlayer">Tile3DLayer<a href="#tile3dlayer" class="hash-link" aria-label="Direct link to Tile3DLayer" title="Direct link to Tile3DLayer">​</a></h5>
<ul>
<li>A new prop <code>loader</code> needs to be provided, one of <code>CesiumIonLoader</code>, <code>Tiles3DLoader</code> from (<code>@loaders.gl/3d-tiles</code>) or <code>I3SLoader</code> from (<code>@loaders.gl/i3s</code>).</li>
<li>The <code>loadOptions</code> prop is now used for passing all loaders.gl options, not just <a href="https://loaders.gl/modules/tiles/docs/api-reference/tileset-3d#constructor-1" target="_blank" rel="noopener noreferrer"><code>Tileset3D</code></a>. To revert back to the 8.0 behavior, use <code>{tileset: {throttleRequest: true}}</code>.</li>
<li><code>_ionAccessId</code> and <code>_ionAccesToken</code> props are removed. To render an ion dataset with <code>Tile3DLayer</code>, follow this example:</li>
</ul>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword module" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token imports maybe-class-name">CesiumIonLoader</span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@loaders.gl/3d-tiles&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword module" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token imports maybe-class-name">Tile3DLayer</span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@deck.gl/geo-layers&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// load 3d tiles from Cesium ion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> layer </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Tile3DLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;tile-3d-layer&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// tileset json file url</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">data</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;https://assets.cesium.com/&lt;ion_access_id&gt;/tileset.json&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">loader</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token maybe-class-name">CesiumIonLoader</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// https://cesium.com/docs/rest-api/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">loadOptions</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// https://loaders.gl/modules/tiles/docs/api-reference/tileset-3d#constructor-1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">tileset</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">throttleRequests</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token string-property property" style="color:rgb(12, 150, 155)">&#x27;cesium-ion&#x27;</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token literal-property property" style="color:rgb(12, 150, 155)">accessToken</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;&lt;ion_access_token_for_your_asset&gt;&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v7x-to-v80">Upgrading from deck.gl v7.x to v8.0<a href="#upgrading-from-deckgl-v7x-to-v80" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v7.x to v8.0" title="Direct link to Upgrading from deck.gl v7.x to v8.0">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breaking-changes-4">Breaking Changes<a href="#breaking-changes-4" class="hash-link" aria-label="Direct link to Breaking Changes" title="Direct link to Breaking Changes">​</a></h3>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="defaults">Defaults<a href="#defaults" class="hash-link" aria-label="Direct link to Defaults" title="Direct link to Defaults">​</a></h5>
<ul>
<li>The <code>opacity</code> prop of all layers is now default to <code>1</code> (used to be <code>0.8</code>).</li>
<li><a href="/docs/api-reference/mesh-layers/simple-mesh-layer"><code>SimpleMeshLayer</code></a> and <a href="/docs/api-reference/mesh-layers/scenegraph-layer"><code>ScenegraphLayer</code></a>: <code>modelMatrix</code> will be composed to instance transformation matrix (derived from  layer props <code>getOrientation</code>, <code>getScale</code>, <code>getTranslation</code> and <code>getTransformMatrix</code>) under <code>CARTESIAN</code> and <code>METER_OFFSETS</code> <a href="/docs/developer-guide/coordinate-systems">coordinates</a>.</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="removed">Removed<a href="#removed" class="hash-link" aria-label="Direct link to Removed" title="Direct link to Removed">​</a></h5>
<ul>
<li><code>ArcLayer</code> props<!-- -->
<ul>
<li><code>getStrokeWidth</code>: use <code>getWidth</code></li>
</ul>
</li>
<li><code>LineLayer</code> props<!-- -->
<ul>
<li><code>getStrokeWidth</code>: use <code>getWidth</code></li>
</ul>
</li>
<li><code>PathLayer</code> props<!-- -->
<ul>
<li><code>getDashArray</code>: use <a href="/docs/api-reference/extensions/path-style-extension">PathStyleExtension</a></li>
</ul>
</li>
<li><code>PolygonLayer</code> and <code>GeoJsonLayer</code> props<!-- -->
<ul>
<li><code>getLineDashArray</code>: use <a href="/docs/api-reference/extensions/path-style-extension">PathStyleExtension</a></li>
</ul>
</li>
<li><code>H3HexagonLayer</code> props<!-- -->
<ul>
<li><code>getColor</code>: use <code>getFillColor</code> and <code>getLineColor</code></li>
</ul>
</li>
<li><code>Tile3DLayer</code> props:<!-- -->
<ul>
<li><code>onTileLoadFail</code>: use <code>onTileError</code></li>
</ul>
</li>
<li><code>TileLayer</code> props:<!-- -->
<ul>
<li><code>onViewportLoaded</code>: use <code>onViewportLoad</code></li>
</ul>
</li>
<li><code>project</code> shader module<!-- -->
<ul>
<li><code>project_scale</code>: use <code>project_size</code></li>
<li><code>project_to_clipspace</code>: use <code>project_position_to_clipspace</code></li>
<li><code>project_pixel_to_clipspace</code>: use <code>project_pixel_size_to_clipspace</code></li>
</ul>
</li>
<li><code>WebMercatorViewport</code> class<!-- -->
<ul>
<li><code>getLocationAtPoint</code>: use <code>getMapCenterByLngLatPosition</code></li>
<li><code>lngLatDeltaToMeters</code></li>
<li><code>metersToLngLatDelta</code></li>
</ul>
</li>
<li><code>Layer</code> class<!-- -->
<ul>
<li><code>setLayerNeedsUpdate</code>: use <code>setNeedsUpdate</code></li>
<li><code>setUniforms</code>: use <code>model.setUniforms</code></li>
<li><code>use64bitProjection</code></li>
<li><code>projectFlat</code>: use <code>projectPosition</code></li>
</ul>
</li>
<li><code>PerspectiveView</code> class - use <code>FirstPersonView</code></li>
<li><code>ThirdPersonView</code> class - use <code>MapView</code> (geospatial) or <code>OrbitView</code> (info-vis)</li>
<li><code>COORDINATE_SYSTEM</code> enum<!-- -->
<ul>
<li><code>LNGLAT_DEPRECATED</code>: use <code>LNGLAT</code></li>
<li><code>METERS</code>: use <code>METER_OFFSETS</code></li>
</ul>
</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="react">React<a href="#react" class="hash-link" aria-label="Direct link to React" title="Direct link to React">​</a></h5>
<ul>
<li>
<p><code>DeckGL</code> no longer injects its children with view props (<code>width</code>, <code>height</code>, <code>viewState</code> etc.). If your custom component needs these props, consider using the <a href="/docs/api-reference/react/deckgl#react-context">ContextProvider</a> or a render callback:</p>
<div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;</span><span class="token tag class-name" style="color:rgb(17, 17, 17)">DeckGL</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain-text">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token parameter">width</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token parameter"> height</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token parameter"> viewState</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(12, 150, 155)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token spread operator" style="color:rgb(12, 150, 155)">...</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain-text"></span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&lt;/</span><span class="token tag class-name" style="color:rgb(17, 17, 17)">DeckGL</span><span class="token tag punctuation" style="color:rgb(153, 76, 195)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>The children of <code>DeckGL</code> are now placed above the canvas by default (except the react-map-gl base map). Wrap them in e.g. <code>&lt;div style={{zIndex: -1}}&gt;</code> if they are intended to be placed behind the canvas.</p>
</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="debugging">Debugging<a href="#debugging" class="hash-link" aria-label="Direct link to Debugging" title="Direct link to Debugging">​</a></h5>
<p>deck.gl now removes most logging when bundling under <code>NODE_ENV=production</code>.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="standalone-bundle">Standalone bundle<a href="#standalone-bundle" class="hash-link" aria-label="Direct link to Standalone bundle" title="Direct link to Standalone bundle">​</a></h5>
<p>The pre-bundled version, a.k.a. the <a href="/docs/get-started/using-standalone#using-the-scripting-api">scripting API</a> has been aligned with the interface of the core <a href="/docs/api-reference/core/deck">Deck</a> class.</p>
<ul>
<li>Top-level view state props such as <code>longitude</code>, <code>latitude</code>, <code>zoom</code> are no longer supported. To specify the default view state, use <code>initialViewState</code>.</li>
<li><code>controller</code> is no longer on by default, use <code>controller: true</code>.</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="textures">Textures<a href="#textures" class="hash-link" aria-label="Direct link to Textures" title="Direct link to Textures">​</a></h5>
<p>In older versions of deck, we used to set <code>UNPACK_FLIP_Y_WEBGL</code> by default when creating textures from images. This is removed in v8.0 to better align with <a href="https://github.com/KhronosGroup/WebGL/issues/2577" target="_blank" rel="noopener noreferrer">WebGL best practice</a>. As a result, the texCoords in the shaders of <code>BitmapLayer</code>, <code>IconLayer</code> and <code>TextLayer</code> are y-flipped. This only affects users who extend these layers.</p>
<p>Users of <code>SimpleMeshLayer</code> with texture will need to flip their texture image vertically.</p>
<p>The change has allowed us to support loading textures from <code>ImageBitmap</code>, in use cases such as rendering to <code>OffscreenCanvas</code> on a web worker.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="projection-system">projection system<a href="#projection-system" class="hash-link" aria-label="Direct link to projection system" title="Direct link to projection system">​</a></h5>
<ul>
<li>The <a href="/docs/developer-guide/custom-layers/writing-shaders">common space</a> is no longer scaled to the current zoom level. This is part of an effort to make the geometry calculation more consistent and predictable. While one old common unit is equivalent to 1 screen pixel at the viewport center, one new common unit is equivalent to <code>viewport.scale</code> pixels at the viewport center.</li>
<li><code>viewport.distanceScales</code> keys are renamed:<!-- -->
<ul>
<li><code>pixelsPerMeter</code> -&gt; <code>unitsPerMeter</code></li>
<li><code>metersPerPixel</code> -&gt; <code>metersPerUnit</code></li>
</ul>
</li>
<li>Low part of a <code>DOUBLE</code> attribute is renamed from <code>*64xyLow</code> to <code>*64Low</code> and uses the same size as the high part. This mainly affect position attributes, e.g. all <code>vec2 positions64xyLow</code> and <code>vec2 instancePositions64xyLow</code> are now <code>vec3 positions64Low</code> and <code>vec3 instancePositions64Low</code>.<!-- -->
<ul>
<li><code>project</code>: <code>vec3 project_position(vec3 position, vec2 position64xyLow)</code> is now <code>vec3 project_position(vec3 position, vec3 position64Low)</code>.</li>
<li><code>project</code>: <code>vec4 project_position(vec4 position, vec2 position64xyLow)</code> is now <code>vec4 project_position(vec4 position, vec3 position64Low)</code>.</li>
<li><code>project32</code> and <code>project64</code>: <code>vec4 project_position_to_clipspace(vec3 position, vec2 position64xyLow, vec3 offset)</code> is now <code>vec4 project_position_to_clipspace(vec3 position, vec3 position64Low, vec3 offset)</code>.</li>
</ul>
</li>
<li>The shader module <a href="/docs/api-reference/core/project64">project64</a> is no longer included in <code>@deck.gl/core</code> and <code>deck.gl</code>. You can still import it from <code>@deck.gl/extensions</code>.</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="shader-modules">Shader modules<a href="#shader-modules" class="hash-link" aria-label="Direct link to Shader modules" title="Direct link to Shader modules">​</a></h5>
<p>This change affects custom layers. deck.gl is no longer registering shaders by default. This means any <code>modules</code> array defined in <code>layer.getShaders()</code> or <code>new Model()</code> must now use the full shader module objects, instead of just their names. All supported shader modules can be imported from <code>@deck.gl/core</code>.</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/// OLD</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Model</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">modules</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;picking&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;project32&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;gouraud-lighting&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Should now become</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword module" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token imports">picking</span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token imports"> project32</span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token imports"> gouraudLighting</span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@deck.gl/core&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/// NEW</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Model</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">modules</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">picking</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> project32</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> gouraudLighting</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="auto-view-state-update">Auto view state update<a href="#auto-view-state-update" class="hash-link" aria-label="Direct link to Auto view state update" title="Direct link to Auto view state update">​</a></h5>
<p>A bug was fixed where initial view state tracking could sometimes overwrite user-provided <code>viewState</code> prop. Apps that rely on auto view state update by specifying <code>initialViewState</code> should make sure that <code>viewState</code> is never assigned. If manual view state update is desired, use <code>viewState</code> and <code>onViewStateChange</code> instead. See <a href="/docs/developer-guide/views#using-a-view-with-view-state">developer guide</a> for examples.</p>
<p>We have fixed a bug when using <code>initialViewState</code> with multiple views. In the past, the state change in one view is unintendedly propagated to all views. As a result of this fix, multiple views (e.g. mini map) are no longer synchronized by default. To synchronize them, define the views with an explicit <code>viewState.id</code>:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Deck</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">views</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">MapView</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token literal-property property" style="color:rgb(12, 150, 155)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;main&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">MapView</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token literal-property property" style="color:rgb(12, 150, 155)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;minimap&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">controller</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">false</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">viewState</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token literal-property property" style="color:rgb(12, 150, 155)">id</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;main&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">pitch</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">zoom</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">10</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>See <a href="/docs/api-reference/core/view">View class</a> documentation for details.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v72-to-v73">Upgrading from deck.gl v7.2 to v7.3<a href="#upgrading-from-deckgl-v72-to-v73" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v7.2 to v7.3" title="Direct link to Upgrading from deck.gl v7.2 to v7.3">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="core-1">Core<a href="#core-1" class="hash-link" aria-label="Direct link to Core" title="Direct link to Core">​</a></h4>
<ul>
<li><code>layer.setLayerNeedsUpdate</code> is renamed to <code>layer.setNeedsUpdate()</code> and the old name will be removed in the next major release.</li>
<li>Previously deprecated <code>Layer</code> class method, <code>screenToDevicePixels</code>, is removed. Use luma.gl <a href="https://luma.gl/docs/api-reference-legacy/context/device-pixels" target="_blank" rel="noopener noreferrer">utility methods</a> instead.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="layers-2">Layers<a href="#layers-2" class="hash-link" aria-label="Direct link to Layers" title="Direct link to Layers">​</a></h4>
<ul>
<li><code>ScreenGridLayer</code>: support is now limited to browsers that implement either WebGL2 or the <code>OES_texture_float</code> extension. <a href="https://webglstats.com/webgl/extension/OES_texture_float" target="_blank" rel="noopener noreferrer">coverage stats</a></li>
<li>Some shader attributes are renamed for consistency:</li>
</ul>
<table><thead><tr><th>Layer</th><th>Old</th><th>New</th></tr></thead><tbody><tr><td><code>LineLayer</code></td><td><code>instanceSourceTargetPositions64xyLow.xy</code></td><td><code>instanceSourcePositions64xyLow</code></td></tr><tr><td></td><td><code>instanceSourceTargetPositions64xyLow.zw</code></td><td><code>instanceTargetPositions64xyLow</code></td></tr><tr><td><code>PathLayer</code></td><td><code>instanceLeftStartPositions64xyLow.xy</code></td><td><code>instanceLeftPositions64xyLow</code></td></tr><tr><td></td><td><code>instanceLeftStartPositions64xyLow.zw</code></td><td><code>instanceStartPositions64xyLow</code></td></tr><tr><td></td><td><code>instanceEndRightPositions64xyLow.xy</code></td><td><code>instanceEndPositions64xyLow</code></td></tr><tr><td></td><td><code>instanceEndRightPositions64xyLow.zw</code></td><td><code>instanceRightPositions64xyLow</code></td></tr><tr><td><code>ArcLayer</code></td><td><code>instancePositions64Low</code></td><td><code>instancePositions64xyLow</code></td></tr><tr><td><code>ScenegraphLayer</code></td><td><code>instancePositions64xy</code></td><td><code>instancePositions64xyLow</code></td></tr><tr><td><code>SimpleMeshLayer</code></td><td><code>instancePositions64xy</code></td><td><code>instancePositions64xyLow</code></td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deckgljson">@deck.gl/json<a href="#deckgljson" class="hash-link" aria-label="Direct link to @deck.gl/json" title="Direct link to @deck.gl/json">​</a></h4>
<ul>
<li>Non-breaking Change: The <code>_JSONConverter</code> class has been renamed to <code>JSONConverter</code> (deprecated alias still available).</li>
<li>Non-breaking Change: The <code>_JSONConverter.convertJson()</code> method has been renamed to <code>JSONConverter.convert()</code>  (deprecated stub still available).</li>
<li>Breaking Change: The <code>_JSONConverter</code> no longer automatically injects deck.gl <code>View</code> classes and enumerations. If required need to import and add these to your <code>JSONConfiguration</code>.</li>
<li>Removed: The <code>JSONLayer</code> is no longer included in this module. The code for this layer has been moved to an example in <code>/test/apps/json-layer</code>, and would need to be copied into applications to be used.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v71-to-v72">Upgrading from deck.gl v7.1 to v7.2<a href="#upgrading-from-deckgl-v71-to-v72" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v7.1 to v7.2" title="Direct link to Upgrading from deck.gl v7.1 to v7.2">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="breaking-changes-5">Breaking Changes<a href="#breaking-changes-5" class="hash-link" aria-label="Direct link to Breaking Changes" title="Direct link to Breaking Changes">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="layer-methods">Layer methods<a href="#layer-methods" class="hash-link" aria-label="Direct link to Layer methods" title="Direct link to Layer methods">​</a></h5>
<p>Following <code>Layer</code> class methods have been removed :</p>
<table><thead><tr><th>Removed</th><th>Alternate</th><th>Comment</th></tr></thead><tbody><tr><td><code>use64bitProjection</code></td><td>use <code>Fp64Extension</code></td><td>details in <code>fp64 prop</code> section below</td></tr><tr><td><code>is64bitEnabled</code></td><td>use <code>Fp64Extension</code></td><td>details in <code>fp64 prop</code> section below</td></tr><tr><td><code>updateAttributes</code></td><td><code>_updateAttributes</code></td><td>method is renamed</td></tr></tbody></table>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="fp64-prop">fp64 prop<a href="#fp64-prop" class="hash-link" aria-label="Direct link to fp64 prop" title="Direct link to fp64 prop">​</a></h5>
<p>The deprecated <code>fp64</code> prop is removed. The current 32-bit projection is generally precise enough for almost all use cases. If you previously use this feature:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/// old</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword module" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token constant" style="color:rgb(72, 118, 214)">COORDINATE_SYSTEM</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@deck.gl/core&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">ScatterplotLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">coordinateSystem</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(72, 118, 214)">COORDINATE_SYSTEM</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token constant" style="color:rgb(72, 118, 214)">LNGLAT_DEPRECATED</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">fp64</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(12, 150, 155)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It can be changed to:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">/// new</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword module" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token constant" style="color:rgb(72, 118, 214)">COORDINATE_SYSTEM</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@deck.gl/core&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword module" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token imports maybe-class-name">Fp64Extension</span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@deck.gl/extensions&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">ScatterplotLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">coordinateSystem</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(72, 118, 214)">COORDINATE_SYSTEM</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token constant" style="color:rgb(72, 118, 214)">LNGLAT_DEPRECATED</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">extensions</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Fp64Extension</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(12, 150, 155)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="color-attributes-and-uniforms">Color Attributes and Uniforms<a href="#color-attributes-and-uniforms" class="hash-link" aria-label="Direct link to Color Attributes and Uniforms" title="Direct link to Color Attributes and Uniforms">​</a></h5>
<p>All core layer shaders now receive <strong>normalized</strong> color attributes and uniforms. If you were previously subclassing a core layer with custom vertex shaders, you should expect the color attributes to be in <code>[0, 1]</code> range instead of <code>[0, 255]</code>.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="project64-shader-module">project64 Shader Module<a href="#project64-shader-module" class="hash-link" aria-label="Direct link to project64 Shader Module" title="Direct link to project64 Shader Module">​</a></h5>
<p>The <code>project64</code> shader module is no longer registered by default. If you were previously using a custom layer that depends on this module:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">getShaders</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">vs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> fs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">modules</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;project64&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It can be changed to:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword module" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token imports">project64</span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@deck.gl/core&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">getShaders</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">vs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> fs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">modules</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">project64</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cpu-grid-layer-and-hexagon-layer-updatetriggers">CPU Grid layer and Hexagon layer updateTriggers<a href="#cpu-grid-layer-and-hexagon-layer-updatetriggers" class="hash-link" aria-label="Direct link to CPU Grid layer and Hexagon layer updateTriggers" title="Direct link to CPU Grid layer and Hexagon layer updateTriggers">​</a></h4>
<p><code>getElevationValue</code>, <code>getElevationWeight</code> and <code>getColorValue</code>, <code>getColorWeight</code> are now compared using <code>updateTriggers</code> like other layer <a href="https://github.com/visgl/deck.gl/blob/master/docs/developer-guide/using-layers.md#accessors" target="_blank" rel="noopener noreferrer">accessors</a>. Update them without passing updateTriggers will no longer trigger layer update.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deprecations-2">Deprecations<a href="#deprecations-2" class="hash-link" aria-label="Direct link to Deprecations" title="Direct link to Deprecations">​</a></h4>
<p>IE support is deprecated and will be removed in the next major release.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v70-to-v71">Upgrading from deck.gl v7.0 to v7.1<a href="#upgrading-from-deckgl-v70-to-v71" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v7.0 to v7.1" title="Direct link to Upgrading from deck.gl v7.0 to v7.1">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="breaking-changes-6">Breaking Changes<a href="#breaking-changes-6" class="hash-link" aria-label="Direct link to Breaking Changes" title="Direct link to Breaking Changes">​</a></h4>
<ul>
<li>
<p>Fixed a bug where <code>coordinateOrigin</code>&#x27;s <code>z</code> is not applied in <code>METER_OFFSETS</code> and <code>LNGLAT_OFFSETS</code> coordinate systems.</p>
</li>
<li>
<p>If your application was subclassing <code>GridLayer</code>, you should now subclass <code>CPUGridLayer</code> instead, and either use it directly, or provide it as the sublayer class for <code>GridLayer</code> using <code>_subLayerProps</code>:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">EnhancedCPUGridLayer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">extends</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">CPUGridLayer</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// enhancments</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Code initilizing GridLayer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> myGridLayer </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">GridLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// props</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(12, 150, 155)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// Override sublayer type for &#x27;CPU&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">_subLayerProps</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token constant" style="color:rgb(72, 118, 214)">CPU</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">type</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token maybe-class-name">EnhancedCPUGridLayer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deprecations-3">Deprecations<a href="#deprecations-3" class="hash-link" aria-label="Direct link to Deprecations" title="Direct link to Deprecations">​</a></h4>
<ul>
<li><code>getColor</code> props in <code>ColumnLayer</code> and <code>H3HexagonLayer</code> are deprecated. Use <code>getLineColor</code> and <code>getFillColor</code> instead.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v64-to-v70">Upgrading from deck.gl v6.4 to v7.0<a href="#upgrading-from-deckgl-v64-to-v70" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v6.4 to v7.0" title="Direct link to Upgrading from deck.gl v6.4 to v7.0">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="submodule-structure-and-dependency-changes">Submodule Structure and Dependency Changes<a href="#submodule-structure-and-dependency-changes" class="hash-link" aria-label="Direct link to Submodule Structure and Dependency Changes" title="Direct link to Submodule Structure and Dependency Changes">​</a></h4>
<ul>
<li><code> @deck.gl/core</code> is moved from <code>dependencies</code> to <code>devDependencies</code> for all submodules. This will reduce the runtime error caused by installing multiple copies of the core.</li>
<li>The master module <code>deck.gl</code> now include all submodules except <code> @deck.gl/test-utils</code>. See <a href="/docs/get-started/getting-started#selectively-install-dependencies">list of submodules</a> for details.</li>
<li><code>ContourLayer</code>, <code>GridLayer</code>, <code>HexagonLayer</code> and <code>ScreenGridLayer</code> are moved from <code> @deck.gl/layers</code> to <code> @deck.gl/aggregation-layers</code>. No action is required if you are importing them from <code>deck.gl</code>.</li>
<li><code> @deck.gl/experimental-layers</code> is deprecated. Experimental layers will be exported from their respective modules with a <code>_</code> prefix.<!-- -->
<ul>
<li><code>BitmapLayer</code> is moved to <code> @deck.gl/layers</code>.</li>
<li><code>MeshLayer</code> is renamed to <code>SimpleMeshLayer</code> and moved to <code> @deck.gl/mesh-layers</code>.</li>
<li><code>TileLayer</code> and <code>TripsLayer</code> are moved to <code> @deck.gl/geo-layers</code>.</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deck-class">Deck Class<a href="#deck-class" class="hash-link" aria-label="Direct link to Deck Class" title="Direct link to Deck Class">​</a></h4>
<p>Breaking Changes:</p>
<ul>
<li><code>onLayerHover</code> and <code>onLayerClick</code> props are replaced with <code>onHover</code> and <code>onClick</code>. The first argument passed to the callback will always be a valid <a href="/docs/developer-guide/interactivity#the-pickinginfo-object">picking info</a> object, and the second argument is the pointer event. This change makes these two events behave consistently with other event callbacks.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="layers-3">Layers<a href="#layers-3" class="hash-link" aria-label="Direct link to Layers" title="Direct link to Layers">​</a></h4>
<p>Deprecations:</p>
<ul>
<li><code>ArcLayer</code> and <code>LineLayer</code>&#x27;s <code>getStrokeWidth</code> props are deprecated. Use <code>getWidth</code> instead.</li>
</ul>
<p>Breaking Changes:</p>
<ul>
<li><code>HexagonCellLayer</code> is removed. Use <a href="/docs/api-reference/layers/column-layer">ColumnLayer</a> with <code>diskResolution: 6</code> instead.</li>
<li>A bug in projecting elevation was fixed in <code>HexagonLayer</code>, <code>GridLayer</code> and <code>GridCellLayer</code>. The resulting heights of extruded grids/hexagons have changed. You may adjust them to match previous behavior by tweaking <code>elevationScale</code>.</li>
<li>The following former experimental layers&#x27; APIs are redesigned as they graduate to official layers. Refer to their documentations for details:<!-- -->
<ul>
<li><a href="/docs/api-reference/layers/column-layer">BitmapLayer</a></li>
<li><a href="/docs/api-reference/mesh-layers/simple-mesh-layer">SimpleMeshLayer</a></li>
<li><a href="/docs/api-reference/geo-layers/tile-layer">TileLayer</a></li>
<li><a href="/docs/api-reference/geo-layers/trips-layer">TripsLayer</a></li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="lighting">Lighting<a href="#lighting" class="hash-link" aria-label="Direct link to Lighting" title="Direct link to Lighting">​</a></h4>
<p>The old experimental prop <code>lightSettings</code> in many 3D layers is no longer supported. The new and improved settings are split into two places: a <a href="https://github.com/visgl/luma.gl/tree/master/docs/api-reference/core/materials" target="_blank" rel="noopener noreferrer">material</a> prop for each 3D layer and a shared set of lights specified by <a href="/docs/api-reference/core/lighting-effect">LightingEffect</a> with the <a href="/docs/api-reference/core/deck#effects">effects prop of Deck</a>.
Check <a href="/docs/developer-guide/using-effects">Using Lighting</a> in developer guide for more details.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="views">Views<a href="#views" class="hash-link" aria-label="Direct link to Views" title="Direct link to Views">​</a></h4>
<p>v7.0 includes major bug fixes for <a href="/docs/api-reference/core/orbit-view">OrbitView</a> and <a href="/docs/api-reference/core/orthographic-view">OrthographicView</a>. Their APIs are also changed for better clarity and consistency.</p>
<p>Breaking Changes:</p>
<ul>
<li>View state: <code>zoom</code> is now logarithmic in all <code>View</code> classes. <code>zoom: 0</code> maps one unit in world space to one pixel in screen space.</li>
<li>View state: <code>minZoom</code> and <code>maxZoom</code> now default to no limit.</li>
<li>View state: <code>offset</code> (pixel-shift of the viewport center) is removed, use <code>target</code> (world position <code>[x, y, z]</code> of the viewport center) instead.</li>
<li>Constructor prop: added <code>target</code> to specify the viewport center in world position.</li>
<li><code>OrthographicView</code>&#x27;s constructor props <code>left</code>, <code>right</code>, <code>top</code> and <code>bottom</code> are removed. Use <code>target</code> to specify viewport center.</li>
<li><code>OrbitView</code>&#x27;s constructor prop <code>distance</code> and static method <code>getDistance</code> are removed. Use <code>fovy</code> and <code>zoom</code> instead.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="project-shader-module">project Shader Module<a href="#project-shader-module" class="hash-link" aria-label="Direct link to project Shader Module" title="Direct link to project Shader Module">​</a></h4>
<p>Deprecations:</p>
<ul>
<li><code>project_scale</code> -&gt; <code>project_size</code></li>
<li><code>project_to_clipspace</code> -&gt; <code>project_common_position_to_clipspace</code></li>
<li><code>project_to_clipspace_fp64</code> -&gt; <code>project_common_position_to_clipspace_fp64</code></li>
<li><code>project_pixel_to_clipspace</code> -&gt; <code>project_pixel_size_to_clipspace</code></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="react-1">React<a href="#react-1" class="hash-link" aria-label="Direct link to React" title="Direct link to React">​</a></h4>
<p>If you are using DeckGL with react-map-gl, <code> @deck.gl/react@^9.0.0</code> no longer works with react-map-gl v3.x.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v63-to-v64">Upgrading from deck.gl v6.3 to v6.4<a href="#upgrading-from-deckgl-v63-to-v64" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v6.3 to v6.4" title="Direct link to Upgrading from deck.gl v6.3 to v6.4">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="orthographicview">OrthographicView<a href="#orthographicview" class="hash-link" aria-label="Direct link to OrthographicView" title="Direct link to OrthographicView">​</a></h4>
<p>The experimental <code>OrthographicView</code> class has the following breaking changes:</p>
<ul>
<li><code>zoom</code> is reversed (larger value means zooming in) and switched to logarithmic scale.</li>
<li>Changed view state defaults:<!-- -->
<ul>
<li><code>zoom</code> - <code>1</code> -&gt; <code>0</code></li>
<li><code>offset</code> - <code>[0, 1]</code> -&gt; <code>[0, 0]</code></li>
<li><code>minZoom</code> - <code>0.1</code> -&gt; <code>-10</code></li>
</ul>
</li>
<li><code>eye</code>, <code>lookAt</code> and <code>up</code> are now set in the  <code>OrthographicView</code> constructor instead of <code>viewState</code>.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="scatterplotlayer">ScatterplotLayer<a href="#scatterplotlayer" class="hash-link" aria-label="Direct link to ScatterplotLayer" title="Direct link to ScatterplotLayer">​</a></h4>
<p>Deprecations:</p>
<ul>
<li><code>outline</code> is deprecated: use <code>stroked</code> instead.</li>
<li><code>strokeWidth</code> is deprecated: use <code>getLineWidth</code> instead. Note that while <code>strokeWidth</code> is in pixels, line width is now specified in meters. The old appearance can be achieved by using <code>lineWidthMinPixels</code> and/or <code>lineWidthMaxPixels</code>.</li>
<li><code>getColor</code> is deprecated: use <code>getFillColor</code> and <code>getLineColor</code> instead.</li>
</ul>
<p>Breaking changes:</p>
<ul>
<li><code>outline</code> / <code>stroked</code> no longer turns off fill. Use <code>filled: false</code> instead.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="geojsonlayer">GeoJsonLayer<a href="#geojsonlayer" class="hash-link" aria-label="Direct link to GeoJsonLayer" title="Direct link to GeoJsonLayer">​</a></h4>
<p>Breaking changes:</p>
<ul>
<li><code>stroked</code>, <code>getLineWidth</code> and <code>getLineColor</code> props now apply to point features (rendered with a ScatterplotLayer) in addition to polygon features. To revert to the old appearance, supply a <code>_subLayerProps</code> override:</li>
</ul>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">GeoJsonLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// ...other props</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">stroked</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">true</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">_subLayerProps</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">points</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token literal-property property" style="color:rgb(12, 150, 155)">stroked</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(188, 84, 84)">false</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v62-to-v63">Upgrading from deck.gl v6.2 to v6.3<a href="#upgrading-from-deckgl-v62-to-v63" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v6.2 to v6.3" title="Direct link to Upgrading from deck.gl v6.2 to v6.3">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="gridlayer-and-hexagonlayer">GridLayer and HexagonLayer<a href="#gridlayer-and-hexagonlayer" class="hash-link" aria-label="Direct link to GridLayer and HexagonLayer" title="Direct link to GridLayer and HexagonLayer">​</a></h4>
<p>Shallow changes in <code>getColorValue</code> and <code>getElevationValue</code> props are now ignored by default. To trigger an update, use the <code>updateTriggers</code> prop. This new behavior is aligned with other core layers and improves runtime performance.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="prop-types-in-custom-layers">Prop Types in Custom Layers<a href="#prop-types-in-custom-layers" class="hash-link" aria-label="Direct link to Prop Types in Custom Layers" title="Direct link to Prop Types in Custom Layers">​</a></h4>
<p>Although the <a href="/docs/developer-guide/custom-layers/prop-types">prop types system</a> is largely backward-compatible, it is possible that some custom layers may stop updating when a certain prop changes. This is because the automatically deduced prop type from <code>defaultProps</code> does not match its desired usage. Switch to explicit descriptors will fix the issue, e.g. from:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token maybe-class-name">MyLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">defaultProps</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">prop</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token maybe-class-name">MyLayer</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">defaultProps</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">prop</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token literal-property property" style="color:rgb(12, 150, 155)">type</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;number&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">value</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">min</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v61-to-v62">Upgrading from deck.gl v6.1 to v6.2<a href="#upgrading-from-deckgl-v61-to-v62" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v6.1 to v6.2" title="Direct link to Upgrading from deck.gl v6.1 to v6.2">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="fp64">fp64<a href="#fp64" class="hash-link" aria-label="Direct link to fp64" title="Direct link to fp64">​</a></h4>
<p>The default coordinate system <code>COORDINATE_SYSTEM.LNGLAT</code> is upgraded to offer high-precision results in a way that is much faster and more cross-platform compatible. The <code>fp64</code> layer prop is ignored when using this new coordinate system. You can get the old fp64 mode back by using <code>coordinateSystem: COORDINATE_SYSTEM.LNGLAT_DEPRECATED</code> with <code>fp64: true</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v53-to-v60">Upgrading from deck.gl v5.3 to v6.0<a href="#upgrading-from-deckgl-v53-to-v60" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v5.3 to v6.0" title="Direct link to Upgrading from deck.gl v5.3 to v6.0">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="lumagl-v60">luma.gl v6.0<a href="#lumagl-v60" class="hash-link" aria-label="Direct link to luma.gl v6.0" title="Direct link to luma.gl v6.0">​</a></h4>
<p>deck.gl v6.0 brings in luma.gl v6.0 which is a major release with a few breaking changes. The change that is most likely to affect deck.gl applications is probably that the way the <code>GL</code> constant is imported has changed. For details, see to the luma.gl <a href="https://luma.gl/docs/upgrade-guide" target="_blank" rel="noopener noreferrer">Upgrade Guide</a>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pixel-sizes">Pixel sizes<a href="#pixel-sizes" class="hash-link" aria-label="Direct link to Pixel sizes" title="Direct link to Pixel sizes">​</a></h4>
<p>Pixel sizes in line, icon and text layers now match their HTML/SVG counterparts. To achieve the same rendering output as v5, you should use half the previous value in the following props:</p>
<ul>
<li><code>ArcLayer.getStrokeWidth</code></li>
<li><code>LineLayer.getStrokeWidth</code></li>
<li><code>IconLayer.getSize</code> or <code>IconLayer.sizeScale</code></li>
<li><code>TextLayer.getSize</code> or <code>TextLayer.sizeScale</code></li>
<li><code>PointCloudLayer.radiusPixels</code></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="accessors">Accessors<a href="#accessors" class="hash-link" aria-label="Direct link to Accessors" title="Direct link to Accessors">​</a></h4>
<p>All layer accessors that support constant values have had their default values changed to constants. For example, <code>ScatterplotLayer</code>&#x27;s default <code>getRadius</code> prop is changed from <code>d =&gt; d.radius || 1</code> to <code>1</code>. All dynamic attributes now must be explicitly specified. This change makes sure that using default values results in best performance.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="views-and-controllers">Views and Controllers<a href="#views-and-controllers" class="hash-link" aria-label="Direct link to Views and Controllers" title="Direct link to Views and Controllers">​</a></h4>
<ul>
<li>(React only) Viewport constraint props: <code>maxZoom</code>, <code>minZoom</code>, <code>maxPitch</code>, <code>minPitch</code> are no longer supported by the <code>DeckGL</code> component. They must be specified as part of the <code>viewState</code> object.</li>
<li>(React only) <code>ViewportController</code> React component has been removed. The functionality is now built in to the <code>Deck</code> and <code>DeckGL</code> classes.</li>
<li><code>Deck.onViewportChange(viewport)</code> etc callbacks are no longer supported. Use <code>Deck.onViewStateChange({viewState})</code></li>
<li><code>DeckGL.viewport</code> and <code>DeckGL.viewports</code> props are no longer supported. Use <code>DeckGL.views</code>.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="screengridlayer">ScreenGridLayer<a href="#screengridlayer" class="hash-link" aria-label="Direct link to ScreenGridLayer" title="Direct link to ScreenGridLayer">​</a></h4>
<p><code>minColor</code> and <code>maxColor</code> props are deprecated. Use <code>colorRange</code> and <code>colorDomain</code> props.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="shader-modules-1">Shader Modules<a href="#shader-modules-1" class="hash-link" aria-label="Direct link to Shader Modules" title="Direct link to Shader Modules">​</a></h4>
<p>Some previously deprecated <code>project_</code> module GLSL functions have now been removed.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="attribute">Attribute<a href="#attribute" class="hash-link" aria-label="Direct link to Attribute" title="Direct link to Attribute">​</a></h4>
<p><code>isGeneric</code> field of attribute object returned by <code>AttributeManager</code>&#x27;s update callbacks is replaced by <code>constant</code>. For more details check <a href="/docs/api-reference/core/attribute-manager"><code>attribute manager</code></a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v52-to-v53">Upgrading from deck.gl v5.2 to v5.3<a href="#upgrading-from-deckgl-v52-to-v53" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v5.2 to v5.3" title="Direct link to Upgrading from deck.gl v5.2 to v5.3">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="viewport-classes">Viewport classes<a href="#viewport-classes" class="hash-link" aria-label="Direct link to Viewport classes" title="Direct link to Viewport classes">​</a></h3>
<p>Continuing the changes that started in 5.2: while the base <code>Viewport</code> class will remain supported, the various <code>Viewport</code> subclasses are now deprecated. For now, if for projection purposes you need to create a <code>Viewport</code> instance matching one of your <code>View</code> instances you can use <code>View.makeViewport</code>:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">MapView</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token method function property-access" style="color:rgb(153, 76, 195);font-style:italic">makeViewport</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">width</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> height</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">viewState</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">longitude</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> latitude</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> zoom</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="layer-properties">Layer properties<a href="#layer-properties" class="hash-link" aria-label="Direct link to Layer properties" title="Direct link to Layer properties">​</a></h3>
<table><thead><tr><th>Layer</th><th>Removed Prop</th><th>New Prop</th><th>Comment</th></tr></thead><tbody><tr><td><code>ArcLayer</code></td><td><code>strokeWidth</code></td><td><code>getStrokeWidth</code></td><td>Can be set to constant value</td></tr><tr><td><code>LineLayer</code></td><td><code>strokeWidth</code></td><td><code>getStrokeWidth</code></td><td>Can be set to constant value</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pure-js-applications">Pure JS applications<a href="#pure-js-applications" class="hash-link" aria-label="Direct link to Pure JS applications" title="Direct link to Pure JS applications">​</a></h3>
<p>Core layers are broken out from <code> @deck.gl/core</code> to a new submodule <code> @deck.gl/layers</code>. Non-React users of deck.gl should now install both submodules:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">npm install @deck.gl/core @deck.gl/layers</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And import layers from the new submodule instead of core:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token keyword module" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token imports maybe-class-name">ScatterplotLayer</span><span class="token imports punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;@deck.gl/layers&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Users of <code>deck.gl</code> are not affected by this change.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v51-to-v52">Upgrading from deck.gl v5.1 to v5.2<a href="#upgrading-from-deckgl-v51-to-v52" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v5.1 to v5.2" title="Direct link to Upgrading from deck.gl v5.1 to v5.2">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deckgl-component">DeckGL component<a href="#deckgl-component" class="hash-link" aria-label="Direct link to DeckGL component" title="Direct link to DeckGL component">​</a></h3>
<ul>
<li><code>DeckGL.viewports</code> and <code>DeckGL.viewport</code> are deprecated and should be replaced with <code>DeckGL.views</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="viewport-classes-1">Viewport classes<a href="#viewport-classes-1" class="hash-link" aria-label="Direct link to Viewport classes" title="Direct link to Viewport classes">​</a></h3>
<ul>
<li>A number of <code>Viewport</code> subclasses have been deprecated. They should be replaced with their <code>View</code> counterparts.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="experimental-features">Experimental Features<a href="#experimental-features" class="hash-link" aria-label="Direct link to Experimental Features" title="Direct link to Experimental Features">​</a></h3>
<p>Some experimental exports have been removed:</p>
<ul>
<li>The experimental React controller components (<code>MapController</code> and <code>OrbitController</code>) have been removed. These are now replaced with JavaScript classes that can be used with the <code>Deck.controller</code> / <code>DeckGL.controller</code> property.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v5-to-v51">Upgrading from deck.gl v5 to v5.1<a href="#upgrading-from-deckgl-v5-to-v51" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v5 to v5.1" title="Direct link to Upgrading from deck.gl v5 to v5.1">​</a></h2>
<p>N/A</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v41-to-v5">Upgrading from deck.gl v4.1 to v5<a href="#upgrading-from-deckgl-v41-to-v5" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v4.1 to v5" title="Direct link to Upgrading from deck.gl v4.1 to v5">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dependencies">Dependencies<a href="#dependencies" class="hash-link" aria-label="Direct link to Dependencies" title="Direct link to Dependencies">​</a></h3>
<p>deck.gl 4.1 requires luma.gl as peer dependency, but 5.0 specifies it as a normal &quot;dependency&quot;. This means that many applications no longer need to list luma.gl in their package.json. Applications that do might get multiple copies of luma.gl installed, which will not work. <strong>luma.gl will detect this situation during run-time throwing an exception</strong>, but <strong>npm and yarn will not detect it during install time</strong>. Thus your build can look successful during upgrade but fail during runtime.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="layer-props">Layer Props<a href="#layer-props" class="hash-link" aria-label="Direct link to Layer Props" title="Direct link to Layer Props">​</a></h3>
<p>Coordinate system related props have been renamed for clarity. The old props are no longer supported and will generate errors when used.</p>
<table><thead><tr><th>Layer</th><th>Removed Prop</th><th>New Prop</th><th>Comment</th></tr></thead><tbody><tr><td>Layer</td><td><code>projectionMode</code></td><td><code>coordinateSystem</code></td><td>Any constant from <code>COORDINATE_SYSTEM</code></td></tr><tr><td>Layer</td><td><code>projectionOrigin</code></td><td><code>coordinateOrigin</code></td><td>[lng, lat]</td></tr></tbody></table>
<p>Note; There is also an important semantical change in that using <code>coordinateSystem</code> instead of <code>projectionMode</code> causes the superimposed <code>METER_OFFSET</code> system&#x27;s y-axis to point north instead of south. This was always the intention so in some sense this was regarded as a bug fix.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deckgl-component-1">DeckGL component<a href="#deckgl-component-1" class="hash-link" aria-label="Direct link to DeckGL component" title="Direct link to DeckGL component">​</a></h3>
<p>Following methods and props have been renamed for clarity. The semantics are unchanged. The old props are still available but will generate a deprecation warning.</p>
<table><thead><tr><th>Old Method</th><th>New Method</th><th>Comment</th></tr></thead><tbody><tr><td><code>queryObject</code></td><td><code>pickObject</code></td><td>These names were previously aligned with react-map-gl, but ended up confusing users. Since rest of the deck.gl documentation talks extensively about &quot;picking&quot; it made sense to stay with that terminology.</td></tr><tr><td><code>queryVisibleObjects</code></td><td><code>pickObjects</code></td><td>The word &quot;visible&quot; was intended to remind the user that this function only selects the objects that are actually visible in at least one pixel, but again it confused more than it helped.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="removed-picking-uniforms">Removed picking Uniforms<a href="#removed-picking-uniforms" class="hash-link" aria-label="Direct link to Removed picking Uniforms" title="Direct link to Removed picking Uniforms">​</a></h3>
<table><thead><tr><th>Removed uniform</th><th>Comment</th></tr></thead><tbody><tr><td>renderPickingBuffer</td><td><a href="https://github.com/visgl/luma.gl/tree/5.0-release/src/shadertools/modules/picking" target="_blank" rel="noopener noreferrer">picking shader module</a></td></tr><tr><td>pickingEnabled</td><td><a href="https://github.com/visgl/luma.gl/tree/5.0-release/src/shadertools/modules/picking" target="_blank" rel="noopener noreferrer">picking shader module</a></td></tr><tr><td>selectedPickingColor</td><td><a href="https://github.com/visgl/luma.gl/tree/5.0-release/src/shadertools/modules/picking" target="_blank" rel="noopener noreferrer">picking shader module</a></td></tr></tbody></table>
<p>The shader uniforms are used for implementing picking in custom shaders, these uniforms are no longer set by the deck.gl. Custom shaders can now use luma.gl <a href="https://github.com/visgl/luma.gl/tree/5.0-release/src/shadertools/modules/picking" target="_blank" rel="noopener noreferrer">picking shader module</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="initial-webgl-state">Initial WebGL State<a href="#initial-webgl-state" class="hash-link" aria-label="Direct link to Initial WebGL State" title="Direct link to Initial WebGL State">​</a></h3>
<p>Following WebGL parameters are set during DeckGL component initialization.</p>
<table><thead><tr><th>WebGL State</th><th>Value</th></tr></thead><tbody><tr><td>depthTest</td><td>true</td></tr><tr><td>depthFunc</td><td>gl.LEQUAL</td></tr><tr><td>blendFuncSeparate</td><td>[gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA]</td></tr></tbody></table>
<p>All our layers enable depth test so we are going set this state during initialization. We are also changing blend function for more appropriate rendering when multiple elements are blended.</p>
<p>For any custom needs, these parameters can be overwritten by updating them in <code>onWebGLInitialized</code> callback or by passing them in <code>parameters</code> object to <code>drawLayer</code> method of <code>Layer</code> class.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="assembleshaders">assembleShaders<a href="#assembleshaders" class="hash-link" aria-label="Direct link to assembleShaders" title="Direct link to assembleShaders">​</a></h3>
<p>The <code>assembleShaders</code> function was moved to luma.gl in v4.1 and is no longer re-exported from deck.gl. As described in v4.1 upgrade guide please use <code>Model</code> class instead or import it from luma.gl.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="removed-immutable-support">Removed Immutable support<a href="#removed-immutable-support" class="hash-link" aria-label="Direct link to Removed Immutable support" title="Direct link to Removed Immutable support">​</a></h3>
<p><code>ScatterplotLayer</code> and <code>PolygonLayer</code> supported immutable/ES6 containers using <a href="https://github.com/visgl/deck.gl/blob/5.0-release/src/core/utils/get.js" target="_blank" rel="noopener noreferrer"><code>get</code></a> method, due to performance reasons this support has been dropped.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v4-to-v41">Upgrading from deck.gl v4 to v4.1<a href="#upgrading-from-deckgl-v4-to-v41" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v4 to v4.1" title="Direct link to Upgrading from deck.gl v4 to v4.1">​</a></h2>
<p>deck.gl v4.1 is a backward-compatible release. Most of the functionality and APIs remain unchanged but there are smaller changes that might requires developers&#x27; attention if they <strong>develop custom layers</strong>. Note that applications that are only using the provided layers should not need to make any changes issues.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dependencies-1">Dependencies<a href="#dependencies-1" class="hash-link" aria-label="Direct link to Dependencies" title="Direct link to Dependencies">​</a></h3>
<p>Be aware that deck.gl 4.1 bumps the luma.gl peer dependency from 3.0 to 4.0. There have been instances where this was not detected by the installer during update.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="layer-life-cycle-optimization">Layer Life Cycle Optimization<a href="#layer-life-cycle-optimization" class="hash-link" aria-label="Direct link to Layer Life Cycle Optimization" title="Direct link to Layer Life Cycle Optimization">​</a></h3>
<ul>
<li><strong>shouldUpdateState</strong> - deck.gl v4.1 contains additional optimizations of the layer lifecycle and layer diffing algorithms. Most of these changes are completely under the hood but one  visible change is that the default implementation of <code>Layer.shouldUpdate</code> no longer returns true if only the viewport has changed. This means that layers that need to update state in response to changes in screen space (viewport) will need to redefine <code>shouldUpdate</code>:</li>
</ul>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">shouldUpdateState</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token parameter">changeFlags</span><span class="token parameter punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(12, 150, 155)">return</span><span class="token plain"> changeFlags</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">somethingChanged</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// default is now changeFlags.propsOrDataChanged;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that this change has already been done in all the provided deck.gl layers that are screen space based, including the <code>ScreenGridLayer</code> and the <code>HexagonLayer</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lumagl-model-class-api-change">luma.gl <code>Model</code> class API change<a href="#lumagl-model-class-api-change" class="hash-link" aria-label="Direct link to lumagl-model-class-api-change" title="Direct link to lumagl-model-class-api-change">​</a></h3>
<ul>
<li>deck.gl v4.1 bumps luma.gl to from v3 to v4. This is major release that brings full WebGL2 enablement to deck.gl. This should not affect you if you are mainly using the provided deck.gl layers but if you are writing your own layers using luma.gl classes you may want to look at the upgrade guide of luma.gl.</li>
</ul>
<p>The <code>gl</code> parameter is provided as a separate argument in luma.gl v4, instead of part of the options object.</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// luma.gl v4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Model</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">opts</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// luma.gl v3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Model</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token spread operator" style="color:rgb(12, 150, 155)">...</span><span class="token plain">opts</span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="shader-assembly">Shader Assembly<a href="#shader-assembly" class="hash-link" aria-label="Direct link to Shader Assembly" title="Direct link to Shader Assembly">​</a></h3>
<p>Custom layers are <strong>no longer expected</strong> to call <code>assembleShaders</code> directly. Instead, the new <code>Model</code> class from luma.gl v4 will take shaders and the modules they are using as parameters and assemble shaders automatically.</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// luma.gl v4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> model </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Model</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">vs</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(72, 118, 214)">VERTEX_SHADER</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">fs</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(72, 118, 214)">FRAGMENT_SHADER</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">modules</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;fp64&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token spread operator" style="color:rgb(12, 150, 155)">...</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">shaderCache</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">this</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">context</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">shaderCache</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(12, 150, 155)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// luma.gl v3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> shaders </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">assembleShaders</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">vs</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(72, 118, 214)">VERTEX_SHADER</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">fs</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(72, 118, 214)">FRAGMENT_SHADER</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">modules</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;fp64&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;project64&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">shaderCache</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">this</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">context</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">shaderCache</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">const</span><span class="token plain"> model </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(17, 17, 17)">Model</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  gl</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">vs</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> shaders</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">vs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(12, 150, 155)">fs</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> shaders</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token property-access">fs</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(12, 150, 155)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="removed-layers">Removed Layers<a href="#removed-layers" class="hash-link" aria-label="Direct link to Removed Layers" title="Direct link to Removed Layers">​</a></h3>
<table><thead><tr><th>Layer</th><th>Status</th><th>Replacement</th></tr></thead><tbody><tr><td><code>ChoroplethLayer</code></td><td>Removed</td><td><code>GeoJsonLayer</code>, <code>PolygonLayer</code> and <code>PathLayer</code></td></tr><tr><td><code>ChoroplethLayer64</code></td><td>Removed</td><td><code>GeoJsonLayer</code>, <code>PolygonLayer</code> and <code>PathLayer</code></td></tr><tr><td><code>ExtrudedChoroplethLayer</code></td><td>Removed</td><td><code>GeoJsonLayer</code>, <code>PolygonLayer</code> and <code>PathLayer</code></td></tr></tbody></table>
<ul>
<li>ChoroplethLayer, ChoroplethLayer64, ExtrudedChoroplethLayer</li>
</ul>
<p>These set of layers were deprecated in deck.gl v4, and are now removed in v5. You can still get same functionality using more unified, flexible and performant layers:
<code>GeoJsonLayer</code>, <code>PolygonLayer</code> and <code>PathLayer</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-from-deckgl-v3-to-v4">Upgrading from deck.gl v3 to v4<a href="#upgrading-from-deckgl-v3-to-v4" class="hash-link" aria-label="Direct link to Upgrading from deck.gl v3 to v4" title="Direct link to Upgrading from deck.gl v3 to v4">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="changed-import-the-deckgl-react-component">Changed Import: The <code>DeckGL</code> React component<a href="#changed-import-the-deckgl-react-component" class="hash-link" aria-label="Direct link to changed-import-the-deckgl-react-component" title="Direct link to changed-import-the-deckgl-react-component">​</a></h3>
<p>A small but breaking change that will affect all applications is that the &#x27;deck.gl/react&#x27; import is no longer available. As of v4.0, the app is required to import deck.gl as follows:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// V4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword module" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">DeckGL</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;deck.gl&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">// V3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword module" style="color:rgb(12, 150, 155)">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">DeckGL</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;deck.gl/react&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>While it would have been preferable to avoid this change, a significant modernization of the deck.gl build process and preparations for &quot;tree-shaking&quot; support combined to make it impractical to keep supporting the old import style.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deprecatedremoved-layers">Deprecated/Removed Layers<a href="#deprecatedremoved-layers" class="hash-link" aria-label="Direct link to Deprecated/Removed Layers" title="Direct link to Deprecated/Removed Layers">​</a></h3>
<table><thead><tr><th>Layer</th><th>Status</th><th>Replacement</th></tr></thead><tbody><tr><td><code>ChoroplethLayer</code></td><td>Deprecated</td><td><code>GeoJsonLayer</code>, <code>PolygonLayer</code> and <code>PathLayer</code></td></tr><tr><td><code>ChoroplethLayer64</code></td><td>Deprecated</td><td><code>GeoJsonLayer</code>, <code>PolygonLayer</code> and <code>PathLayer</code></td></tr><tr><td><code>ExtrudedChoroplethLayer</code></td><td>Deprecated</td><td><code>GeoJsonLayer</code>, <code>PolygonLayer</code> and <code>PathLayer</code></td></tr><tr><td><code>EnhancedChoroplethLayer</code></td><td>Moved to examples</td><td><code>PathLayer</code></td></tr></tbody></table>
<ul>
<li>ChoroplethLayer, ChoroplethLayer64, ExtrudedChoroplethLayer</li>
</ul>
<p>These set of layers are deprecated in deck.gl v4, with their functionality completely substituted by more unified, flexible and performant new layers:
<code>GeoJsonLayer</code>, <code>PolygonLayer</code> and <code>PathLayer</code>.</p>
<p>Developers should be able to just supply the same geojson data that are used with <code>ChoroplethLayer</code>s to the new <code>GeoJsonLayer</code>. The props of the <code>GeoJsonLayer</code> are a bit different from the old <code>ChoroplethLayer</code>, so proper testing is recommended to achieve satisfactory result.</p>
<ul>
<li>EnhancedChoroplethLayer</li>
</ul>
<p>This was a a sample layer in deck.gl v3 and has now been moved to a stand-alone example and is no longer exported from the deck.gl npm module.</p>
<p>Developers can either copy this layer from the example folder into their application&#x27;s source tree, or consider using the new <code>PathLayer</code> which also handles wide lines albeit in a slightly different way.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="removed-changed-and-deprecated-layer-properties">Removed, Changed and Deprecated Layer Properties<a href="#removed-changed-and-deprecated-layer-properties" class="hash-link" aria-label="Direct link to Removed, Changed and Deprecated Layer Properties" title="Direct link to Removed, Changed and Deprecated Layer Properties">​</a></h3>
<table><thead><tr><th>Layer</th><th>Old Prop</th><th>New Prop</th><th>Comment</th></tr></thead><tbody><tr><td>Layer</td><td><code>dataIterator</code></td><td>N/A</td><td>Prop was not functional in v3</td></tr><tr><td>ScatterplotLayer</td><td><code>radius</code></td><td><code>radiusScale</code></td><td>Default has changed from 30 to 1</td></tr><tr><td>ScatterplotLayer</td><td><code>drawOutline</code></td><td><code>outline</code></td><td></td></tr><tr><td>ScreenGridLayer</td><td><code>unitWidth</code></td><td><code>cellSizePixels</code></td><td></td></tr><tr><td>ScreenGridLayer</td><td><code>unitHeight</code></td><td><code>cellSizePixels</code></td><td></td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="note-about-strokewidth-props">Note about <code>strokeWidth</code> props<a href="#note-about-strokewidth-props" class="hash-link" aria-label="Direct link to note-about-strokewidth-props" title="Direct link to note-about-strokewidth-props">​</a></h4>
<p>All line based layers (<code>LineLayer and </code>ArcLayer<code>and the</code>ScatterplotLayer<code>in outline mode) now use use shaders to render an exact pixel thickness on lines, instead of using the</code>GL.LINE` drawing mode.</p>
<p>This particular change was caused by browsers dropping support for this feature (<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=60124" target="_blank" rel="noopener noreferrer">Chrome</a> and <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=634506" target="_blank" rel="noopener noreferrer">Firefox</a>).</p>
<p>Also <code>GL.LINE</code> mode rendering always had significant limitations in terms of lack of support for mitering, unreliable support for anti-aliasing and platform dependent line width limits so this should represent an improvement in visual quality and consistency for these layers.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="removed-prop-layerdataiterator">Removed prop: <code>Layer.dataIterator</code><a href="#removed-prop-layerdataiterator" class="hash-link" aria-label="Direct link to removed-prop-layerdataiterator" title="Direct link to removed-prop-layerdataiterator">​</a></h4>
<p>This prop has been removed in deck.gl v4. Note that it was not functioning as documented in deck.gl v3.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="renamed-props-the-scale-suffix">Renamed Props: The <code>...Scale</code> suffix<a href="#renamed-props-the-scale-suffix" class="hash-link" aria-label="Direct link to renamed-props-the-scale-suffix" title="Direct link to renamed-props-the-scale-suffix">​</a></h4>
<p>Props that have their name end of <code>Scale</code> is a set of props that multiply some existing value for all objects in the layers. These props usually correspond to WebGL shader uniforms that &quot;scaling&quot; all values of specific attributes simultaneously.</p>
<p>For API consistency reasons these have all been renamed with the suffix <code>..Scale</code>. See the property table above.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="removed-lifecycle-method-layerwillreceiveprops">Removed lifecycle method: <code>Layer.willReceiveProps</code><a href="#removed-lifecycle-method-layerwillreceiveprops" class="hash-link" aria-label="Direct link to removed-lifecycle-method-layerwillreceiveprops" title="Direct link to removed-lifecycle-method-layerwillreceiveprops">​</a></h4>
<p>This lifecycle was deprecated in v3 and is now removed in v4. Use <code>Layer.updateState</code> instead.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="changes-to-updatetriggers">Changes to <code>updateTriggers</code><a href="#changes-to-updatetriggers" class="hash-link" aria-label="Direct link to changes-to-updatetriggers" title="Direct link to changes-to-updatetriggers">​</a></h4>
<p>Update triggers can now be specified by referring to the name of the accessor, instead of the name of the actual WebGL attribute.</p>
<p>Note that this is supported on all layers supplied by deck.gl v4, but if you are using older layers, they need a small addition to their attribute definitions to specify the name of the accessor.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="attributemanager-changes">AttributeManager changes<a href="#attributemanager-changes" class="hash-link" aria-label="Direct link to AttributeManager changes" title="Direct link to AttributeManager changes">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="removed-method-attributemanagersetlogfunctions">Removed method: <code>AttributeManager.setLogFunctions</code><a href="#removed-method-attributemanagersetlogfunctions" class="hash-link" aria-label="Direct link to removed-method-attributemanagersetlogfunctions" title="Direct link to removed-method-attributemanagersetlogfunctions">​</a></h4>
<p>Use the new static function <code>AttributeManager.setDefaultLogFunctions</code> to set loggers for all AttributeManagers (i.e. for all layers).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="removed-method-attributemanageradddynamic">Removed method: <code>AttributeManager.addDynamic</code><a href="#removed-method-attributemanageradddynamic" class="hash-link" aria-label="Direct link to removed-method-attributemanageradddynamic" title="Direct link to removed-method-attributemanageradddynamic">​</a></h4>
<p>This method has been deprecated since version 2.5 and is now removed in v4. Use <code>AttributeManager.add()</code> instead.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/visgl/deck.gl/tree/master/website/../docs/upgrade-guide.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/whats-new"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">What&#x27;s New</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/contributing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Contributing to deck.gl</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#upgrading-to-v91" class="table-of-contents__link toc-highlight">Upgrading to v9.1</a><ul><li><a href="#user-input-handling" class="table-of-contents__link toc-highlight">User input handling</a></li><li><a href="#globe-view" class="table-of-contents__link toc-highlight">Globe View</a></li><li><a href="#aggregation-layers" class="table-of-contents__link toc-highlight">Aggregation layers</a></li><li><a href="#lightingeffect" class="table-of-contents__link toc-highlight">LightingEffect</a></li><li><a href="#uniform-buffers" class="table-of-contents__link toc-highlight">Uniform buffers</a></li></ul></li><li><a href="#upgrading-to-v90" class="table-of-contents__link toc-highlight">Upgrading to v9.0</a><ul><li><a href="#typescript" class="table-of-contents__link toc-highlight">Typescript</a></li><li><a href="#lumagl-v9-updates" class="table-of-contents__link toc-highlight">luma.gl v9 Updates</a></li><li><a href="#deckglmapbox" class="table-of-contents__link toc-highlight">@deck.gl/mapbox</a></li><li><a href="#deckglcarto" class="table-of-contents__link toc-highlight">@deck.gl/carto</a></li><li><a href="#loadersgl" class="table-of-contents__link toc-highlight">loaders.gl</a></li><li><a href="#others" class="table-of-contents__link toc-highlight">Others</a></li></ul></li><li><a href="#upgrading-from-deckgl-v88-to-v89" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v8.8 to v8.9</a></li><li><a href="#upgrading-from-deckgl-v87-to-v88" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v8.7 to v8.8</a></li><li><a href="#upgrading-from-deckgl-v86-to-v87" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v8.6 to v8.7</a></li><li><a href="#upgrading-from-deckgl-v85-to-v86" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v8.5 to v8.6</a><ul><li><a href="#changes-to-layer-prop-defaults" class="table-of-contents__link toc-highlight">Changes to layer prop defaults</a></li><li><a href="#meter-size-projection" class="table-of-contents__link toc-highlight">Meter size projection</a></li><li><a href="#layer-filtering" class="table-of-contents__link toc-highlight">Layer filtering</a></li></ul></li><li><a href="#upgrading-from-deckgl-v84-to-v85" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v8.4 to v8.5</a><ul><li><a href="#transpilation" class="table-of-contents__link toc-highlight">Transpilation</a></li><li><a href="#layers" class="table-of-contents__link toc-highlight">Layers</a></li><li><a href="#onerror-callback" class="table-of-contents__link toc-highlight">onError Callback</a></li><li><a href="#loadersgl-v30" class="table-of-contents__link toc-highlight">loaders.gl v3.0</a></li><li><a href="#orbitview" class="table-of-contents__link toc-highlight">OrbitView</a></li></ul></li><li><a href="#upgrading-from-deckgl-v83-to-v84" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v8.3 to v8.4</a><ul><li><a href="#wraplongitude" class="table-of-contents__link toc-highlight">wrapLongitude</a></li><li><a href="#pickinginfo" class="table-of-contents__link toc-highlight">pickingInfo</a></li><li><a href="#layers-1" class="table-of-contents__link toc-highlight">Layers</a></li></ul></li><li><a href="#upgrading-from-deckgl-v82-to-v83" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v8.2 to v8.3</a></li><li><a href="#upgrading-from-deckgl-v81-to-v82" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v8.1 to v8.2</a></li><li><a href="#upgrading-from-deckgl-v80-to-v81" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v8.0 to v8.1</a><ul><li><a href="#breaking-changes-3" class="table-of-contents__link toc-highlight">Breaking Changes</a></li></ul></li><li><a href="#upgrading-from-deckgl-v7x-to-v80" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v7.x to v8.0</a><ul><li><a href="#breaking-changes-4" class="table-of-contents__link toc-highlight">Breaking Changes</a></li></ul></li><li><a href="#upgrading-from-deckgl-v72-to-v73" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v7.2 to v7.3</a></li><li><a href="#upgrading-from-deckgl-v71-to-v72" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v7.1 to v7.2</a></li><li><a href="#upgrading-from-deckgl-v70-to-v71" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v7.0 to v7.1</a></li><li><a href="#upgrading-from-deckgl-v64-to-v70" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v6.4 to v7.0</a></li><li><a href="#upgrading-from-deckgl-v63-to-v64" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v6.3 to v6.4</a></li><li><a href="#upgrading-from-deckgl-v62-to-v63" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v6.2 to v6.3</a></li><li><a href="#upgrading-from-deckgl-v61-to-v62" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v6.1 to v6.2</a></li><li><a href="#upgrading-from-deckgl-v53-to-v60" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v5.3 to v6.0</a></li><li><a href="#upgrading-from-deckgl-v52-to-v53" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v5.2 to v5.3</a><ul><li><a href="#viewport-classes" class="table-of-contents__link toc-highlight">Viewport classes</a></li><li><a href="#layer-properties" class="table-of-contents__link toc-highlight">Layer properties</a></li><li><a href="#pure-js-applications" class="table-of-contents__link toc-highlight">Pure JS applications</a></li></ul></li><li><a href="#upgrading-from-deckgl-v51-to-v52" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v5.1 to v5.2</a><ul><li><a href="#deckgl-component" class="table-of-contents__link toc-highlight">DeckGL component</a></li><li><a href="#viewport-classes-1" class="table-of-contents__link toc-highlight">Viewport classes</a></li><li><a href="#experimental-features" class="table-of-contents__link toc-highlight">Experimental Features</a></li></ul></li><li><a href="#upgrading-from-deckgl-v5-to-v51" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v5 to v5.1</a></li><li><a href="#upgrading-from-deckgl-v41-to-v5" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v4.1 to v5</a><ul><li><a href="#dependencies" class="table-of-contents__link toc-highlight">Dependencies</a></li><li><a href="#layer-props" class="table-of-contents__link toc-highlight">Layer Props</a></li><li><a href="#deckgl-component-1" class="table-of-contents__link toc-highlight">DeckGL component</a></li><li><a href="#removed-picking-uniforms" class="table-of-contents__link toc-highlight">Removed picking Uniforms</a></li><li><a href="#initial-webgl-state" class="table-of-contents__link toc-highlight">Initial WebGL State</a></li><li><a href="#assembleshaders" class="table-of-contents__link toc-highlight">assembleShaders</a></li><li><a href="#removed-immutable-support" class="table-of-contents__link toc-highlight">Removed Immutable support</a></li></ul></li><li><a href="#upgrading-from-deckgl-v4-to-v41" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v4 to v4.1</a><ul><li><a href="#dependencies-1" class="table-of-contents__link toc-highlight">Dependencies</a></li><li><a href="#layer-life-cycle-optimization" class="table-of-contents__link toc-highlight">Layer Life Cycle Optimization</a></li><li><a href="#lumagl-model-class-api-change" class="table-of-contents__link toc-highlight">luma.gl <code>Model</code> class API change</a></li><li><a href="#shader-assembly" class="table-of-contents__link toc-highlight">Shader Assembly</a></li><li><a href="#removed-layers" class="table-of-contents__link toc-highlight">Removed Layers</a></li></ul></li><li><a href="#upgrading-from-deckgl-v3-to-v4" class="table-of-contents__link toc-highlight">Upgrading from deck.gl v3 to v4</a><ul><li><a href="#changed-import-the-deckgl-react-component" class="table-of-contents__link toc-highlight">Changed Import: The <code>DeckGL</code> React component</a></li><li><a href="#deprecatedremoved-layers" class="table-of-contents__link toc-highlight">Deprecated/Removed Layers</a></li><li><a href="#removed-changed-and-deprecated-layer-properties" class="table-of-contents__link toc-highlight">Removed, Changed and Deprecated Layer Properties</a></li><li><a href="#attributemanager-changes" class="table-of-contents__link toc-highlight">AttributeManager changes</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/api-reference/core/deck">API Reference</a></li><li class="footer__item"><a href="https://github.com/visgl/deck.gl/tree/master/examples/get-started" target="_blank" rel="noopener noreferrer" class="footer__link-item">Starter templates<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/playground">Playground</a></li><li class="footer__item"><a href="https://codepen.io/vis-gl/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Codepen demos<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Other vis.gl Libraries</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://visgl.github.io/deck.gl-community/" target="_blank" rel="noopener noreferrer" class="footer__link-item">deck.gl-community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://luma.gl" target="_blank" rel="noopener noreferrer" class="footer__link-item">luma.gl<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://loaders.gl" target="_blank" rel="noopener noreferrer" class="footer__link-item">loaders.gl<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://visgl.github.io/react-map-gl" target="_blank" rel="noopener noreferrer" class="footer__link-item">react-map-gl<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://nebula.gl" target="_blank" rel="noopener noreferrer" class="footer__link-item">nebula.gl<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/deckgl/shared_invite/zt-7oeoqie8-NQqzSp5SLTFMDeNSPxi7eg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack workspace<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://medium.com/vis-gl" target="_blank" rel="noopener noreferrer" class="footer__link-item">vis.gl blog on Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/visgl/deck.gl" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 OpenJS Foundation</div></div></div></footer></div>
</body>
</html>